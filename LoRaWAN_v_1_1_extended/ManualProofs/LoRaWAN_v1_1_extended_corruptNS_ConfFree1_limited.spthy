theory LoRaWAN_v1_1_extended_corruptNS begin

// Function signature and definition of the equational theory E

builtins: multiset
functions: AesKey/2, ClientID/1, Counter/1, MAC/2, Nonce/1,
           PD_Wrapper/1, Response/1, SessionID/1, SessionKey/1, accept/0,
           adec/2, aenc/2, fst/1, pair/2, pk/1, sdec/2, senc/2, snd/1,
           verifyMAC/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    sdec(senc(x.1, x.2), x.2) = x.1,
    snd(<x.1, x.2>) = x.2,
    verifyMAC(m, k, MAC(m, k)) = accept

restriction equality:
  "∀ #i x y. (Eq( x, y ) @ #i) ⇒ (x = y)"
  // safety formula

restriction inequality:
  "∀ x #i. (Neq( x, x ) @ #i) ⇒ (⊥)"
  // safety formula

restriction one_server:
  "∀ #i #j Role SVR1 SVR2.
    (((EntityInit( Role, SVR1 ) @ #i) ∧
      (EntityInit( Role, SVR2 ) @ #j)) ∧
     (¬(Role = 'ED'))) ⇒
    (#i = #j)"
  // safety formula

restriction unique_entities:
  "∀ #i #j Role1 Role2 Entity.
    ((EntityInit( Role1, Entity ) @ #i) ∧
     (EntityInit( Role2, Entity ) @ #j)) ⇒
    (#i = #j)"
  // safety formula

restriction maxEDJoinRequests:
  "∀ ED JoinEUI requests #i.
    (MaxRequests( ED, JoinEUI, requests ) @ #i) ⇒
    (∃ z. (requests+z) = ('1'+'1'+'1'))"

restriction maxJSJoinResponses:
  "∀ ED JoinEUI responses #i.
    (MaxResponses( ED, JoinEUI, responses ) @ #i) ⇒
    (∃ z. (responses+z) = ('2'+'2'+'2'))"

restriction LessThan:
  "∀ x y #i. (LessThan( x, y ) @ #i) ⇒ (∃ z. (x+z) = y)"

rule (modulo E) ChanOut_S[color=#ffffff]:
   [ Out_S( $A, $B, x ), !F_Paired( $A, $B ) ]
  --[ ChanOut_S( $A, $B, x ) ]->
   [ Sec( $A, $B, x ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) ChanIn_S[color=#ffffff]:
   [ Sec( $A, $B, x ) ]
  --[ ChanIn_S( $A, $B, x ) ]->
   [ In_S( $A, $B, x ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Shared_Key_Reveal1:
   [ !Ltk_shared( $ID1, $ID2, AesKey(type, rndSeed) ) ]
  --[ KeyReveal( 'Shared_Key_Reveal', $ID1 ) ]->
   [ Out( <$ID1, AesKey(type, rndSeed)> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Shared_Key_Reveal2:
   [
   !Ltk_shared( $ID1, $ID2,
                SessionKey(senc(data, AesKey(type, rndSeed)))
   )
   ]
  --[ KeyReveal( 'Shared_Key_Reveal', $ID1 ) ]->
   [ Out( <$ID1, SessionKey(senc(data, AesKey(type, rndSeed)))> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) JS_Init:
   [ ]
  --[ EntityInit( 'JS', $JoinEUI ), OnlyOnce( 'JS_Init' ) ]->
   [ !JSInitialised( $JoinEUI ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NS_Init:
   [ ]
  --[ EntityInit( 'NS', $NS ), OnlyOnce( 'NS_Init' ) ]->
   [ !NSInitialised( $NS ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) AS_Init:
   [ ]
  --[ EntityInit( 'AS', $AS ), OnlyOnce( 'AS_Init' ) ]->
   [ !ASInitialised( $AS ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) EndDevice_Init:
   [ ]
  --[ EntityInit( 'ED', $DevEUI ), OnlyOnce( 'Device_Init' ) ]->
   [ EDInitialised( $DevEUI ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Commissioning_Procedure_Out_of_Band:
   [
   Fr( ~rootNwkKey ), Fr( ~rootAppKey ), Fr( ~JSASKey ),
   !JSInitialised( $JoinEUI ), !NSInitialised( $NS ),
   !ASInitialised( $AS ), EDInitialised( $DevEUI )
   ]
  --[
  Linked_ED_With_JS_NS_AS( $DevEUI, $JoinEUI, $NS, $AS ),
  OnlyOnce( 'JoinSever_Commission_EndDevice' )
  ]->
   [
   EDCommissioned( $DevEUI, $JoinEUI, $NS, $AS,
                   AesKey('Nwk', ~rootNwkKey), AesKey('App', ~rootAppKey)
   ),
   !NSCommissioned( $DevEUI, $JoinEUI, $NS, $AS ),
   JSCommissioned( $DevEUI, $JoinEUI, $NS, $AS,
                   AesKey('Nwk', ~rootNwkKey), AesKey('App', ~rootAppKey),
                   AesKey('JS_AS', ~JSASKey)
   ),
   !ASCommissioned( $DevEUI, $JoinEUI, $NS, $AS ),
   !F_Paired( $NS, $JoinEUI ), !F_Paired( $JoinEUI, $NS1 ),
   !F_Paired( $AS, $JoinEUI ), !F_Paired( $JoinEUI, $AS ),
   !F_Paired( $AS, $NS ), !F_Paired( $NS, $AS )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) EndDevice_Commissioned:
   [
   EDCommissioned( $DevEUI, $JoinEUI, $NS, $AS,
                   AesKey('Nwk', ~rootNwkKey), AesKey('App', ~rootAppKey)
   )
   ]
  --[
  CommissionCompleted( 'ED', $DevEUI, $JoinEUI, $NS, $AS ),
  CounterInit( $DevEUI, '1' ), OnlyOnce( 'EndDevice_Commissioned' )
  ]->
   [
   ED_State_01( $DevEUI, $JoinEUI, $NS, $AS, '1' ),
   CheckCtrJS( $DevEUI, '2' ),
   !Ltk_shared( $DevEUI, $JoinEUI, AesKey('Nwk', ~rootNwkKey) ),
   !Ltk_shared( $DevEUI, $JoinEUI, AesKey('App', ~rootAppKey) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) JoinServer_Commissioned:
   [
   JSCommissioned( $DevEUI, $JoinEUI, $NS, $AS,
                   AesKey('Nwk', ~rootNwkKey), AesKey('App', ~rootAppKey),
                   AesKey('JS_AS', ~JSASKey)
   )
   ]
  --[
  CommissionCompleted( 'JS', $JoinEUI, $DevEUI, $NS, $AS ),
  OnlyOnce( 'JoinServer_Commissioned' )
  ]->
   [
   JS_State_01( $JoinEUI, $DevEUI, $NS, $AS,
                <'1', '2', Nonce('undefined'), Nonce('undefined'), 
                 SessionKey('undefined'), SessionKey('undefined'), 
                 SessionKey('undefined'), SessionKey('undefined'), 
                 SessionKey('undefined')>
   ),
   !Ltk_shared( $JoinEUI, $DevEUI, AesKey('Nwk', ~rootNwkKey) ),
   !Ltk_shared( $JoinEUI, $DevEUI, AesKey('App', ~rootAppKey) ),
   !Ltk_shared( $JoinEUI, <$AS, $DevEUI>, AesKey('JS_AS', ~JSASKey) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Device_Join_Request:
   [
   ED_State_01( $DevEUI, $JoinEUI, $NS, $AS, ctr_ED ),
   !Ltk_shared( $DevEUI, $JoinEUI, AesKey('Nwk', ~rootNwkKey) )
   ]
  --[
  DeviceJoinRequest( $DevEUI, $NS, $JoinEUI, ('1'+ctr_ED) ),
  MaxRequests( $DevEUI, $JoinEUI, ('1'+ctr_ED) ),
  Role( 'EndDevice' ), OnlyOnce( 'Device_Join_Request' )
  ]->
   [
   Out( <'Join_Request', $NS, $JoinEUI, $DevEUI, 
         Counter(('1'+ctr_ED)), 
         MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+ctr_ED)>,
             AesKey('Nwk', ~rootNwkKey))
        >
   ),
   ED_State_01( $DevEUI, $JoinEUI, $NS, $AS, ('1'+ctr_ED) ),
   ED_State_02( $DevEUI, $JoinEUI, $NS, $AS, ('1'+ctr_ED) )
   ]

  // loop breaker: [0]
  /* has exactly the trivial AC variant */

rule (modulo E) NetworkSever_Receive_JoinRequest_Forward_To_AS_JS:
   [
   Fr( ~rnd32DevAddr ),
   In( <'Join_Request', $NS, $JoinEUI, $DevEUI, Counter(DevNonce), 
        tau_c>
   ),
   !NSCommissioned( $DevEUI, $JoinEUI, $NS, $AS )
   ]
  --[
  NetworkServerReceiveForwardJoinRequest( $JoinEUI, $DevEUI, $NS,
                                          $AS, DevNonce, Nonce(~rnd32DevAddr)
  ),
  MaxRequests( $DevEUI, $JoinEUI, DevNonce ), Neq( DevNonce, '1' ),
  OnlyOnce( 'NetworkSever_Receive_JoinRequest_Forward_To_AS_JS' )
  ]->
   [
   Out( <$NS, $AS, 'Join_Request', $JoinEUI, $DevEUI, 
         Counter(DevNonce), tau_c>
   ),
   Out( <$NS, $JoinEUI, 'NS_Request', Nonce(~rnd32DevAddr), $JoinEUI, 
         $DevEUI, Counter(DevNonce), tau_c>
   ),
   NS_State_01( $JoinEUI, $DevEUI, $NS, $AS, DevNonce,
                Nonce(~rnd32DevAddr)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) ApplicationServer_Receive_JoinRequest:
   [
   Fr( ~AS_rnd32DevAddr ),
   In( <$NS, $AS, 'Join_Request', $JoinEUI, $DevEUI, 
        Counter(DevNonce), tau_c>
   )
   ]
  --[
  Role( 'AppServer_Join' ),
  ApplicationServerSendJoinRequest( $JoinEUI, $DevEUI, $NS, $AS,
                                    DevNonce, Nonce(~AS_rnd32DevAddr)
  ),
  MaxRequests( $DevEUI, $JoinEUI, DevNonce ), Neq( DevNonce, '1' ),
  OnlyOnce( 'ApplicationServer_Receive_JoinRequest' )
  ]->
   [
   Out_S( $AS, $JS,
          <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr), $JoinEUI, $DevEUI, 
           Counter(DevNonce), tau_c>
   ),
   AS_State_01( $JoinEUI, $DevEUI, $NS, $AS, DevNonce,
                Nonce(~AS_rnd32DevAddr)
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) JoinServer_Receive_JoinRequest_Generate_Response:
   [
   In_S( $AS, $JS,
         <'AS_Request', $NS, AppNonce, $JoinEUI, $DevEUI, 
          Counter(DevNonce), tau_c>
   ),
   In( <$NS, $JoinEUI, 'NS_Request', NSNonce, $JoinEUI, $DevEUI, 
        Counter(DevNonce), tau_c>
   ),
   JS_State_01( $JoinEUI, $DevEUI, $NS, $AS,
                <ctr_ED_in, ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                 FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
   ),
   !Ltk_shared( $JoinEUI, $DevEUI, AesKey('Nwk', ~rootNwkKey) ),
   !Ltk_shared( $JoinEUI, $DevEUI, AesKey('App', ~rootAppKey) ),
   !Ltk_shared( $JoinEUI, <$AS, $DevEUI>, JS_AS_Key ),
   Fr( ~rnd32DevAddr ), Fr( ~AppSKey_SID ), Fr( ~rndJoinNonce )
   ]
  --[
  Eq( verifyMAC(<'MHDR', $JoinEUI, $DevEUI, DevNonce>,
                AesKey('Nwk', ~rootNwkKey), tau_c),
      accept
  ),
  LessThan( ctr_ED_in, DevNonce ),
  MaxRequests( $DevEUI, $JoinEUI, DevNonce ), Neq( DevNonce, '1' ),
  JoinResponseJS( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, NSNonce,
                  AppNonce, Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>)
  ),
  Running( 'Join_ED_JS', $JoinEUI, $DevEUI,
           <NSNonce, AppNonce, 
            SessionKey(senc(<'0x01', 
                             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                             DevNonce, NSNonce, 'pad_with_0s'>,
                            AesKey('Nwk', ~rootNwkKey))), 
            SessionKey(senc(<'0x03', 
                             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                             DevNonce, NSNonce, 'pad_with_0s'>,
                            AesKey('Nwk', ~rootNwkKey))), 
            SessionKey(senc(<'0x04', 
                             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                             DevNonce, NSNonce, 'pad_with_0s'>,
                            AesKey('Nwk', ~rootNwkKey))), 
            SessionKey(senc(<'0x02', 
                             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                             DevNonce, AppNonce, 'pad_with_0s'>,
                            AesKey('App', ~rootAppKey))), 
            SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                            AesKey('Nwk', ~rootNwkKey)))
           >
  ),
  Running( 'Join_ED_JS_confree', $JoinEUI, $DevEUI,
           <AppNonce, 
            SessionKey(senc(<'0x02', 
                             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                             DevNonce, AppNonce, 'pad_with_0s'>,
                            AesKey('App', ~rootAppKey)))
           >
  ),
  Honest( $JoinEUI ), Honest( $DevEUI ),
  !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
               SessionKey(senc(<'0x01', 
                                Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                DevNonce, NSNonce, 'pad_with_0s'>,
                               AesKey('Nwk', ~rootNwkKey)))
  ),
  !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
               SessionKey(senc(<'0x03', 
                                Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                DevNonce, NSNonce, 'pad_with_0s'>,
                               AesKey('Nwk', ~rootNwkKey)))
  ),
  !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
               SessionKey(senc(<'0x04', 
                                Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                DevNonce, NSNonce, 'pad_with_0s'>,
                               AesKey('Nwk', ~rootNwkKey)))
  ),
  !Ltk_shared( $JoinEUI, <$DevEUI, $AS>,
               SessionKey(senc(<'0x02', 
                                Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                DevNonce, AppNonce, 'pad_with_0s'>,
                               AesKey('App', ~rootAppKey)))
  ),
  Role( 'JoinServer' ),
  OnlyOnce( 'JoinServer_Receive_JoinRequest_Generate_Response' )
  ]->
   [
   Out( <$JoinEUI, $NS, 
         <'Join_Accept', $DevEUI, 
          Response(senc(<Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), 
                         NSNonce, AppNonce, 'NetID', Nonce(~rnd32DevAddr), 'opt_params', 
                         MAC(<'0xFF', $JoinEUI, DevNonce, 'MHDR', 
                              Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
                              AppNonce, 'NetID', Nonce(~rnd32DevAddr), 'opt_params'>,
                             SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                                             AesKey('Nwk', ~rootNwkKey))))
                        >,
                        AesKey('Nwk', ~rootNwkKey)))
         >, 
         'SessionKeys', $DevEUI, $NS, 
         Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
         SessionKey(senc(<'0x01', 
                          Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                          DevNonce, NSNonce, 'pad_with_0s'>,
                         AesKey('Nwk', ~rootNwkKey))), 
         SessionKey(senc(<'0x03', 
                          Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                          DevNonce, NSNonce, 'pad_with_0s'>,
                         AesKey('Nwk', ~rootNwkKey))), 
         SessionKey(senc(<'0x04', 
                          Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                          DevNonce, NSNonce, 'pad_with_0s'>,
                         AesKey('Nwk', ~rootNwkKey)))
        >
   ),
   Out_S( $JoinEUI, $AS,
          <'EncAppSKey', $DevEUI, $AS, 
           Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), AppNonce, 
           SessionKey(senc(<'0x02', 
                            Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                            DevNonce, AppNonce, 'pad_with_0s'>,
                           AesKey('App', ~rootAppKey)))
          >
   ),
   JS_State_01( $JoinEUI, $DevEUI, $NS, $AS,
                <DevNonce, ('2'+ctr_JS_in), 
                 Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
                 AppNonce, Nonce(~rnd32DevAddr), 
                 SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey))), 
                 SessionKey(senc(<'0x01', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey))), 
                 SessionKey(senc(<'0x03', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey))), 
                 SessionKey(senc(<'0x04', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey))), 
                 SessionKey(senc(<'0x02', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, AppNonce, 'pad_with_0s'>,
                                 AesKey('App', ~rootAppKey)))
                >
   )
   ]

  // loop breakers: [0,2]
  /*
  rule (modulo AC) JoinServer_Receive_JoinRequest_Generate_Response:
     [
     In_S( $AS, $JS,
           <'AS_Request', $NS, AppNonce, $JoinEUI, $DevEUI, 
            Counter(DevNonce), tau_c>
     ),
     In( <$NS, $JoinEUI, 'NS_Request', NSNonce, $JoinEUI, $DevEUI, 
          Counter(DevNonce), tau_c>
     ),
     JS_State_01( $JoinEUI, $DevEUI, $NS, $AS,
                  <ctr_ED_in, ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                   FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
     ),
     !Ltk_shared( $JoinEUI, $DevEUI, AesKey('Nwk', ~rootNwkKey) ),
     !Ltk_shared( $JoinEUI, $DevEUI, AesKey('App', ~rootAppKey) ),
     !Ltk_shared( $JoinEUI, <$AS, $DevEUI>, JS_AS_Key ),
     Fr( ~rnd32DevAddr ), Fr( ~AppSKey_SID ), Fr( ~rndJoinNonce )
     ]
    --[
    Eq( z, accept ), LessThan( ctr_ED_in, DevNonce ),
    MaxRequests( $DevEUI, $JoinEUI, DevNonce ), Neq( DevNonce, '1' ),
    JoinResponseJS( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, NSNonce,
                    AppNonce, Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>)
    ),
    Running( 'Join_ED_JS', $JoinEUI, $DevEUI,
             <NSNonce, AppNonce, 
              SessionKey(senc(<'0x01', 
                               Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                               DevNonce, NSNonce, 'pad_with_0s'>,
                              AesKey('Nwk', ~rootNwkKey))), 
              SessionKey(senc(<'0x03', 
                               Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                               DevNonce, NSNonce, 'pad_with_0s'>,
                              AesKey('Nwk', ~rootNwkKey))), 
              SessionKey(senc(<'0x04', 
                               Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                               DevNonce, NSNonce, 'pad_with_0s'>,
                              AesKey('Nwk', ~rootNwkKey))), 
              SessionKey(senc(<'0x02', 
                               Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                               DevNonce, AppNonce, 'pad_with_0s'>,
                              AesKey('App', ~rootAppKey))), 
              SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                              AesKey('Nwk', ~rootNwkKey)))
             >
    ),
    Running( 'Join_ED_JS_confree', $JoinEUI, $DevEUI,
             <AppNonce, 
              SessionKey(senc(<'0x02', 
                               Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                               DevNonce, AppNonce, 'pad_with_0s'>,
                              AesKey('App', ~rootAppKey)))
             >
    ),
    Honest( $JoinEUI ), Honest( $DevEUI ),
    !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
                 SessionKey(senc(<'0x01', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey)))
    ),
    !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
                 SessionKey(senc(<'0x03', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey)))
    ),
    !Ltk_shared( $JoinEUI, <$DevEUI, $NS>,
                 SessionKey(senc(<'0x04', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, NSNonce, 'pad_with_0s'>,
                                 AesKey('Nwk', ~rootNwkKey)))
    ),
    !Ltk_shared( $JoinEUI, <$DevEUI, $AS>,
                 SessionKey(senc(<'0x02', 
                                  Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                  DevNonce, AppNonce, 'pad_with_0s'>,
                                 AesKey('App', ~rootAppKey)))
    ),
    Role( 'JoinServer' ),
    OnlyOnce( 'JoinServer_Receive_JoinRequest_Generate_Response' )
    ]->
     [
     Out( <$JoinEUI, $NS, 
           <'Join_Accept', $DevEUI, 
            Response(senc(<Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), 
                           NSNonce, AppNonce, 'NetID', Nonce(~rnd32DevAddr), 'opt_params', 
                           MAC(<'0xFF', $JoinEUI, DevNonce, 'MHDR', 
                                Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
                                AppNonce, 'NetID', Nonce(~rnd32DevAddr), 'opt_params'>,
                               SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                                               AesKey('Nwk', ~rootNwkKey))))
                          >,
                          AesKey('Nwk', ~rootNwkKey)))
           >, 
           'SessionKeys', $DevEUI, $NS, 
           Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
           SessionKey(senc(<'0x01', 
                            Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                            DevNonce, NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey))), 
           SessionKey(senc(<'0x03', 
                            Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                            DevNonce, NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey))), 
           SessionKey(senc(<'0x04', 
                            Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                            DevNonce, NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey)))
          >
     ),
     Out_S( $JoinEUI, $AS,
            <'EncAppSKey', $DevEUI, $AS, 
             Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), AppNonce, 
             SessionKey(senc(<'0x02', 
                              Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                              DevNonce, AppNonce, 'pad_with_0s'>,
                             AesKey('App', ~rootAppKey)))
            >
     ),
     JS_State_01( $JoinEUI, $DevEUI, $NS, $AS,
                  <DevNonce, ('2'+ctr_JS_in), 
                   Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), NSNonce, 
                   AppNonce, Nonce(~rnd32DevAddr), 
                   SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                                   AesKey('Nwk', ~rootNwkKey))), 
                   SessionKey(senc(<'0x01', 
                                    Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                    DevNonce, NSNonce, 'pad_with_0s'>,
                                   AesKey('Nwk', ~rootNwkKey))), 
                   SessionKey(senc(<'0x03', 
                                    Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                    DevNonce, NSNonce, 'pad_with_0s'>,
                                   AesKey('Nwk', ~rootNwkKey))), 
                   SessionKey(senc(<'0x04', 
                                    Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                    DevNonce, NSNonce, 'pad_with_0s'>,
                                   AesKey('Nwk', ~rootNwkKey))), 
                   SessionKey(senc(<'0x02', 
                                    Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce>), $JoinEUI, 
                                    DevNonce, AppNonce, 'pad_with_0s'>,
                                   AesKey('App', ~rootAppKey)))
                  >
     )
     ]
    variants (modulo AC)
    1. $DevEUI
             = $DevEUI.57
       $JoinEUI
             = $JoinEUI.59
       ~rootNwkKey
             = ~rootNwkKey.65
       DevNonce
             = DevNonce.69
       tau_c = MAC(<'MHDR', $JoinEUI.59, $DevEUI.57, DevNonce.69>,
                   AesKey('Nwk', ~rootNwkKey.65))
       z     = accept
    
    2. $DevEUI
             = $DevEUI.67
       $JoinEUI
             = $JoinEUI.69
       ~rootNwkKey
             = ~rootNwkKey.75
       DevNonce
             = DevNonce.79
       tau_c = tau_c.89
       z     = verifyMAC(<'MHDR', $JoinEUI.69, $DevEUI.67, DevNonce.79>,
                         AesKey('Nwk', ~rootNwkKey.75), tau_c.89)
    // loop breakers: [0,2]
  */

rule (modulo E) ApplicationServer_Receive_JoinAnswer:
   [
   AS_State_01( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce ),
   In_S( $JoinEUI, $AS,
         <'EncAppSKey', $DevEUI, $AS, JoinNonce, AppNonceRec, AppSKey>
   )
   ]
  --[
  Eq( AppNonceRec, AppNonce ),
  ApplicationServerReceivesJoinResponse( $JoinEUI, $DevEUI, $NS, $AS,
                                         DevNonce, AppNonce, JoinNonce
  )
  ]->
   [
   AS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce,
                JoinNonce, AppSKey
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NetworkServer_Receive_JoinAnswer:
   [
   NS_State_01( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, NSNonce ),
   In( <$JoinEUI, $NS, <'Join_Accept', $DevEUI, Response(ans)>, 
        'SessionKeys', $DevEUI, $NS, 
        Nonce(<$DevEUI, ctr_JS, rndJoinNonce>), NSNonceRec, FNwkSIntKey, 
        SNwkSIntKey, NwkSEncKey>
   )
   ]
  --[
  Eq( NSNonceRec, NSNonce ),
  NetworkServerReceivesJoinResponse( $JoinEUI, $DevEUI, $NS, $AS,
                                     DevNonce, NSNonce, Nonce(<$DevEUI, ctr_JS, rndJoinNonce>)
  ),
  MaxResponses( $DevEUI, $JoinEUI, ctr_JS ), Neq( ctr_JS, '2' ),
  OnlyOnce( 'NetworkServer_Receive_JoinAnswer' )
  ]->
   [
   NS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce,
                Nonce(<$DevEUI, ctr_JS, rndJoinNonce>), NSNonce, FNwkSIntKey,
                SNwkSIntKey, NwkSEncKey
   ),
   Out( <'Join_Accept', $DevEUI, Response(ans)> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Device_Receive_JoinAccept:
   [
   In( <'Join_Accept', $DevEUI, 
        Response(senc(<Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), 
                       NSNonce, AppNonce, NetID, DevAddr, 'opt_params', tau_s>,
                      NwkKey))
       >
   ),
   ED_State_02( $DevEUI, $JoinEUI, $NS, $AS, DevNonce ),
   !Ltk_shared( $DevEUI, $JoinEUI, AesKey('Nwk', ~rootNwkKey) ),
   !Ltk_shared( $DevEUI, $JoinEUI, AesKey('App', ~rootAppKey) ),
   CheckCtrJS( $DevEUI, ctr_JS )
   ]
  --[
  Eq( verifyMAC(<'0xFF', $JoinEUI, DevNonce, 'MHDR', 
                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), NSNonce, AppNonce, 
                 NetID, DevAddr, 'opt_params'>,
                SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey))),
                tau_s),
      accept
  ),
  OnlyOnce( 'Device_Receive_JoinAccept' ),
  LessThan( ctr_JS, ctr_JS_in ),
  DeviceJoinAccept( $DevEUI, $NS, $AS, $JoinEUI, DevNonce,
                    Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), NSNonce, AppNonce
  ),
  Commit( 'Join_ED_JS', $DevEUI, $JoinEUI,
          <NSNonce, AppNonce, 
           SessionKey(senc(<'0x01', 
                            Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                            NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey))), 
           SessionKey(senc(<'0x03', 
                            Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                            NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey))), 
           SessionKey(senc(<'0x04', 
                            Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                            NSNonce, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey))), 
           SessionKey(senc(<'0x02', 
                            Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                            AppNonce, 'pad_with_0s'>,
                           AesKey('App', ~rootAppKey))), 
           SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                           AesKey('Nwk', ~rootNwkKey)))
          >
  ),
  Commit( 'Join_ED_JS_confree', $DevEUI, $JoinEUI,
          <AppNonce, 
           SessionKey(senc(<'0x02', 
                            Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                            AppNonce, 'pad_with_0s'>,
                           AesKey('App', ~rootAppKey)))
          >
  ),
  Secret( $DevEUI, $JoinEUI,
          <NSNonce, AppNonce, Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>)>
  ),
  Honest( $DevEUI ), Honest( $JoinEUI ), Honest( $AS ),
  Role( 'EndDevice' ), MaxResponses( $DevEUI, $JoinEUI, ctr_JS ),
  Neq( ctr_JS_in, '2' )
  ]->
   [
   CheckCtrJS( $DevEUI, ctr_JS_in ),
   ED_State_03( $DevEUI, $JoinEUI, $NS, $AS, DevNonce,
                Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), NSNonce, AppNonce,
                SessionKey(senc(<'0x01', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey))),
                SessionKey(senc(<'0x03', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey))),
                SessionKey(senc(<'0x04', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey))),
                SessionKey(senc(<'0x02', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 AppNonce, 'pad_with_0s'>,
                                AesKey('App', ~rootAppKey)))
   ),
   !Ltk_shared( $DevEUI, $NS,
                SessionKey(senc(<'0x01', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey)))
   ),
   !Ltk_shared( $DevEUI, $NS,
                SessionKey(senc(<'0x03', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey)))
   ),
   !Ltk_shared( $DevEUI, $NS,
                SessionKey(senc(<'0x04', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 NSNonce, 'pad_with_0s'>,
                                AesKey('Nwk', ~rootNwkKey)))
   ),
   !Ltk_shared( $DevEUI, $AS,
                SessionKey(senc(<'0x02', 
                                 Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                                 AppNonce, 'pad_with_0s'>,
                                AesKey('App', ~rootAppKey)))
   )
   ]

  // loop breaker: [4]
  /*
  rule (modulo AC) Device_Receive_JoinAccept:
     [
     In( <'Join_Accept', $DevEUI, 
          Response(senc(<Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), 
                         NSNonce, AppNonce, NetID, DevAddr, 'opt_params', tau_s>,
                        NwkKey))
         >
     ),
     ED_State_02( $DevEUI, $JoinEUI, $NS, $AS, DevNonce ),
     !Ltk_shared( $DevEUI, $JoinEUI, AesKey('Nwk', ~rootNwkKey) ),
     !Ltk_shared( $DevEUI, $JoinEUI, AesKey('App', ~rootAppKey) ),
     CheckCtrJS( $DevEUI, ctr_JS )
     ]
    --[
    Eq( z, accept ), OnlyOnce( 'Device_Receive_JoinAccept' ),
    LessThan( ctr_JS, ctr_JS_in ),
    DeviceJoinAccept( $DevEUI, $NS, $AS, $JoinEUI, DevNonce,
                      Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), NSNonce, AppNonce
    ),
    Commit( 'Join_ED_JS', $DevEUI, $JoinEUI,
            <NSNonce, AppNonce, 
             SessionKey(senc(<'0x01', 
                              Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                              NSNonce, 'pad_with_0s'>,
                             AesKey('Nwk', ~rootNwkKey))), 
             SessionKey(senc(<'0x03', 
                              Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                              NSNonce, 'pad_with_0s'>,
                             AesKey('Nwk', ~rootNwkKey))), 
             SessionKey(senc(<'0x04', 
                              Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                              NSNonce, 'pad_with_0s'>,
                             AesKey('Nwk', ~rootNwkKey))), 
             SessionKey(senc(<'0x02', 
                              Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                              AppNonce, 'pad_with_0s'>,
                             AesKey('App', ~rootAppKey))), 
             SessionKey(senc(<'0x06', $DevEUI, 'pad_with_0s'>,
                             AesKey('Nwk', ~rootNwkKey)))
            >
    ),
    Commit( 'Join_ED_JS_confree', $DevEUI, $JoinEUI,
            <AppNonce, 
             SessionKey(senc(<'0x02', 
                              Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, DevNonce, 
                              AppNonce, 'pad_with_0s'>,
                             AesKey('App', ~rootAppKey)))
            >
    ),
    Secret( $DevEUI, $JoinEUI,
            <NSNonce, AppNonce, Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>)>
    ),
    Honest( $DevEUI ), Honest( $JoinEUI ), Honest( $AS ),
    Role( 'EndDevice' ), MaxResponses( $DevEUI, $JoinEUI, ctr_JS ),
    Neq( ctr_JS_in, '2' )
    ]->
     [
     CheckCtrJS( $DevEUI, ctr_JS_in ),
     ED_State_03( $DevEUI, $JoinEUI, $NS, $AS, DevNonce,
                  Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), NSNonce, AppNonce,
                  SessionKey(senc(<'0x01', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey))),
                  SessionKey(senc(<'0x03', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey))),
                  SessionKey(senc(<'0x04', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey))),
                  SessionKey(senc(<'0x02', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, AppNonce, 'pad_with_0s'>,
                                  AesKey('App', ~rootAppKey)))
     ),
     !Ltk_shared( $DevEUI, $NS,
                  SessionKey(senc(<'0x01', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey)))
     ),
     !Ltk_shared( $DevEUI, $NS,
                  SessionKey(senc(<'0x03', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey)))
     ),
     !Ltk_shared( $DevEUI, $NS,
                  SessionKey(senc(<'0x04', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, NSNonce, 'pad_with_0s'>,
                                  AesKey('Nwk', ~rootNwkKey)))
     ),
     !Ltk_shared( $DevEUI, $AS,
                  SessionKey(senc(<'0x02', 
                                   Nonce(<$DevEUI_in, ctr_JS_in, rndJoinNonce>), $JoinEUI, 
                                   DevNonce, AppNonce, 'pad_with_0s'>,
                                  AesKey('App', ~rootAppKey)))
     )
     ]
    variants (modulo AC)
    1. $DevEUI
             = $DevEUI.43
       $DevEUI_in
             = $DevEUI_in.44
       $JoinEUI
             = $JoinEUI.45
       ~rootNwkKey
             = ~rootNwkKey.48
       AppNonce
             = AppNonce.49
       DevAddr
             = DevAddr.50
       DevNonce
             = DevNonce.51
       NSNonce
             = NSNonce.52
       NetID = NetID.53
       ctr_JS_in
             = ctr_JS_in.56
       rndJoinNonce
             = rndJoinNonce.57
       tau_s = MAC(<'0xFF', $JoinEUI.45, DevNonce.51, 'MHDR', 
                    Nonce(<$DevEUI_in.44, ctr_JS_in.56, rndJoinNonce.57>), NSNonce.52, 
                    AppNonce.49, NetID.53, DevAddr.50, 'opt_params'>,
                   SessionKey(senc(<'0x06', $DevEUI.43, 'pad_with_0s'>,
                                   AesKey('Nwk', ~rootNwkKey.48))))
       z     = accept
    
    2. $DevEUI
             = $DevEUI.44
       $DevEUI_in
             = $DevEUI_in.45
       $JoinEUI
             = $JoinEUI.46
       ~rootNwkKey
             = ~rootNwkKey.49
       AppNonce
             = AppNonce.50
       DevAddr
             = DevAddr.51
       DevNonce
             = DevNonce.52
       NSNonce
             = NSNonce.53
       NetID = NetID.54
       ctr_JS_in
             = ctr_JS_in.57
       rndJoinNonce
             = rndJoinNonce.58
       tau_s = tau_s.59
       z     = verifyMAC(<'0xFF', $JoinEUI.46, DevNonce.52, 'MHDR', 
                          Nonce(<$DevEUI_in.45, ctr_JS_in.57, rndJoinNonce.58>), NSNonce.53, 
                          AppNonce.50, NetID.54, DevAddr.51, 'opt_params'>,
                         SessionKey(senc(<'0x06', $DevEUI.44, 'pad_with_0s'>,
                                         AesKey('Nwk', ~rootNwkKey.49))),
                         tau_s.59)
    // loop breaker: [4]
  */

rule (modulo E) Device_Send_KeyConf_NS:
   [
   ED_State_03( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey
   )
   ]
  --[
  DeviceSendsKeyConfToNS( $DevEUI, $NS, $AS,
                          senc(<DevNonce, NSNonce>, NwkSEncKey)
  ),
  Running( 'Join_ED_NS', $DevEUI, $NS, NwkSEncKey ),
  Role( 'EndDevice' ), MaxRequests( $DevEUI, $JoinEUI, DevNonce ),
  Honest( $DevEUI ), Honest( $NS ),
  OnlyOnce( 'Device_Send_KeyConf_To_NS' )
  ]->
   [
   Out( <$DevEUI, $NS, 
         PD_Wrapper(senc(<$DevEUI, $NS, 
                          senc(<DevNonce, NSNonce>, NwkSEncKey), 
                          MAC(<$DevEUI, $NS, senc(<DevNonce, NSNonce>, NwkSEncKey)>,
                              SNwkSIntKey)
                         >,
                         NwkSEncKey)), 
         'KeyConfToNS'>
   ),
   ED_State_04( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                'SentKeyConfToNS'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NS_Send_KeyConf_to_ED:
   [
   In( <$DevEUI, $NS, 
        PD_Wrapper(senc(<$DevEUI, $NS, 
                         senc(<DevNonceRec, NSNonceRec>, NwkSEncKey), tauRec>,
                        NwkSEncKey)), 
        'KeyConfToNS'>
   ),
   NS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey
   )
   ]
  --[
  Eq( DevNonce, DevNonceRec ), Eq( NSNonce, NSNonceRec ),
  Eq( verifyMAC(<$DevEUI, $NS, 
                 senc(<DevNonceRec, NSNonceRec>, NwkSEncKey)>,
                SNwkSIntKey, tauRec),
      accept
  ),
  NSReceivedKeyConfFromED( $DevEUI, $NS, DevNonce, NSNonce,
                           senc(<DevNonceRec, NSNonceRec>, NwkSEncKey)
  ),
  Commit( 'Join_ED_NS', $NS, $DevEUI, NwkSEncKey ),
  Running( 'Join_NS_ED', $NS, $DevEUI, NwkSEncKey ), Honest( $NS ),
  Honest( $DevEUI ), Role( 'NwkServer' ),
  OnlyOnce( 'NS_Send_KeyConf_to_ED' )
  ]->
   [
   Out( <$NS, $DevEUI, 
         PD_Wrapper(senc(<$NS, $DevEUI, 
                          senc(<JoinNonce, NSNonce>, NwkSEncKey), 
                          MAC(<$DevEUI, $NS, senc(<JoinNonce, NSNonce>, NwkSEncKey)>,
                              SNwkSIntKey)
                         >,
                         NwkSEncKey)), 
         'KeyConfNSToDev'>
   ),
   NS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, 'SentKeyConfToDev'
   )
   ]

  /*
  rule (modulo AC) NS_Send_KeyConf_to_ED:
     [
     In( <$DevEUI, $NS, 
          PD_Wrapper(senc(<$DevEUI, $NS, 
                           senc(<DevNonceRec, NSNonceRec>, NwkSEncKey), tauRec>,
                          NwkSEncKey)), 
          'KeyConfToNS'>
     ),
     NS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey
     )
     ]
    --[
    Eq( DevNonce, DevNonceRec ), Eq( NSNonce, NSNonceRec ),
    Eq( z, accept ),
    NSReceivedKeyConfFromED( $DevEUI, $NS, DevNonce, NSNonce,
                             senc(<DevNonceRec, NSNonceRec>, NwkSEncKey)
    ),
    Commit( 'Join_ED_NS', $NS, $DevEUI, NwkSEncKey ),
    Running( 'Join_NS_ED', $NS, $DevEUI, NwkSEncKey ), Honest( $NS ),
    Honest( $DevEUI ), Role( 'NwkServer' ),
    OnlyOnce( 'NS_Send_KeyConf_to_ED' )
    ]->
     [
     Out( <$NS, $DevEUI, 
           PD_Wrapper(senc(<$NS, $DevEUI, 
                            senc(<JoinNonce, NSNonce>, NwkSEncKey), 
                            MAC(<$DevEUI, $NS, senc(<JoinNonce, NSNonce>, NwkSEncKey)>,
                                SNwkSIntKey)
                           >,
                           NwkSEncKey)), 
           'KeyConfNSToDev'>
     ),
     NS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, 'SentKeyConfToDev'
     )
     ]
    variants (modulo AC)
    1. $DevEUI
             = $DevEUI.29
       $NS   = $NS.31
       DevNonceRec
             = DevNonceRec.33
       NSNonceRec
             = NSNonceRec.37
       NwkSEncKey
             = NwkSEncKey.38
       SNwkSIntKey
             = SNwkSIntKey.39
       tauRec
             = MAC(<$DevEUI.29, $NS.31, 
                    senc(<DevNonceRec.33, NSNonceRec.37>, NwkSEncKey.38)>,
                   SNwkSIntKey.39)
       z     = accept
    
    2. $DevEUI
             = $DevEUI.30
       $NS   = $NS.32
       DevNonceRec
             = DevNonceRec.34
       NSNonceRec
             = NSNonceRec.38
       NwkSEncKey
             = NwkSEncKey.39
       SNwkSIntKey
             = SNwkSIntKey.40
       tauRec
             = tauRec.41
       z     = verifyMAC(<$DevEUI.30, $NS.32, 
                          senc(<DevNonceRec.34, NSNonceRec.38>, NwkSEncKey.39)>,
                         SNwkSIntKey.40, tauRec.41)
  */

rule (modulo E) Device_Send_KeyConf_AS:
   [
   ED_State_04( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                'SentKeyConfToNS'
   ),
   In( <$NS, $DevEUI, 
        PD_Wrapper(senc(<$NS, $DevEUI, 
                         senc(<JoinNonceRec, NSNonceRec>, NwkSEncKey), tauRec>,
                        NwkSEncKey)), 
        'KeyConfNSToDev'>
   )
   ]
  --[
  Eq( JoinNonce, JoinNonceRec ), Eq( NSNonce, NSNonceRec ),
  Eq( verifyMAC(<$DevEUI, $NS, 
                 senc(<JoinNonceRec, NSNonceRec>, NwkSEncKey)>,
                SNwkSIntKey, tauRec),
      accept
  ),
  DeviceRecKeyConfFromNSSentKeyConfToAS( $DevEUI, $NS, $AS,
                                         senc(<JoinNonceRec, NSNonceRec>, NwkSEncKey),
                                         senc(<DevNonce, AppNonce>, AppSKey)
  ),
  Commit( 'Join_NS_ED', $DevEUI, $NS, NwkSEncKey ),
  Running( 'Join_ED_AS', $DevEUI, $AS, AppSKey ),
  Role( 'EndDevice' ), MaxRequests( $DevEUI, $JoinEUI, DevNonce ),
  Honest( $DevEUI ), Honest( $AS ), Honest( $NS ),
  OnlyOnce( 'Device_Send_KeyConf_AS' )
  ]->
   [
   Out( <$DevEUI, $NS, 
         PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                          senc(<DevNonce, AppNonce>, AppSKey), 
                          MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                              AppSKey), 
                          MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey), 
                               MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                                   AppSKey)
                              >,
                              FNwkSIntKey)
                         >,
                         NwkSEncKey)), 
         'KeyConfToAS'>
   ),
   ED_State_05( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                'SentKeyConfToAS'
   )
   ]

  /*
  rule (modulo AC) Device_Send_KeyConf_AS:
     [
     ED_State_04( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                  'SentKeyConfToNS'
     ),
     In( <$NS, $DevEUI, 
          PD_Wrapper(senc(<$NS, $DevEUI, 
                           senc(<JoinNonceRec, NSNonceRec>, NwkSEncKey), tauRec>,
                          NwkSEncKey)), 
          'KeyConfNSToDev'>
     )
     ]
    --[
    Eq( JoinNonce, JoinNonceRec ), Eq( NSNonce, NSNonceRec ),
    Eq( z, accept ),
    DeviceRecKeyConfFromNSSentKeyConfToAS( $DevEUI, $NS, $AS,
                                           senc(<JoinNonceRec, NSNonceRec>, NwkSEncKey),
                                           senc(<DevNonce, AppNonce>, AppSKey)
    ),
    Commit( 'Join_NS_ED', $DevEUI, $NS, NwkSEncKey ),
    Running( 'Join_ED_AS', $DevEUI, $AS, AppSKey ),
    Role( 'EndDevice' ), MaxRequests( $DevEUI, $JoinEUI, DevNonce ),
    Honest( $DevEUI ), Honest( $AS ), Honest( $NS ),
    OnlyOnce( 'Device_Send_KeyConf_AS' )
    ]->
     [
     Out( <$DevEUI, $NS, 
           PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                            senc(<DevNonce, AppNonce>, AppSKey), 
                            MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                                AppSKey), 
                            MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey), 
                                 MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                                     AppSKey)
                                >,
                                FNwkSIntKey)
                           >,
                           NwkSEncKey)), 
           'KeyConfToAS'>
     ),
     ED_State_05( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                  'SentKeyConfToAS'
     )
     ]
    variants (modulo AC)
    1. $DevEUI
             = $DevEUI.34
       $NS   = $NS.36
       JoinNonceRec
             = JoinNonceRec.42
       NSNonceRec
             = NSNonceRec.44
       NwkSEncKey
             = NwkSEncKey.45
       SNwkSIntKey
             = SNwkSIntKey.46
       tauRec
             = MAC(<$DevEUI.34, $NS.36, 
                    senc(<JoinNonceRec.42, NSNonceRec.44>, NwkSEncKey.45)>,
                   SNwkSIntKey.46)
       z     = accept
    
    2. $DevEUI
             = $DevEUI.35
       $NS   = $NS.37
       JoinNonceRec
             = JoinNonceRec.43
       NSNonceRec
             = NSNonceRec.45
       NwkSEncKey
             = NwkSEncKey.46
       SNwkSIntKey
             = SNwkSIntKey.47
       tauRec
             = tauRec.48
       z     = verifyMAC(<$DevEUI.35, $NS.37, 
                          senc(<JoinNonceRec.43, NSNonceRec.45>, NwkSEncKey.46)>,
                         SNwkSIntKey.47, tauRec.48)
  */

rule (modulo E) NS_Send_KeyConf_to_AS:
   [
   In( <$DevEUI, $NS, 
        PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                         senc(<DevNonce, AppNonce>, AppSKey), 
                         MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                             AppSKey), 
                         tauNS>,
                        NwkSEncKey)), 
        'KeyConfToAS'>
   ),
   NS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, 'SentKeyConfToDev'
   )
   ]
  --[
  Eq( verifyMAC(<$DevEUI, $NS, $AS, 
                 senc(<DevNonce, AppNonce>, AppSKey), 
                 MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                     AppSKey)
                >,
                FNwkSIntKey, tauNS),
      accept
  ),
  NSReceivedKeyConfFromEDForAS( $DevEUI, $NS, $AS,
                                senc(<DevNonce, AppNonce>, AppSKey)
  ),
  MaxRequests( $DevEUI, $JoinEUI, DevNonce ),
  OnlyOnce( 'NS_Send_KeyConf_to_AS' )
  ]->
   [
   Out( <$NS, $AS, PD_Wrapper(senc(<DevNonce, AppNonce>, AppSKey)), 
         MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
             AppSKey), 
         'KeyConfNSFromDevToAS'>
   ),
   NS_State_04( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey,
                'SentKeyConfFromNStoAS'
   )
   ]

  /*
  rule (modulo AC) NS_Send_KeyConf_to_AS:
     [
     In( <$DevEUI, $NS, 
          PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                           senc(<DevNonce, AppNonce>, AppSKey), 
                           MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
                               AppSKey), 
                           tauNS>,
                          NwkSEncKey)), 
          'KeyConfToAS'>
     ),
     NS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, 'SentKeyConfToDev'
     )
     ]
    --[
    Eq( z, accept ),
    NSReceivedKeyConfFromEDForAS( $DevEUI, $NS, $AS,
                                  senc(<DevNonce, AppNonce>, AppSKey)
    ),
    MaxRequests( $DevEUI, $JoinEUI, DevNonce ),
    OnlyOnce( 'NS_Send_KeyConf_to_AS' )
    ]->
     [
     Out( <$NS, $AS, PD_Wrapper(senc(<DevNonce, AppNonce>, AppSKey)), 
           MAC(<$DevEUI, $NS, $AS, senc(<DevNonce, AppNonce>, AppSKey)>,
               AppSKey), 
           'KeyConfNSFromDevToAS'>
     ),
     NS_State_04( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey,
                  'SentKeyConfFromNStoAS'
     )
     ]
    variants (modulo AC)
    1. $AS   = $AS.27
       $DevEUI
             = $DevEUI.28
       $NS   = $NS.30
       AppNonce
             = AppNonce.31
       AppSKey
             = AppSKey.32
       DevNonce
             = DevNonce.33
       FNwkSIntKey
             = FNwkSIntKey.34
       tauNS = MAC(<$DevEUI.28, $NS.30, $AS.27, 
                    senc(<DevNonce.33, AppNonce.31>, AppSKey.32), 
                    MAC(<$DevEUI.28, $NS.30, $AS.27, 
                         senc(<DevNonce.33, AppNonce.31>, AppSKey.32)>,
                        AppSKey.32)
                   >,
                   FNwkSIntKey.34)
       z     = accept
    
    2. $AS   = $AS.32
       $DevEUI
             = $DevEUI.33
       $NS   = $NS.35
       AppNonce
             = AppNonce.36
       AppSKey
             = AppSKey.37
       DevNonce
             = DevNonce.38
       FNwkSIntKey
             = FNwkSIntKey.39
       tauNS = tauNS.44
       z     = verifyMAC(<$DevEUI.33, $NS.35, $AS.32, 
                          senc(<DevNonce.38, AppNonce.36>, AppSKey.37), 
                          MAC(<$DevEUI.33, $NS.35, $AS.32, 
                               senc(<DevNonce.38, AppNonce.36>, AppSKey.37)>,
                              AppSKey.37)
                         >,
                         FNwkSIntKey.39, tauNS.44)
  */

rule (modulo E) AS_Receive_KeyConf:
   [
   In( <$NS, $AS, 
        PD_Wrapper(senc(<DevNonceRec, AppNonceRec>, AppSKey)), tauAS, 
        'KeyConfNSFromDevToAS'>
   ),
   AS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce,
                JoinNonce, AppSKey
   )
   ]
  --[
  Eq( DevNonceRec, DevNonce ), Eq( AppNonceRec, AppNonce ),
  Eq( verifyMAC(<$DevEUI, $NS, $AS, 
                 senc(<DevNonceRec, AppNonceRec>, AppSKey)>,
                AppSKey, tauAS),
      accept
  ),
  ASReceivesSendsKeyConf( $DevEUI, $NS, $AS,
                          senc(<DevNonceRec, AppNonceRec>, AppSKey),
                          senc(<JoinNonce, AppNonce>, AppSKey)
  ),
  Commit( 'Join_ED_AS', $AS, $DevEUI, AppSKey ),
  Running( 'Join_AS_ED', $AS, $DevEUI, <JoinNonce, AppNonce, AppSKey>
  ),
  Running( 'Join_AS_ED_confree', $AS, $DevEUI, <AppNonce, AppSKey> ),
  Role( 'AppServer' ), Honest( $DevEUI ), Honest( $AS ),
  OnlyOnce( 'AS_Receive_KeyConf' )
  ]->
   [
   Out( <$AS, $NS, senc(<JoinNonce, AppNonce>, AppSKey), 
         MAC(senc(<JoinNonce, AppNonce>, AppSKey), AppSKey), 
         'KeyConfAnsFromAStoNS'>
   ),
   AS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce,
                JoinNonce, AppSKey, 'ASKeyConfSent'
   )
   ]

  /*
  rule (modulo AC) AS_Receive_KeyConf:
     [
     In( <$NS, $AS, 
          PD_Wrapper(senc(<DevNonceRec, AppNonceRec>, AppSKey)), tauAS, 
          'KeyConfNSFromDevToAS'>
     ),
     AS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce,
                  JoinNonce, AppSKey
     )
     ]
    --[
    Eq( DevNonceRec, DevNonce ), Eq( AppNonceRec, AppNonce ),
    Eq( z, accept ),
    ASReceivesSendsKeyConf( $DevEUI, $NS, $AS,
                            senc(<DevNonceRec, AppNonceRec>, AppSKey),
                            senc(<JoinNonce, AppNonce>, AppSKey)
    ),
    Commit( 'Join_ED_AS', $AS, $DevEUI, AppSKey ),
    Running( 'Join_AS_ED', $AS, $DevEUI, <JoinNonce, AppNonce, AppSKey>
    ),
    Running( 'Join_AS_ED_confree', $AS, $DevEUI, <AppNonce, AppSKey> ),
    Role( 'AppServer' ), Honest( $DevEUI ), Honest( $AS ),
    OnlyOnce( 'AS_Receive_KeyConf' )
    ]->
     [
     Out( <$AS, $NS, senc(<JoinNonce, AppNonce>, AppSKey), 
           MAC(senc(<JoinNonce, AppNonce>, AppSKey), AppSKey), 
           'KeyConfAnsFromAStoNS'>
     ),
     AS_State_03( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, AppNonce,
                  JoinNonce, AppSKey, 'ASKeyConfSent'
     )
     ]
    variants (modulo AC)
    1. $AS   = $AS.25
       $DevEUI
             = $DevEUI.26
       $NS   = $NS.28
       AppNonceRec
             = AppNonceRec.30
       AppSKey
             = AppSKey.31
       DevNonceRec
             = DevNonceRec.33
       tauAS = MAC(<$DevEUI.26, $NS.28, $AS.25, 
                    senc(<DevNonceRec.33, AppNonceRec.30>, AppSKey.31)>,
                   AppSKey.31)
       z     = accept
    
    2. $AS   = $AS.27
       $DevEUI
             = $DevEUI.28
       $NS   = $NS.30
       AppNonceRec
             = AppNonceRec.32
       AppSKey
             = AppSKey.33
       DevNonceRec
             = DevNonceRec.35
       tauAS = tauAS.37
       z     = verifyMAC(<$DevEUI.28, $NS.30, $AS.27, 
                          senc(<DevNonceRec.35, AppNonceRec.32>, AppSKey.33)>,
                         AppSKey.33, tauAS.37)
  */

rule (modulo E) NS_Send_KeyConfAns_to_ED:
   [
   In( <$AS, $NS, encDataAS, tauAS, 'KeyConfAnsFromAStoNS'> ),
   NS_State_04( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey,
                'SentKeyConfFromNStoAS'
   )
   ]
  --[
  NSReceivedKeyConfFromASForED( $DevEUI, $NS, $AS,
                                senc(<encDataAS, tauAS>, NwkSEncKey)
  ),
  OnlyOnce( 'NS_Send_KeyConfAns_to_ED' )
  ]->
   [
   Out( <$NS, $DevEUI, 
         PD_Wrapper(senc(<encDataAS, tauAS>, NwkSEncKey)), 
         'KeyConfNSFromDevToAS'>
   ),
   NS_State_05( $JoinEUI, $DevEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey,
                senc(<encDataAS, tauAS>, NwkSEncKey), 'SentKeyConfFromAStoED'
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) ED_Receives_KeyConfAns_from_AS_via_NS:
   [
   In( <$NS, $DevEUI, 
        PD_Wrapper(senc(<senc(<JoinNonceRec, AppNonceRec>, AppSKey), tauAS
                        >,
                        NwkSEncKey)), 
        'KeyConfNSFromDevToAS'>
   ),
   ED_State_05( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                'SentKeyConfToAS'
   )
   ]
  --[
  Eq( JoinNonceRec, JoinNonce ), Eq( AppNonceRec, AppNonce ),
  Eq( verifyMAC(senc(<JoinNonceRec, AppNonceRec>, AppSKey), AppSKey,
                tauAS),
      accept
  ),
  EDAcceptedKeyConf( $NS, $AS,
                     senc(<JoinNonceRec, AppNonceRec>, AppSKey),
                     senc(<senc(<JoinNonceRec, AppNonceRec>, AppSKey), tauAS>,
                          NwkSEncKey)
  ),
  Commit( 'Join_AS_ED', $DevEUI, $AS, <JoinNonce, AppNonce, AppSKey>
  ),
  Role( 'EndDevice' ), Honest( $JoinEUI ), Honest( $DevEUI ),
  Honest( $AS ), OnlyOnce( 'ED_Receives_KeyConfAns_from_AS_via_NS' )
  ]->
   [ ]

  /*
  rule (modulo AC) ED_Receives_KeyConfAns_from_AS_via_NS:
     [
     In( <$NS, $DevEUI, 
          PD_Wrapper(senc(<senc(<JoinNonceRec, AppNonceRec>, AppSKey), tauAS
                          >,
                          NwkSEncKey)), 
          'KeyConfNSFromDevToAS'>
     ),
     ED_State_05( $DevEUI, $JoinEUI, $NS, $AS, DevNonce, JoinNonce,
                  NSNonce, AppNonce, FNwkSIntKey, SNwkSIntKey, NwkSEncKey, AppSKey,
                  'SentKeyConfToAS'
     )
     ]
    --[
    Eq( JoinNonceRec, JoinNonce ), Eq( AppNonceRec, AppNonce ),
    Eq( z, accept ),
    EDAcceptedKeyConf( $NS, $AS,
                       senc(<JoinNonceRec, AppNonceRec>, AppSKey),
                       senc(<senc(<JoinNonceRec, AppNonceRec>, AppSKey), tauAS>,
                            NwkSEncKey)
    ),
    Commit( 'Join_AS_ED', $DevEUI, $AS, <JoinNonce, AppNonce, AppSKey>
    ),
    Role( 'EndDevice' ), Honest( $JoinEUI ), Honest( $DevEUI ),
    Honest( $AS ), OnlyOnce( 'ED_Receives_KeyConfAns_from_AS_via_NS' )
    ]->
     [ ]
    variants (modulo AC)
    1. AppNonceRec
             = AppNonceRec.25
       AppSKey
             = AppSKey.26
       JoinNonceRec
             = JoinNonceRec.30
       tauAS = MAC(senc(<JoinNonceRec.30, AppNonceRec.25>, AppSKey.26),
                   AppSKey.26)
       z     = accept
    
    2. AppNonceRec
             = AppNonceRec.29
       AppSKey
             = AppSKey.30
       JoinNonceRec
             = JoinNonceRec.34
       tauAS = tauAS.38
       z     = verifyMAC(senc(<JoinNonceRec.34, AppNonceRec.29>,
                              AppSKey.30),
                         AppSKey.30, tauAS.38)
  */

lemma correctness:
  exists-trace
  "∃ JoinEUI AS NS DevEUI #t01 #t02 #t03 #t04 #t05 #t06 #t07 #t08
     DevNonce #t09 NSNonce #t10 AppNonce #t11 JoinNonce #t12 #t13 #t14
     #t15 encData #t16 #t17 encDataNS encData2 #t18 #t19 encData3 #t20
     encData4 #t21.
    ((((((((((((((((((((((((((((((((((((((((((EntityInit( 'JS', JoinEUI
                                              ) @ #t01) ∧
                                             (EntityInit( 'NS', NS ) @ #t02)) ∧
                                            (EntityInit( 'AS', AS ) @ #t03)) ∧
                                           (EntityInit( 'ED', DevEUI ) @ #t04)) ∧
                                          (Linked_ED_With_JS_NS_AS( DevEUI, JoinEUI, NS, AS
                                           ) @ #t05)) ∧
                                         (CommissionCompleted( 'ED', DevEUI, JoinEUI, NS, AS
                                          ) @ #t06)) ∧
                                        (CommissionCompleted( 'JS', JoinEUI, DevEUI, NS, AS
                                         ) @ #t07)) ∧
                                       (DeviceJoinRequest( DevEUI, NS, JoinEUI, DevNonce
                                        ) @ #t08)) ∧
                                      (NetworkServerReceiveForwardJoinRequest( JoinEUI, DevEUI, NS,
                                                                               AS, DevNonce, NSNonce
                                       ) @ #t09)) ∧
                                     (ApplicationServerSendJoinRequest( JoinEUI, DevEUI, NS, AS,
                                                                        DevNonce, AppNonce
                                      ) @ #t10)) ∧
                                    (JoinResponseJS( JoinEUI, DevEUI, NS, AS, DevNonce, NSNonce,
                                                     AppNonce, JoinNonce
                                     ) @ #t11)) ∧
                                   (ApplicationServerReceivesJoinResponse( JoinEUI, DevEUI, NS, AS,
                                                                           DevNonce, AppNonce,
                                                                           JoinNonce
                                    ) @ #t12)) ∧
                                  (NetworkServerReceivesJoinResponse( JoinEUI, DevEUI, NS, AS,
                                                                      DevNonce, NSNonce, JoinNonce
                                   ) @ #t13)) ∧
                                 (DeviceJoinAccept( DevEUI, NS, AS, JoinEUI, DevNonce, JoinNonce,
                                                    NSNonce, AppNonce
                                  ) @ #t14)) ∧
                                (DeviceSendsKeyConfToNS( DevEUI, NS, AS, encData ) @ #t15)) ∧
                               (NSReceivedKeyConfFromED( DevEUI, NS, DevNonce, NSNonce, encData
                                ) @ #t16)) ∧
                              (DeviceRecKeyConfFromNSSentKeyConfToAS( DevEUI, NS, AS, encDataNS,
                                                                      encData2
                               ) @ #t17)) ∧
                             (NSReceivedKeyConfFromEDForAS( DevEUI, NS, AS, encData2
                              ) @ #t18)) ∧
                            (ASReceivesSendsKeyConf( DevEUI, NS, AS, encData2, encData3
                             ) @ #t19)) ∧
                           (NSReceivedKeyConfFromASForED( DevEUI, NS, AS, encData4
                            ) @ #t20)) ∧
                          (EDAcceptedKeyConf( NS, AS, encData3, encData4 ) @ #t21)) ∧
                         (¬(∃ RevealEvent ENTITY #k1.
                             KeyReveal( RevealEvent, ENTITY ) @ #k1))) ∧
                        (#t01 < #t02)) ∧
                       (#t02 < #t03)) ∧
                      (#t03 < #t04)) ∧
                     (#t04 < #t05)) ∧
                    (#t05 < #t06)) ∧
                   (#t06 < #t07)) ∧
                  (#t07 < #t08)) ∧
                 (#t08 < #t09)) ∧
                (#t09 < #t10)) ∧
               (#t10 < #t11)) ∧
              (#t11 < #t12)) ∧
             (#t12 < #t13)) ∧
            (#t13 < #t14)) ∧
           (#t14 < #t15)) ∧
          (#t15 < #t16)) ∧
         (#t16 < #t17)) ∧
        (#t17 < #t18)) ∧
       (#t18 < #t19)) ∧
      (#t19 < #t20)) ∧
     (#t20 < #t21)) ∧
    (∀ event #i #j.
      ((OnlyOnce( event ) @ #i) ∧ (OnlyOnce( event ) @ #j)) ⇒ (#i = #j))"
/*
guarded formula characterizing all satisfying traces:
"∃ JoinEUI AS NS DevEUI #t01 #t02 #t03 #t04 #t05 #t06 #t07 #t08
   DevNonce #t09 NSNonce #t10 AppNonce #t11 JoinNonce #t12 #t13 #t14
   #t15 encData #t16 #t17 encDataNS encData2 #t18 #t19 encData3 #t20
   encData4 #t21.
  (EntityInit( 'JS', JoinEUI ) @ #t01) ∧
  (EntityInit( 'NS', NS ) @ #t02) ∧
  (EntityInit( 'AS', AS ) @ #t03) ∧
  (EntityInit( 'ED', DevEUI ) @ #t04) ∧
  (Linked_ED_With_JS_NS_AS( DevEUI, JoinEUI, NS, AS ) @ #t05) ∧
  (CommissionCompleted( 'ED', DevEUI, JoinEUI, NS, AS ) @ #t06) ∧
  (CommissionCompleted( 'JS', JoinEUI, DevEUI, NS, AS ) @ #t07) ∧
  (DeviceJoinRequest( DevEUI, NS, JoinEUI, DevNonce ) @ #t08) ∧
  (NetworkServerReceiveForwardJoinRequest( JoinEUI, DevEUI, NS, AS,
                                           DevNonce, NSNonce
   ) @ #t09) ∧
  (ApplicationServerSendJoinRequest( JoinEUI, DevEUI, NS, AS,
                                     DevNonce, AppNonce
   ) @ #t10) ∧
  (JoinResponseJS( JoinEUI, DevEUI, NS, AS, DevNonce, NSNonce,
                   AppNonce, JoinNonce
   ) @ #t11) ∧
  (ApplicationServerReceivesJoinResponse( JoinEUI, DevEUI, NS, AS,
                                          DevNonce, AppNonce, JoinNonce
   ) @ #t12) ∧
  (NetworkServerReceivesJoinResponse( JoinEUI, DevEUI, NS, AS,
                                      DevNonce, NSNonce, JoinNonce
   ) @ #t13) ∧
  (DeviceJoinAccept( DevEUI, NS, AS, JoinEUI, DevNonce, JoinNonce,
                     NSNonce, AppNonce
   ) @ #t14) ∧
  (DeviceSendsKeyConfToNS( DevEUI, NS, AS, encData ) @ #t15) ∧
  (NSReceivedKeyConfFromED( DevEUI, NS, DevNonce, NSNonce, encData
   ) @ #t16) ∧
  (DeviceRecKeyConfFromNSSentKeyConfToAS( DevEUI, NS, AS, encDataNS,
                                          encData2
   ) @ #t17) ∧
  (NSReceivedKeyConfFromEDForAS( DevEUI, NS, AS, encData2 ) @ #t18) ∧
  (ASReceivesSendsKeyConf( DevEUI, NS, AS, encData2, encData3
   ) @ #t19) ∧
  (NSReceivedKeyConfFromASForED( DevEUI, NS, AS, encData4 ) @ #t20) ∧
  (EDAcceptedKeyConf( NS, AS, encData3, encData4 ) @ #t21)
 ∧
  (∀ RevealEvent ENTITY #k1.
    (KeyReveal( RevealEvent, ENTITY ) @ #k1) ⇒ ⊥) ∧
  (#t01 < #t02) ∧
  (#t02 < #t03) ∧
  (#t03 < #t04) ∧
  (#t04 < #t05) ∧
  (#t05 < #t06) ∧
  (#t06 < #t07) ∧
  (#t07 < #t08) ∧
  (#t08 < #t09) ∧
  (#t09 < #t10) ∧
  (#t10 < #t11) ∧
  (#t11 < #t12) ∧
  (#t12 < #t13) ∧
  (#t13 < #t14) ∧
  (#t14 < #t15) ∧
  (#t15 < #t16) ∧
  (#t16 < #t17) ∧
  (#t17 < #t18) ∧
  (#t18 < #t19) ∧
  (#t19 < #t20) ∧
  (#t20 < #t21) ∧
  (∀ event #i #j.
    (OnlyOnce( event ) @ #i) ∧ (OnlyOnce( event ) @ #j) ⇒ #i = #j)"
*/
by sorry

lemma AS_confusion_freeness_1 [use_induction]:
  all-traces
  "∀ DevEUIa DevEUIb AppSvr AppNonce1 AppSKey1 AppNonce2 AppSKey2 #i
     #j.
    (((((Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
                  <AppNonce1, AppSKey1>
         ) @ #i) ∧
        (Role( 'AppServer' ) @ #i)) ∧
       (Running( 'Join_AS_ED_confree', AppSvr, DevEUIb,
                 <AppNonce2, AppSKey2>
        ) @ #j)) ∧
      (Role( 'AppServer' ) @ #j)) ∧
     (¬(DevEUIa = DevEUIb))) ⇒
    (((∃ JoinEUI #p #q #r #s.
        (((((((Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
                       <AppNonce1, AppSKey1>
               ) @ #p) ∧
              (Role( 'EndDevice' ) @ #p)) ∧
             (Commit( 'Join_ED_JS_confree', DevEUIb, JoinEUI,
                      <AppNonce2, AppSKey2>
              ) @ #q)) ∧
            (Role( 'EndDevice' ) @ #q)) ∧
           (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIa,
                     <AppNonce1, AppSKey1>
            ) @ #r)) ∧
          (Role( 'JoinServer' ) @ #r)) ∧
         (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIb,
                   <AppNonce2, AppSKey2>
          ) @ #s)) ∧
        (Role( 'JoinServer' ) @ #s)) ∨
      (∃ RevealEvent Entity #kr1.
        (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧
        (Honest( Entity ) @ #i))) ∨
     (∃ RevealEvent Entity #kr2.
       (KeyReveal( RevealEvent, Entity ) @ #kr2) ∧
       (Honest( Entity ) @ #j)))"
/*
guarded formula characterizing all counter-examples:
"∃ DevEUIa DevEUIb AppSvr AppNonce1 AppSKey1 AppNonce2 AppSKey2 #i
   #j.
  (Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
            <AppNonce1, AppSKey1>
   ) @ #i) ∧
  (Role( 'AppServer' ) @ #i) ∧
  (Running( 'Join_AS_ED_confree', AppSvr, DevEUIb,
            <AppNonce2, AppSKey2>
   ) @ #j) ∧
  (Role( 'AppServer' ) @ #j)
 ∧
  (¬(DevEUIa = DevEUIb)) ∧
  (∀ JoinEUI #p #q #r #s.
    (Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
             <AppNonce1, AppSKey1>
     ) @ #p) ∧
    (Role( 'EndDevice' ) @ #p) ∧
    (Commit( 'Join_ED_JS_confree', DevEUIb, JoinEUI,
             <AppNonce2, AppSKey2>
     ) @ #q) ∧
    (Role( 'EndDevice' ) @ #q) ∧
    (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIa,
              <AppNonce1, AppSKey1>
     ) @ #r) ∧
    (Role( 'JoinServer' ) @ #r) ∧
    (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIb,
              <AppNonce2, AppSKey2>
     ) @ #s) ∧
    (Role( 'JoinServer' ) @ #s)
   ⇒
    ⊥) ∧
  (∀ RevealEvent Entity #kr1.
    (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥) ∧
  (∀ RevealEvent Entity #kr2.
    (KeyReveal( RevealEvent, Entity ) @ #kr2) ∧ (Honest( Entity ) @ #j)
   ⇒
    ⊥)"
*/
induction
  case empty_trace
  by contradiction /* from formulas */
next
  case non_empty_trace
  simplify
  solve( (∀ DevEUIa DevEUIb AppSvr AppNonce1 AppSKey1 AppNonce2
            AppSKey2 #i #j.
           (Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
                     <AppNonce1, AppSKey1>
            ) @ #i) ∧
           (Role( 'AppServer' ) @ #i) ∧
           (Running( 'Join_AS_ED_confree', AppSvr, DevEUIb,
                     <AppNonce2, AppSKey2>
            ) @ #j) ∧
           (Role( 'AppServer' ) @ #j)
          ⇒
           ((last(#j)) ∨
            (last(#i)) ∨
            (DevEUIa = DevEUIb) ∨
            (∃ JoinEUI #p #q #r #s.
              (Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
                       <AppNonce1, AppSKey1>
               ) @ #p) ∧
              (Role( 'EndDevice' ) @ #p) ∧
              (Commit( 'Join_ED_JS_confree', DevEUIb, JoinEUI,
                       <AppNonce2, AppSKey2>
               ) @ #q) ∧
              (Role( 'EndDevice' ) @ #q) ∧
              (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIa,
                        <AppNonce1, AppSKey1>
               ) @ #r) ∧
              (Role( 'JoinServer' ) @ #r) ∧
              (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIb,
                        <AppNonce2, AppSKey2>
               ) @ #s) ∧
              (Role( 'JoinServer' ) @ #s)
             ∧
              (¬(last(#s))) ∧ (¬(last(#r))) ∧ (¬(last(#q))) ∧ (¬(last(#p)))) ∨
            (∃ RevealEvent Entity #kr1.
              (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧ (Honest( Entity ) @ #i)
             ∧
              ¬(last(#kr1))) ∨
            (∃ RevealEvent Entity #kr2.
              (KeyReveal( RevealEvent, Entity ) @ #kr2) ∧ (Honest( Entity ) @ #j)
             ∧
              ¬(last(#kr2)))))  ∥
         (∃ ED JoinEUI requests #i.
           (MaxRequests( ED, JoinEUI, requests ) @ #i)
          ∧
           (¬(last(#i))) ∧ (∀ z. ((requests+z) = ('1'+'1'+'1')) ⇒ ⊥))  ∥
         (∃ ED JoinEUI responses #i.
           (MaxResponses( ED, JoinEUI, responses ) @ #i)
          ∧
           (¬(last(#i))) ∧ (∀ z. ((responses+z) = ('2'+'2'+'2')) ⇒ ⊥))  ∥
         (∃ x y #i.
           (LessThan( x, y ) @ #i) ∧ (¬(last(#i))) ∧ (∀ z. ((x+z) = y) ⇒ ⊥)) )
    case case_1
    solve( (last(#j))  ∥ (last(#i))  ∥ (DevEUIa = DevEUIb)  ∥
           (∃ JoinEUI #p #q #r #s.
             (Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
                      <AppNonce1, AppSKey1>
              ) @ #p) ∧
             (Role( 'EndDevice' ) @ #p) ∧
             (Commit( 'Join_ED_JS_confree', DevEUIb, JoinEUI,
                      <AppNonce2, AppSKey2>
              ) @ #q) ∧
             (Role( 'EndDevice' ) @ #q) ∧
             (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIa,
                       <AppNonce1, AppSKey1>
              ) @ #r) ∧
             (Role( 'JoinServer' ) @ #r) ∧
             (Running( 'Join_ED_JS_confree', JoinEUI, DevEUIb,
                       <AppNonce2, AppSKey2>
              ) @ #s) ∧
             (Role( 'JoinServer' ) @ #s)
            ∧
             (¬(last(#s))) ∧ (¬(last(#r))) ∧ (¬(last(#q))) ∧ (¬(last(#p))))  ∥
           (∃ RevealEvent Entity #kr1.
             (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧ (Honest( Entity ) @ #i)
            ∧
             ¬(last(#kr1)))  ∥
           (∃ RevealEvent Entity #kr2.
             (KeyReveal( RevealEvent, Entity ) @ #kr2) ∧ (Honest( Entity ) @ #j)
            ∧
             ¬(last(#kr2))) )
      case case_1
      solve( Role( 'AppServer' ) @ #i )
        case AS_Receive_KeyConf
        solve( Role( 'AppServer' ) @ #j )
          case AS_Receive_KeyConf
          solve( Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
                          <AppNonce1, AppSKey1>
                 ) @ #i )
            case AS_Receive_KeyConf
            solve( Running( 'Join_AS_ED_confree', $AS, DevEUIb,
                            <AppNonce2, AppSKey2>
                   ) @ #j )
              case AS_Receive_KeyConf
              solve( AS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce,
                                  AppNonce, JoinNonce, AppSKey
                     ) ▶₁ #i )
                case ApplicationServer_Receive_JoinAnswer_case_1
                by contradiction /* from formulas */
              next
                case ApplicationServer_Receive_JoinAnswer_case_2
                solve( AS_State_02( $JoinEUI.1, $DevEUI.1, $NS.1, $AS, DevNonce,
                                    AppNonce2, JoinNonce, AppSKey2
                       ) ▶₁ #j )
                  case ApplicationServer_Receive_JoinAnswer_case_1
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_2
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<'MHDR', $JS, $DevEUI, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey))
                                 ) @ #vk.39 )
                            case Device_Join_Request
                            solve( ED_State_01( $DevEUI, $JS, $NS.1, $AS.1, '1' ) ▶₀ #vr.31 )
                              case EndDevice_Commissioned
                              solve( !KU( MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                              AesKey('Nwk', ~rootNwkKey.2))
                                     ) @ #vk.43 )
                                case Device_Join_Request
                                solve( ED_State_01( $DevEUI.1, $JS, $NS.1, $AS.1, '1' ) ▶₀ #vr.38 )
                                  case EndDevice_Commissioned
                                  solve( !KU( PD_Wrapper(senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))))
                                         ) @ #vk.19 )
                                    case NS_Send_KeyConfAns_to_ED_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_2
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_3
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_4
                                    solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.62 )
                                      case AS_Receive_KeyConf
                                      by contradiction /* cyclic */
                                    next
                                      case c_Nonce
                                      by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.90 )
                                    qed
                                  next
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.6, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey)))), 
                                                                 MAC(<$DevEUI.6, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey)))), 
                                                                 MAC(<$DevEUI.6, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey)))), 
                                                                      MAC(<$DevEUI.6, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.63 )
                                      case Device_Send_KeyConf_AS
                                      solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.58 )
                                        case EndDevice_Commissioned
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.57 )
                                          case EndDevice_Commissioned
                                          solve( !KU( PD_Wrapper(senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))))
                                                 ) @ #vk.49 )
                                            case NS_Send_KeyConfAns_to_ED_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_2
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_3
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_4
                                            solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1))))
                                                   ) @ #vk.58 )
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1))))
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1))))
                                                                               >,
                                                                               FNwkSIntKey.1)
                                                                          >,
                                                                          NwkSEncKey))
                                                     ) @ #vk.148 )
                                                case Device_Send_KeyConf_AS
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                      >,
                                                                      FNwkSIntKey.1)
                                                                 >,
                                                                 NwkSEncKey)
                                                       ) @ #vk.162 )
                                                  case c_senc
                                                  by contradiction /* cyclic */
                                                qed
                                              qed
                                            next
                                              case c_MAC
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI.2, $NS, $AS, 
                                                                           senc(<('1'+'1'), AppNonce
                                                                                >,
                                                                                AppSKey), 
                                                                           MAC(<$DevEUI.2, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      AppNonce>,
                                                                                     AppSKey)
                                                                               >,
                                                                               AppSKey), 
                                                                           MAC(<$DevEUI.2, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      AppNonce>,
                                                                                     AppSKey), 
                                                                                MAC(<$DevEUI.2, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           AppNonce
                                                                                          >,
                                                                                          AppSKey)
                                                                                    >,
                                                                                    AppSKey)
                                                                               >,
                                                                               FNwkSIntKey)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1)))))
                                                     ) @ #vk.119 )
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                                             senc(<
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   NSNonce>,
                                                                                  SessionKey(senc(<
                                                                                                   '0x04', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   NSNonce, 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('Nwk',
                                                                                                         ~rootNwkKey)))), 
                                                                             MAC(<$DevEUI, $NS, 
                                                                                  senc(<
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        NSNonce>,
                                                                                       SessionKey(senc(<
                                                                                                        '0x04', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        NSNonce, 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('Nwk',
                                                                                                              ~rootNwkKey))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x03', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  NSNonce, 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('Nwk',
                                                                                                        ~rootNwkKey))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x04', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             NSNonce, 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('Nwk',
                                                                                                   ~rootNwkKey)))))
                                                       ) @ #vk.127 )
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  solve( !KU( PD_Wrapper(senc(<$DevEUI.2, $NS, 
                                                                               senc(<('1'+'1'), 
                                                                                     Nonce(~rnd32DevAddr.3)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1)))), 
                                                                               MAC(<$DevEUI.2, $NS, 
                                                                                    senc(<
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~rnd32DevAddr.3)
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1))))
                                                                                   >,
                                                                                   SNwkSIntKey.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))))
                                                         ) @ #vk.163 )
                                                    case NS_Send_KeyConfAns_to_ED_case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_2
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_3
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_4
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.182 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.257 )
                                                    qed
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_2
                                                    by contradiction /* from formulas */
                                                  next
                                                    case c_PD_Wrapper
                                                    solve( !KU( senc(<
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      NSNonce>,
                                                                     SessionKey(senc(<'0x04', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      NSNonce, 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('Nwk',
                                                                                            ~rootNwkKey))))
                                                           ) @ #vk.215 )
                                                      case c_senc
                                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                             ) @ #vk.168 )
                                                        case AS_Receive_KeyConf
                                                        by contradiction /* cyclic */
                                                      next
                                                        case c_Nonce
                                                        by solve( !KU( ~AS_rnd32DevAddr.1
                                                                  ) @ #vk.221 )
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_ED_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_ED_case_2
                                                  solve( !KU( Nonce(~rnd32DevAddr) ) @ #vk.199 )
                                                    case NetworkSever_Receive_JoinRequest_Forward_To_AS_JS
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.159 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.204 )
                                                    qed
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~rnd32DevAddr ) @ #vk.204 )
                                                  qed
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                         ) @ #vk.139 )
                                                    case AS_Receive_KeyConf
                                                    by contradiction /* cyclic */
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.178 )
                                                  qed
                                                qed
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.116 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.135 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            solve( !KU( Nonce(~rnd32DevAddr.2) ) @ #vk.91 )
                                              case NetworkSever_Receive_JoinRequest_Forward_To_AS_JS
                                              solve( !KU( Nonce(~rnd32DevAddr.3) ) @ #vk.115 )
                                                case NetworkSever_Receive_JoinRequest_Forward_To_AS_JS
                                                solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                                             senc(<
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   NSNonce>,
                                                                                  SessionKey(senc(<
                                                                                                   '0x04', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   NSNonce, 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('Nwk',
                                                                                                         ~rootNwkKey)))), 
                                                                             MAC(<$DevEUI, $NS, 
                                                                                  senc(<
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        NSNonce>,
                                                                                       SessionKey(senc(<
                                                                                                        '0x04', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        NSNonce, 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('Nwk',
                                                                                                              ~rootNwkKey))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x03', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  NSNonce, 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('Nwk',
                                                                                                        ~rootNwkKey))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x04', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             NSNonce, 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('Nwk',
                                                                                                   ~rootNwkKey)))))
                                                       ) @ #vk.105 )
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  solve( !KU( Nonce(~rnd32DevAddr.4) ) @ #vk.155 )
                                                    case NetworkSever_Receive_JoinRequest_Forward_To_AS_JS
                                                    solve( !KU( senc(<
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      NSNonce>,
                                                                     SessionKey(senc(<'0x04', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      NSNonce, 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('Nwk',
                                                                                            ~rootNwkKey))))
                                                           ) @ #vk.161 )
                                                      case c_senc
                                                      solve( !KU( MAC(<$DevEUI, $NS, 
                                                                       senc(<
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             NSNonce>,
                                                                            SessionKey(senc(<
                                                                                             '0x04', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             NSNonce, 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('Nwk',
                                                                                                   ~rootNwkKey))))
                                                                      >,
                                                                      SessionKey(senc(<'0x03', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       NSNonce, 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('Nwk',
                                                                                             ~rootNwkKey))))
                                                             ) @ #vk.162 )
                                                        case c_MAC
                                                        solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x04', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           NSNonce, 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('Nwk',
                                                                                                                 ~rootNwkKey)))), 
                                                                                     MAC(<$DevEUI, 
                                                                                          $NS, 
                                                                                          senc(<
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~rnd32DevAddr.1)
                                                                                               >,
                                                                                               SessionKey(senc(<
                                                                                                                '0x04', 
                                                                                                                Nonce(<
                                                                                                                       $DevEUI, 
                                                                                                                       (
                                                                                                                        '2'+
                                                                                                                        '2'
                                                                                                                       ), 
                                                                                                                       ~rndJoinNonce
                                                                                                                      >), 
                                                                                                                $JS, 
                                                                                                                (
                                                                                                                 '1'+
                                                                                                                 '1'
                                                                                                                ), 
                                                                                                                NSNonce, 
                                                                                                                'pad_with_0s'
                                                                                                               >,
                                                                                                               AesKey('Nwk',
                                                                                                                      ~rootNwkKey))))
                                                                                         >,
                                                                                         SNwkSIntKey)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x04', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     NSNonce, 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('Nwk',
                                                                                                           ~rootNwkKey)))))
                                                               ) @ #vk.123 )
                                                          case Device_Send_KeyConf_NS
                                                          solve( ED_State_01( $DevEUI, $JS, $NS,
                                                                              $AS.1, '1'
                                                                 ) ▶₀ #vr.94 )
                                                            case EndDevice_Commissioned
                                                            solve( !KU( SessionKey(senc(<'0x03', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('Nwk',
                                                                                               ~rootNwkKey)))
                                                                   ) @ #vk.137 )
                                                              case JoinServer_Receive_JoinRequest_Generate_Response
                                                              solve( !KU( Response(senc(<
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         Nonce(~rnd32DevAddr), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         NetID, 
                                                                                         DevAddr, 
                                                                                         'opt_params', 
                                                                                         MAC(<
                                                                                              '0xFF', 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              'MHDR', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              Nonce(~rnd32DevAddr), 
                                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                                              NetID, 
                                                                                              DevAddr, 
                                                                                              'opt_params'
                                                                                             >,
                                                                                             SessionKey(senc(<
                                                                                                              '0x06', 
                                                                                                              $DevEUI, 
                                                                                                              'pad_with_0s'
                                                                                                             >,
                                                                                                             AesKey('Nwk',
                                                                                                                    ~rootNwkKey))))
                                                                                        >,
                                                                                        NwkKey))
                                                                     ) @ #vk.142 )
                                                                case JoinServer_Receive_JoinRequest_Generate_Response
                                                                solve( !KU( MAC(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                       ) @ #vk.104 )
                                                                  case NS_Send_KeyConf_to_AS_case_1
                                                                  by contradiction
                                                                     /* from formulas */
                                                                next
                                                                  case NS_Send_KeyConf_to_AS_case_2
                                                                  solve( !KU( PD_Wrapper(senc(<
                                                                                               $DevEUI.1, 
                                                                                               $NS, 
                                                                                               $AS, 
                                                                                               senc(<
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1)
                                                                                                    >,
                                                                                                    SessionKey(senc(<
                                                                                                                     '0x02', 
                                                                                                                     Nonce(<
                                                                                                                            $DevEUI.1, 
                                                                                                                            (
                                                                                                                             '2'+
                                                                                                                             '2'
                                                                                                                            ), 
                                                                                                                            ~rndJoinNonce.1
                                                                                                                           >), 
                                                                                                                     $JS, 
                                                                                                                     (
                                                                                                                      '1'+
                                                                                                                      '1'
                                                                                                                     ), 
                                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                     'pad_with_0s'
                                                                                                                    >,
                                                                                                                    AesKey('App',
                                                                                                                           ~rootAppKey.1)))), 
                                                                                               MAC(<
                                                                                                    $DevEUI.1, 
                                                                                                    $NS, 
                                                                                                    $AS, 
                                                                                                    senc(<
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                                         >,
                                                                                                         SessionKey(senc(<
                                                                                                                          '0x02', 
                                                                                                                          Nonce(<
                                                                                                                                 $DevEUI.1, 
                                                                                                                                 (
                                                                                                                                  '2'+
                                                                                                                                  '2'
                                                                                                                                 ), 
                                                                                                                                 ~rndJoinNonce.1
                                                                                                                                >), 
                                                                                                                          $JS, 
                                                                                                                          (
                                                                                                                           '1'+
                                                                                                                           '1'
                                                                                                                          ), 
                                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                          'pad_with_0s'
                                                                                                                         >,
                                                                                                                         AesKey('App',
                                                                                                                                ~rootAppKey.1))))
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1)))), 
                                                                                               MAC(<
                                                                                                    $DevEUI.1, 
                                                                                                    $NS, 
                                                                                                    $AS, 
                                                                                                    senc(<
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                                         >,
                                                                                                         SessionKey(senc(<
                                                                                                                          '0x02', 
                                                                                                                          Nonce(<
                                                                                                                                 $DevEUI.1, 
                                                                                                                                 (
                                                                                                                                  '2'+
                                                                                                                                  '2'
                                                                                                                                 ), 
                                                                                                                                 ~rndJoinNonce.1
                                                                                                                                >), 
                                                                                                                          $JS, 
                                                                                                                          (
                                                                                                                           '1'+
                                                                                                                           '1'
                                                                                                                          ), 
                                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                          'pad_with_0s'
                                                                                                                         >,
                                                                                                                         AesKey('App',
                                                                                                                                ~rootAppKey.1)))), 
                                                                                                    MAC(<
                                                                                                         $DevEUI.1, 
                                                                                                         $NS, 
                                                                                                         $AS, 
                                                                                                         senc(<
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                                              >,
                                                                                                              SessionKey(senc(<
                                                                                                                               '0x02', 
                                                                                                                               Nonce(<
                                                                                                                                      $DevEUI.1, 
                                                                                                                                      (
                                                                                                                                       '2'+
                                                                                                                                       '2'
                                                                                                                                      ), 
                                                                                                                                      ~rndJoinNonce.1
                                                                                                                                     >), 
                                                                                                                               $JS, 
                                                                                                                               (
                                                                                                                                '1'+
                                                                                                                                '1'
                                                                                                                               ), 
                                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                               'pad_with_0s'
                                                                                                                              >,
                                                                                                                              AesKey('App',
                                                                                                                                     ~rootAppKey.1))))
                                                                                                        >,
                                                                                                        SessionKey(senc(<
                                                                                                                         '0x02', 
                                                                                                                         Nonce(<
                                                                                                                                $DevEUI.1, 
                                                                                                                                (
                                                                                                                                 '2'+
                                                                                                                                 '2'
                                                                                                                                ), 
                                                                                                                                ~rndJoinNonce.1
                                                                                                                               >), 
                                                                                                                         $JS, 
                                                                                                                         (
                                                                                                                          '1'+
                                                                                                                          '1'
                                                                                                                         ), 
                                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                         'pad_with_0s'
                                                                                                                        >,
                                                                                                                        AesKey('App',
                                                                                                                               ~rootAppKey.1))))
                                                                                                   >,
                                                                                                   FNwkSIntKey.2)
                                                                                              >,
                                                                                              NwkSEncKey.1))
                                                                         ) @ #vk.184 )
                                                                    case Device_Send_KeyConf_AS
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_1
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_2
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_3
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_4
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConf_to_AS_case_1
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case NS_Send_KeyConf_to_AS_case_2
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case c_PD_Wrapper
                                                                    solve( !KU( senc(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1))))
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1)))), 
                                                                                           MAC(<
                                                                                                $DevEUI.1, 
                                                                                                $NS, 
                                                                                                $AS, 
                                                                                                senc(<
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                                     >,
                                                                                                     SessionKey(senc(<
                                                                                                                      '0x02', 
                                                                                                                      Nonce(<
                                                                                                                             $DevEUI.1, 
                                                                                                                             (
                                                                                                                              '2'+
                                                                                                                              '2'
                                                                                                                             ), 
                                                                                                                             ~rndJoinNonce.1
                                                                                                                            >), 
                                                                                                                      $JS, 
                                                                                                                      (
                                                                                                                       '1'+
                                                                                                                       '1'
                                                                                                                      ), 
                                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                      'pad_with_0s'
                                                                                                                     >,
                                                                                                                     AesKey('App',
                                                                                                                            ~rootAppKey.1))))
                                                                                               >,
                                                                                               SessionKey(senc(<
                                                                                                                '0x02', 
                                                                                                                Nonce(<
                                                                                                                       $DevEUI.1, 
                                                                                                                       (
                                                                                                                        '2'+
                                                                                                                        '2'
                                                                                                                       ), 
                                                                                                                       ~rndJoinNonce.1
                                                                                                                      >), 
                                                                                                                $JS, 
                                                                                                                (
                                                                                                                 '1'+
                                                                                                                 '1'
                                                                                                                ), 
                                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                'pad_with_0s'
                                                                                                               >,
                                                                                                               AesKey('App',
                                                                                                                      ~rootAppKey.1))))
                                                                                          >,
                                                                                          FNwkSIntKey.2)
                                                                                     >,
                                                                                     NwkSEncKey.1)
                                                                           ) @ #vk.198 )
                                                                      case c_senc
                                                                      by contradiction /* cyclic */
                                                                    qed
                                                                  qed
                                                                next
                                                                  case c_MAC
                                                                  solve( !KU( senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                         ) @ #vk.170 )
                                                                    case c_senc
                                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                                           ) @ #vk.174 )
                                                                      case AS_Receive_KeyConf
                                                                      by contradiction /* cyclic */
                                                                    next
                                                                      case c_Nonce
                                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                                ) @ #vk.175 )
                                                                    qed
                                                                  qed
                                                                qed
                                                              next
                                                                case c_Response
                                                                solve( !KU( MAC(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                       ) @ #vk.104 )
                                                                  case NS_Send_KeyConf_to_AS_case_1
                                                                  by contradiction
                                                                     /* from formulas */
                                                                next
                                                                  case NS_Send_KeyConf_to_AS_case_2
                                                                  solve( !KU( PD_Wrapper(senc(<
                                                                                               $DevEUI.1, 
                                                                                               $NS, 
                                                                                               $AS, 
                                                                                               senc(<
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1)
                                                                                                    >,
                                                                                                    SessionKey(senc(<
                                                                                                                     '0x02', 
                                                                                                                     Nonce(<
                                                                                                                            $DevEUI.1, 
                                                                                                                            (
                                                                                                                             '2'+
                                                                                                                             '2'
                                                                                                                            ), 
                                                                                                                            ~rndJoinNonce.1
                                                                                                                           >), 
                                                                                                                     $JS, 
                                                                                                                     (
                                                                                                                      '1'+
                                                                                                                      '1'
                                                                                                                     ), 
                                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                     'pad_with_0s'
                                                                                                                    >,
                                                                                                                    AesKey('App',
                                                                                                                           ~rootAppKey.1)))), 
                                                                                               MAC(<
                                                                                                    $DevEUI.1, 
                                                                                                    $NS, 
                                                                                                    $AS, 
                                                                                                    senc(<
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                                         >,
                                                                                                         SessionKey(senc(<
                                                                                                                          '0x02', 
                                                                                                                          Nonce(<
                                                                                                                                 $DevEUI.1, 
                                                                                                                                 (
                                                                                                                                  '2'+
                                                                                                                                  '2'
                                                                                                                                 ), 
                                                                                                                                 ~rndJoinNonce.1
                                                                                                                                >), 
                                                                                                                          $JS, 
                                                                                                                          (
                                                                                                                           '1'+
                                                                                                                           '1'
                                                                                                                          ), 
                                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                          'pad_with_0s'
                                                                                                                         >,
                                                                                                                         AesKey('App',
                                                                                                                                ~rootAppKey.1))))
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1)))), 
                                                                                               MAC(<
                                                                                                    $DevEUI.1, 
                                                                                                    $NS, 
                                                                                                    $AS, 
                                                                                                    senc(<
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                                         >,
                                                                                                         SessionKey(senc(<
                                                                                                                          '0x02', 
                                                                                                                          Nonce(<
                                                                                                                                 $DevEUI.1, 
                                                                                                                                 (
                                                                                                                                  '2'+
                                                                                                                                  '2'
                                                                                                                                 ), 
                                                                                                                                 ~rndJoinNonce.1
                                                                                                                                >), 
                                                                                                                          $JS, 
                                                                                                                          (
                                                                                                                           '1'+
                                                                                                                           '1'
                                                                                                                          ), 
                                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                          'pad_with_0s'
                                                                                                                         >,
                                                                                                                         AesKey('App',
                                                                                                                                ~rootAppKey.1)))), 
                                                                                                    MAC(<
                                                                                                         $DevEUI.1, 
                                                                                                         $NS, 
                                                                                                         $AS, 
                                                                                                         senc(<
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                                              >,
                                                                                                              SessionKey(senc(<
                                                                                                                               '0x02', 
                                                                                                                               Nonce(<
                                                                                                                                      $DevEUI.1, 
                                                                                                                                      (
                                                                                                                                       '2'+
                                                                                                                                       '2'
                                                                                                                                      ), 
                                                                                                                                      ~rndJoinNonce.1
                                                                                                                                     >), 
                                                                                                                               $JS, 
                                                                                                                               (
                                                                                                                                '1'+
                                                                                                                                '1'
                                                                                                                               ), 
                                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                               'pad_with_0s'
                                                                                                                              >,
                                                                                                                              AesKey('App',
                                                                                                                                     ~rootAppKey.1))))
                                                                                                        >,
                                                                                                        SessionKey(senc(<
                                                                                                                         '0x02', 
                                                                                                                         Nonce(<
                                                                                                                                $DevEUI.1, 
                                                                                                                                (
                                                                                                                                 '2'+
                                                                                                                                 '2'
                                                                                                                                ), 
                                                                                                                                ~rndJoinNonce.1
                                                                                                                               >), 
                                                                                                                         $JS, 
                                                                                                                         (
                                                                                                                          '1'+
                                                                                                                          '1'
                                                                                                                         ), 
                                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                         'pad_with_0s'
                                                                                                                        >,
                                                                                                                        AesKey('App',
                                                                                                                               ~rootAppKey.1))))
                                                                                                   >,
                                                                                                   FNwkSIntKey.2)
                                                                                              >,
                                                                                              NwkSEncKey.1))
                                                                         ) @ #vk.185 )
                                                                    case Device_Send_KeyConf_AS
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_1
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_2
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_3
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConfAns_to_ED_case_4
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case NS_Send_KeyConf_to_AS_case_1
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case NS_Send_KeyConf_to_AS_case_2
                                                                    by contradiction
                                                                       /* from formulas */
                                                                  next
                                                                    case c_PD_Wrapper
                                                                    solve( !KU( senc(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1))))
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1)))), 
                                                                                           MAC(<
                                                                                                $DevEUI.1, 
                                                                                                $NS, 
                                                                                                $AS, 
                                                                                                senc(<
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                                     >,
                                                                                                     SessionKey(senc(<
                                                                                                                      '0x02', 
                                                                                                                      Nonce(<
                                                                                                                             $DevEUI.1, 
                                                                                                                             (
                                                                                                                              '2'+
                                                                                                                              '2'
                                                                                                                             ), 
                                                                                                                             ~rndJoinNonce.1
                                                                                                                            >), 
                                                                                                                      $JS, 
                                                                                                                      (
                                                                                                                       '1'+
                                                                                                                       '1'
                                                                                                                      ), 
                                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                      'pad_with_0s'
                                                                                                                     >,
                                                                                                                     AesKey('App',
                                                                                                                            ~rootAppKey.1))))
                                                                                               >,
                                                                                               SessionKey(senc(<
                                                                                                                '0x02', 
                                                                                                                Nonce(<
                                                                                                                       $DevEUI.1, 
                                                                                                                       (
                                                                                                                        '2'+
                                                                                                                        '2'
                                                                                                                       ), 
                                                                                                                       ~rndJoinNonce.1
                                                                                                                      >), 
                                                                                                                $JS, 
                                                                                                                (
                                                                                                                 '1'+
                                                                                                                 '1'
                                                                                                                ), 
                                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                'pad_with_0s'
                                                                                                               >,
                                                                                                               AesKey('App',
                                                                                                                      ~rootAppKey.1))))
                                                                                          >,
                                                                                          FNwkSIntKey.2)
                                                                                     >,
                                                                                     NwkSEncKey.1)
                                                                           ) @ #vk.199 )
                                                                      case c_senc
                                                                      by contradiction /* cyclic */
                                                                    qed
                                                                  qed
                                                                next
                                                                  case c_MAC
                                                                  solve( !KU( senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                         ) @ #vk.171 )
                                                                    case c_senc
                                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                                           ) @ #vk.175 )
                                                                      case AS_Receive_KeyConf
                                                                      by contradiction /* cyclic */
                                                                    next
                                                                      case c_Nonce
                                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                                ) @ #vk.176 )
                                                                    qed
                                                                  qed
                                                                qed
                                                              qed
                                                            next
                                                              case Shared_Key_Reveal2
                                                              by contradiction /* from formulas */
                                                            next
                                                              case c_SessionKey
                                                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                               senc(<('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1))))
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                     ) @ #vk.101 )
                                                                case NS_Send_KeyConf_to_AS_case_1
                                                                by contradiction /* from formulas */
                                                              next
                                                                case NS_Send_KeyConf_to_AS_case_2
                                                                solve( !KU( PD_Wrapper(senc(<
                                                                                             $DevEUI.1, 
                                                                                             $NS, 
                                                                                             $AS, 
                                                                                             senc(<
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                                  >,
                                                                                                  SessionKey(senc(<
                                                                                                                   '0x02', 
                                                                                                                   Nonce(<
                                                                                                                          $DevEUI.1, 
                                                                                                                          (
                                                                                                                           '2'+
                                                                                                                           '2'
                                                                                                                          ), 
                                                                                                                          ~rndJoinNonce.1
                                                                                                                         >), 
                                                                                                                   $JS, 
                                                                                                                   (
                                                                                                                    '1'+
                                                                                                                    '1'
                                                                                                                   ), 
                                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                   'pad_with_0s'
                                                                                                                  >,
                                                                                                                  AesKey('App',
                                                                                                                         ~rootAppKey.1)))), 
                                                                                             MAC(<
                                                                                                  $DevEUI.1, 
                                                                                                  $NS, 
                                                                                                  $AS, 
                                                                                                  senc(<
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                                       >,
                                                                                                       SessionKey(senc(<
                                                                                                                        '0x02', 
                                                                                                                        Nonce(<
                                                                                                                               $DevEUI.1, 
                                                                                                                               (
                                                                                                                                '2'+
                                                                                                                                '2'
                                                                                                                               ), 
                                                                                                                               ~rndJoinNonce.1
                                                                                                                              >), 
                                                                                                                        $JS, 
                                                                                                                        (
                                                                                                                         '1'+
                                                                                                                         '1'
                                                                                                                        ), 
                                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                        'pad_with_0s'
                                                                                                                       >,
                                                                                                                       AesKey('App',
                                                                                                                              ~rootAppKey.1))))
                                                                                                 >,
                                                                                                 SessionKey(senc(<
                                                                                                                  '0x02', 
                                                                                                                  Nonce(<
                                                                                                                         $DevEUI.1, 
                                                                                                                         (
                                                                                                                          '2'+
                                                                                                                          '2'
                                                                                                                         ), 
                                                                                                                         ~rndJoinNonce.1
                                                                                                                        >), 
                                                                                                                  $JS, 
                                                                                                                  (
                                                                                                                   '1'+
                                                                                                                   '1'
                                                                                                                  ), 
                                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                  'pad_with_0s'
                                                                                                                 >,
                                                                                                                 AesKey('App',
                                                                                                                        ~rootAppKey.1)))), 
                                                                                             MAC(<
                                                                                                  $DevEUI.1, 
                                                                                                  $NS, 
                                                                                                  $AS, 
                                                                                                  senc(<
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                                       >,
                                                                                                       SessionKey(senc(<
                                                                                                                        '0x02', 
                                                                                                                        Nonce(<
                                                                                                                               $DevEUI.1, 
                                                                                                                               (
                                                                                                                                '2'+
                                                                                                                                '2'
                                                                                                                               ), 
                                                                                                                               ~rndJoinNonce.1
                                                                                                                              >), 
                                                                                                                        $JS, 
                                                                                                                        (
                                                                                                                         '1'+
                                                                                                                         '1'
                                                                                                                        ), 
                                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                        'pad_with_0s'
                                                                                                                       >,
                                                                                                                       AesKey('App',
                                                                                                                              ~rootAppKey.1)))), 
                                                                                                  MAC(<
                                                                                                       $DevEUI.1, 
                                                                                                       $NS, 
                                                                                                       $AS, 
                                                                                                       senc(<
                                                                                                             (
                                                                                                              '1'+
                                                                                                              '1'
                                                                                                             ), 
                                                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                                                            >,
                                                                                                            SessionKey(senc(<
                                                                                                                             '0x02', 
                                                                                                                             Nonce(<
                                                                                                                                    $DevEUI.1, 
                                                                                                                                    (
                                                                                                                                     '2'+
                                                                                                                                     '2'
                                                                                                                                    ), 
                                                                                                                                    ~rndJoinNonce.1
                                                                                                                                   >), 
                                                                                                                             $JS, 
                                                                                                                             (
                                                                                                                              '1'+
                                                                                                                              '1'
                                                                                                                             ), 
                                                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                             'pad_with_0s'
                                                                                                                            >,
                                                                                                                            AesKey('App',
                                                                                                                                   ~rootAppKey.1))))
                                                                                                      >,
                                                                                                      SessionKey(senc(<
                                                                                                                       '0x02', 
                                                                                                                       Nonce(<
                                                                                                                              $DevEUI.1, 
                                                                                                                              (
                                                                                                                               '2'+
                                                                                                                               '2'
                                                                                                                              ), 
                                                                                                                              ~rndJoinNonce.1
                                                                                                                             >), 
                                                                                                                       $JS, 
                                                                                                                       (
                                                                                                                        '1'+
                                                                                                                        '1'
                                                                                                                       ), 
                                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                       'pad_with_0s'
                                                                                                                      >,
                                                                                                                      AesKey('App',
                                                                                                                             ~rootAppKey.1))))
                                                                                                 >,
                                                                                                 FNwkSIntKey.2)
                                                                                            >,
                                                                                            NwkSEncKey.1))
                                                                       ) @ #vk.186 )
                                                                  case Device_Send_KeyConf_AS
                                                                  by contradiction
                                                                     /* from formulas */
                                                                next
                                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                                  by contradiction /* cyclic */
                                                                next
                                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                                  by contradiction /* cyclic */
                                                                next
                                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                                  by contradiction /* cyclic */
                                                                next
                                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                                  by contradiction /* cyclic */
                                                                next
                                                                  case NS_Send_KeyConf_to_AS_case_1
                                                                  by contradiction
                                                                     /* from formulas */
                                                                next
                                                                  case NS_Send_KeyConf_to_AS_case_2
                                                                  by contradiction
                                                                     /* from formulas */
                                                                next
                                                                  case c_PD_Wrapper
                                                                  solve( !KU( senc(<$DevEUI.1, $NS, 
                                                                                    $AS, 
                                                                                    senc(<
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1)))), 
                                                                                    MAC(<$DevEUI.1, 
                                                                                         $NS, $AS, 
                                                                                         senc(<
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                              >,
                                                                                              SessionKey(senc(<
                                                                                                               '0x02', 
                                                                                                               Nonce(<
                                                                                                                      $DevEUI.1, 
                                                                                                                      (
                                                                                                                       '2'+
                                                                                                                       '2'
                                                                                                                      ), 
                                                                                                                      ~rndJoinNonce.1
                                                                                                                     >), 
                                                                                                               $JS, 
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                               'pad_with_0s'
                                                                                                              >,
                                                                                                              AesKey('App',
                                                                                                                     ~rootAppKey.1))))
                                                                                        >,
                                                                                        SessionKey(senc(<
                                                                                                         '0x02', 
                                                                                                         Nonce(<
                                                                                                                $DevEUI.1, 
                                                                                                                (
                                                                                                                 '2'+
                                                                                                                 '2'
                                                                                                                ), 
                                                                                                                ~rndJoinNonce.1
                                                                                                               >), 
                                                                                                         $JS, 
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                         'pad_with_0s'
                                                                                                        >,
                                                                                                        AesKey('App',
                                                                                                               ~rootAppKey.1)))), 
                                                                                    MAC(<$DevEUI.1, 
                                                                                         $NS, $AS, 
                                                                                         senc(<
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                              >,
                                                                                              SessionKey(senc(<
                                                                                                               '0x02', 
                                                                                                               Nonce(<
                                                                                                                      $DevEUI.1, 
                                                                                                                      (
                                                                                                                       '2'+
                                                                                                                       '2'
                                                                                                                      ), 
                                                                                                                      ~rndJoinNonce.1
                                                                                                                     >), 
                                                                                                               $JS, 
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                               'pad_with_0s'
                                                                                                              >,
                                                                                                              AesKey('App',
                                                                                                                     ~rootAppKey.1)))), 
                                                                                         MAC(<
                                                                                              $DevEUI.1, 
                                                                                              $NS, 
                                                                                              $AS, 
                                                                                              senc(<
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1))))
                                                                                             >,
                                                                                             SessionKey(senc(<
                                                                                                              '0x02', 
                                                                                                              Nonce(<
                                                                                                                     $DevEUI.1, 
                                                                                                                     (
                                                                                                                      '2'+
                                                                                                                      '2'
                                                                                                                     ), 
                                                                                                                     ~rndJoinNonce.1
                                                                                                                    >), 
                                                                                                              $JS, 
                                                                                                              (
                                                                                                               '1'+
                                                                                                               '1'
                                                                                                              ), 
                                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                                              'pad_with_0s'
                                                                                                             >,
                                                                                                             AesKey('App',
                                                                                                                    ~rootAppKey.1))))
                                                                                        >,
                                                                                        FNwkSIntKey.2)
                                                                                   >,
                                                                                   NwkSEncKey.1)
                                                                         ) @ #vk.200 )
                                                                    case c_senc
                                                                    by contradiction /* cyclic */
                                                                  qed
                                                                qed
                                                              next
                                                                case c_MAC
                                                                solve( !KU( senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                       ) @ #vk.172 )
                                                                  case c_senc
                                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                                         ) @ #vk.176 )
                                                                    case AS_Receive_KeyConf
                                                                    by contradiction /* cyclic */
                                                                  next
                                                                    case c_Nonce
                                                                    by solve( !KU( ~AS_rnd32DevAddr.1
                                                                              ) @ #vk.177 )
                                                                  qed
                                                                qed
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case NS_Send_KeyConfAns_to_ED_case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case NS_Send_KeyConfAns_to_ED_case_2
                                                          by contradiction /* from formulas */
                                                        next
                                                          case NS_Send_KeyConfAns_to_ED_case_3
                                                          by contradiction /* from formulas */
                                                        next
                                                          case NS_Send_KeyConfAns_to_ED_case_4
                                                          solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                 ) @ #vk.105 )
                                                            case NS_Send_KeyConf_to_AS_case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case NS_Send_KeyConf_to_AS_case_2
                                                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, 
                                                                                         $NS, $AS, 
                                                                                         senc(<
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                              >,
                                                                                              SessionKey(senc(<
                                                                                                               '0x02', 
                                                                                                               Nonce(<
                                                                                                                      $DevEUI.1, 
                                                                                                                      (
                                                                                                                       '2'+
                                                                                                                       '2'
                                                                                                                      ), 
                                                                                                                      ~rndJoinNonce.1
                                                                                                                     >), 
                                                                                                               $JS, 
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                               'pad_with_0s'
                                                                                                              >,
                                                                                                              AesKey('App',
                                                                                                                     ~rootAppKey.1)))), 
                                                                                         MAC(<
                                                                                              $DevEUI.1, 
                                                                                              $NS, 
                                                                                              $AS, 
                                                                                              senc(<
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1))))
                                                                                             >,
                                                                                             SessionKey(senc(<
                                                                                                              '0x02', 
                                                                                                              Nonce(<
                                                                                                                     $DevEUI.1, 
                                                                                                                     (
                                                                                                                      '2'+
                                                                                                                      '2'
                                                                                                                     ), 
                                                                                                                     ~rndJoinNonce.1
                                                                                                                    >), 
                                                                                                              $JS, 
                                                                                                              (
                                                                                                               '1'+
                                                                                                               '1'
                                                                                                              ), 
                                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                                              'pad_with_0s'
                                                                                                             >,
                                                                                                             AesKey('App',
                                                                                                                    ~rootAppKey.1)))), 
                                                                                         MAC(<
                                                                                              $DevEUI.1, 
                                                                                              $NS, 
                                                                                              $AS, 
                                                                                              senc(<
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1)))), 
                                                                                              MAC(<
                                                                                                   $DevEUI.1, 
                                                                                                   $NS, 
                                                                                                   $AS, 
                                                                                                   senc(<
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1)
                                                                                                        >,
                                                                                                        SessionKey(senc(<
                                                                                                                         '0x02', 
                                                                                                                         Nonce(<
                                                                                                                                $DevEUI.1, 
                                                                                                                                (
                                                                                                                                 '2'+
                                                                                                                                 '2'
                                                                                                                                ), 
                                                                                                                                ~rndJoinNonce.1
                                                                                                                               >), 
                                                                                                                         $JS, 
                                                                                                                         (
                                                                                                                          '1'+
                                                                                                                          '1'
                                                                                                                         ), 
                                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                         'pad_with_0s'
                                                                                                                        >,
                                                                                                                        AesKey('App',
                                                                                                                               ~rootAppKey.1))))
                                                                                                  >,
                                                                                                  SessionKey(senc(<
                                                                                                                   '0x02', 
                                                                                                                   Nonce(<
                                                                                                                          $DevEUI.1, 
                                                                                                                          (
                                                                                                                           '2'+
                                                                                                                           '2'
                                                                                                                          ), 
                                                                                                                          ~rndJoinNonce.1
                                                                                                                         >), 
                                                                                                                   $JS, 
                                                                                                                   (
                                                                                                                    '1'+
                                                                                                                    '1'
                                                                                                                   ), 
                                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                   'pad_with_0s'
                                                                                                                  >,
                                                                                                                  AesKey('App',
                                                                                                                         ~rootAppKey.1))))
                                                                                             >,
                                                                                             FNwkSIntKey.3)
                                                                                        >,
                                                                                        NwkSEncKey.1))
                                                                   ) @ #vk.227 )
                                                              case Device_Send_KeyConf_AS
                                                              by contradiction /* from formulas */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_1
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_2
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_3
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_4
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConf_to_AS_case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case NS_Send_KeyConf_to_AS_case_2
                                                              by contradiction /* from formulas */
                                                            next
                                                              case c_PD_Wrapper
                                                              solve( !KU( senc(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1)))), 
                                                                                     MAC(<
                                                                                          $DevEUI.1, 
                                                                                          $NS, $AS, 
                                                                                          senc(<
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1)
                                                                                               >,
                                                                                               SessionKey(senc(<
                                                                                                                '0x02', 
                                                                                                                Nonce(<
                                                                                                                       $DevEUI.1, 
                                                                                                                       (
                                                                                                                        '2'+
                                                                                                                        '2'
                                                                                                                       ), 
                                                                                                                       ~rndJoinNonce.1
                                                                                                                      >), 
                                                                                                                $JS, 
                                                                                                                (
                                                                                                                 '1'+
                                                                                                                 '1'
                                                                                                                ), 
                                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                'pad_with_0s'
                                                                                                               >,
                                                                                                               AesKey('App',
                                                                                                                      ~rootAppKey.1))))
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1))))
                                                                                    >,
                                                                                    FNwkSIntKey.3)
                                                                               >,
                                                                               NwkSEncKey.1)
                                                                     ) @ #vk.241 )
                                                                case c_senc
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          next
                                                            case c_MAC
                                                            solve( !KU( senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                   ) @ #vk.213 )
                                                              case c_senc
                                                              solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                                     ) @ #vk.217 )
                                                                case AS_Receive_KeyConf
                                                                by contradiction /* cyclic */
                                                              next
                                                                case c_Nonce
                                                                by solve( !KU( ~AS_rnd32DevAddr.1
                                                                          ) @ #vk.218 )
                                                              qed
                                                            qed
                                                          qed
                                                        next
                                                          case NS_Send_KeyConf_to_AS_case_1
                                                          by contradiction /* from formulas */
                                                        next
                                                          case NS_Send_KeyConf_to_AS_case_2
                                                          by contradiction /* from formulas */
                                                        next
                                                          case c_PD_Wrapper
                                                          solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                 ) @ #vk.97 )
                                                            case NS_Send_KeyConf_to_AS_case_1
                                                            by contradiction /* from formulas */
                                                          next
                                                            case NS_Send_KeyConf_to_AS_case_2
                                                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, 
                                                                                         $NS, $AS, 
                                                                                         senc(<
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                              >,
                                                                                              SessionKey(senc(<
                                                                                                               '0x02', 
                                                                                                               Nonce(<
                                                                                                                      $DevEUI.1, 
                                                                                                                      (
                                                                                                                       '2'+
                                                                                                                       '2'
                                                                                                                      ), 
                                                                                                                      ~rndJoinNonce.1
                                                                                                                     >), 
                                                                                                               $JS, 
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                               'pad_with_0s'
                                                                                                              >,
                                                                                                              AesKey('App',
                                                                                                                     ~rootAppKey.1)))), 
                                                                                         MAC(<
                                                                                              $DevEUI.1, 
                                                                                              $NS, 
                                                                                              $AS, 
                                                                                              senc(<
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1))))
                                                                                             >,
                                                                                             SessionKey(senc(<
                                                                                                              '0x02', 
                                                                                                              Nonce(<
                                                                                                                     $DevEUI.1, 
                                                                                                                     (
                                                                                                                      '2'+
                                                                                                                      '2'
                                                                                                                     ), 
                                                                                                                     ~rndJoinNonce.1
                                                                                                                    >), 
                                                                                                              $JS, 
                                                                                                              (
                                                                                                               '1'+
                                                                                                               '1'
                                                                                                              ), 
                                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                                              'pad_with_0s'
                                                                                                             >,
                                                                                                             AesKey('App',
                                                                                                                    ~rootAppKey.1)))), 
                                                                                         MAC(<
                                                                                              $DevEUI.1, 
                                                                                              $NS, 
                                                                                              $AS, 
                                                                                              senc(<
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                                   >,
                                                                                                   SessionKey(senc(<
                                                                                                                    '0x02', 
                                                                                                                    Nonce(<
                                                                                                                           $DevEUI.1, 
                                                                                                                           (
                                                                                                                            '2'+
                                                                                                                            '2'
                                                                                                                           ), 
                                                                                                                           ~rndJoinNonce.1
                                                                                                                          >), 
                                                                                                                    $JS, 
                                                                                                                    (
                                                                                                                     '1'+
                                                                                                                     '1'
                                                                                                                    ), 
                                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                    'pad_with_0s'
                                                                                                                   >,
                                                                                                                   AesKey('App',
                                                                                                                          ~rootAppKey.1)))), 
                                                                                              MAC(<
                                                                                                   $DevEUI.1, 
                                                                                                   $NS, 
                                                                                                   $AS, 
                                                                                                   senc(<
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1)
                                                                                                        >,
                                                                                                        SessionKey(senc(<
                                                                                                                         '0x02', 
                                                                                                                         Nonce(<
                                                                                                                                $DevEUI.1, 
                                                                                                                                (
                                                                                                                                 '2'+
                                                                                                                                 '2'
                                                                                                                                ), 
                                                                                                                                ~rndJoinNonce.1
                                                                                                                               >), 
                                                                                                                         $JS, 
                                                                                                                         (
                                                                                                                          '1'+
                                                                                                                          '1'
                                                                                                                         ), 
                                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                         'pad_with_0s'
                                                                                                                        >,
                                                                                                                        AesKey('App',
                                                                                                                               ~rootAppKey.1))))
                                                                                                  >,
                                                                                                  SessionKey(senc(<
                                                                                                                   '0x02', 
                                                                                                                   Nonce(<
                                                                                                                          $DevEUI.1, 
                                                                                                                          (
                                                                                                                           '2'+
                                                                                                                           '2'
                                                                                                                          ), 
                                                                                                                          ~rndJoinNonce.1
                                                                                                                         >), 
                                                                                                                   $JS, 
                                                                                                                   (
                                                                                                                    '1'+
                                                                                                                    '1'
                                                                                                                   ), 
                                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                   'pad_with_0s'
                                                                                                                  >,
                                                                                                                  AesKey('App',
                                                                                                                         ~rootAppKey.1))))
                                                                                             >,
                                                                                             FNwkSIntKey.2)
                                                                                        >,
                                                                                        NwkSEncKey.1))
                                                                   ) @ #vk.188 )
                                                              case Device_Send_KeyConf_AS
                                                              by contradiction /* from formulas */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_1
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_2
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_3
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConfAns_to_ED_case_4
                                                              by contradiction /* cyclic */
                                                            next
                                                              case NS_Send_KeyConf_to_AS_case_1
                                                              by contradiction /* from formulas */
                                                            next
                                                              case NS_Send_KeyConf_to_AS_case_2
                                                              by contradiction /* from formulas */
                                                            next
                                                              case c_PD_Wrapper
                                                              solve( !KU( senc(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1)))), 
                                                                                     MAC(<
                                                                                          $DevEUI.1, 
                                                                                          $NS, $AS, 
                                                                                          senc(<
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1)
                                                                                               >,
                                                                                               SessionKey(senc(<
                                                                                                                '0x02', 
                                                                                                                Nonce(<
                                                                                                                       $DevEUI.1, 
                                                                                                                       (
                                                                                                                        '2'+
                                                                                                                        '2'
                                                                                                                       ), 
                                                                                                                       ~rndJoinNonce.1
                                                                                                                      >), 
                                                                                                                $JS, 
                                                                                                                (
                                                                                                                 '1'+
                                                                                                                 '1'
                                                                                                                ), 
                                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                'pad_with_0s'
                                                                                                               >,
                                                                                                               AesKey('App',
                                                                                                                      ~rootAppKey.1))))
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1))))
                                                                                    >,
                                                                                    FNwkSIntKey.2)
                                                                               >,
                                                                               NwkSEncKey.1)
                                                                     ) @ #vk.202 )
                                                                case c_senc
                                                                by contradiction /* cyclic */
                                                              qed
                                                            qed
                                                          next
                                                            case c_MAC
                                                            solve( !KU( senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                   ) @ #vk.174 )
                                                              case c_senc
                                                              solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                                     ) @ #vk.178 )
                                                                case AS_Receive_KeyConf
                                                                by contradiction /* cyclic */
                                                              next
                                                                case c_Nonce
                                                                by solve( !KU( ~AS_rnd32DevAddr.1
                                                                          ) @ #vk.179 )
                                                              qed
                                                            qed
                                                          qed
                                                        qed
                                                      qed
                                                    qed
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~rnd32DevAddr.4 ) @ #vk.163 )
                                                  qed
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_ED_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_ED_case_2
                                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                         ) @ #vk.73 )
                                                    case NS_Send_KeyConf_to_AS_case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_2
                                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1)))), 
                                                                                 MAC(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1))))
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                 MAC(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1))))
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                     >,
                                                                                     FNwkSIntKey.2)
                                                                                >,
                                                                                NwkSEncKey.1))
                                                           ) @ #vk.167 )
                                                      case Device_Send_KeyConf_AS
                                                      by contradiction /* from formulas */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_1
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_2
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_3
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_4
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConf_to_AS_case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case NS_Send_KeyConf_to_AS_case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case c_PD_Wrapper
                                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                            >,
                                                                            FNwkSIntKey.2)
                                                                       >,
                                                                       NwkSEncKey.1)
                                                             ) @ #vk.181 )
                                                        case c_senc
                                                        by contradiction /* cyclic */
                                                      qed
                                                    qed
                                                  next
                                                    case c_MAC
                                                    solve( !KU( senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1))))
                                                           ) @ #vk.153 )
                                                      case c_senc
                                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                             ) @ #vk.157 )
                                                        case AS_Receive_KeyConf
                                                        by contradiction /* cyclic */
                                                      next
                                                        case c_Nonce
                                                        by solve( !KU( ~AS_rnd32DevAddr.1
                                                                  ) @ #vk.158 )
                                                      qed
                                                    qed
                                                  qed
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                         ) @ #vk.69 )
                                                    case NS_Send_KeyConf_to_AS_case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_2
                                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1)))), 
                                                                                 MAC(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1))))
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                 MAC(<$DevEUI.1, 
                                                                                      $NS, $AS, 
                                                                                      senc(<
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                                           >,
                                                                                           SessionKey(senc(<
                                                                                                            '0x02', 
                                                                                                            Nonce(<
                                                                                                                   $DevEUI.1, 
                                                                                                                   (
                                                                                                                    '2'+
                                                                                                                    '2'
                                                                                                                   ), 
                                                                                                                   ~rndJoinNonce.1
                                                                                                                  >), 
                                                                                                            $JS, 
                                                                                                            (
                                                                                                             '1'+
                                                                                                             '1'
                                                                                                            ), 
                                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                                            'pad_with_0s'
                                                                                                           >,
                                                                                                           AesKey('App',
                                                                                                                  ~rootAppKey.1)))), 
                                                                                      MAC(<
                                                                                           $DevEUI.1, 
                                                                                           $NS, 
                                                                                           $AS, 
                                                                                           senc(<
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                                >,
                                                                                                SessionKey(senc(<
                                                                                                                 '0x02', 
                                                                                                                 Nonce(<
                                                                                                                        $DevEUI.1, 
                                                                                                                        (
                                                                                                                         '2'+
                                                                                                                         '2'
                                                                                                                        ), 
                                                                                                                        ~rndJoinNonce.1
                                                                                                                       >), 
                                                                                                                 $JS, 
                                                                                                                 (
                                                                                                                  '1'+
                                                                                                                  '1'
                                                                                                                 ), 
                                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                                 'pad_with_0s'
                                                                                                                >,
                                                                                                                AesKey('App',
                                                                                                                       ~rootAppKey.1))))
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                     >,
                                                                                     FNwkSIntKey.1)
                                                                                >,
                                                                                NwkSEncKey.1))
                                                           ) @ #vk.141 )
                                                      case Device_Send_KeyConf_AS
                                                      by contradiction /* from formulas */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_1
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_2
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_3
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConfAns_to_ED_case_4
                                                      by contradiction /* cyclic */
                                                    next
                                                      case NS_Send_KeyConf_to_AS_case_1
                                                      by contradiction /* from formulas */
                                                    next
                                                      case NS_Send_KeyConf_to_AS_case_2
                                                      by contradiction /* from formulas */
                                                    next
                                                      case c_PD_Wrapper
                                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                            >,
                                                                            FNwkSIntKey.1)
                                                                       >,
                                                                       NwkSEncKey.1)
                                                             ) @ #vk.155 )
                                                        case c_senc
                                                        by contradiction /* cyclic */
                                                      qed
                                                    qed
                                                  next
                                                    case c_MAC
                                                    solve( !KU( senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1))))
                                                           ) @ #vk.127 )
                                                      case c_senc
                                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                             ) @ #vk.131 )
                                                        case AS_Receive_KeyConf
                                                        by contradiction /* cyclic */
                                                      next
                                                        case c_Nonce
                                                        by solve( !KU( ~AS_rnd32DevAddr.1
                                                                  ) @ #vk.132 )
                                                      qed
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case c_Nonce
                                                by solve( !KU( ~rnd32DevAddr.3 ) @ #vk.122 )
                                              qed
                                            next
                                              case c_Nonce
                                              by solve( !KU( ~rnd32DevAddr.2 ) @ #vk.122 )
                                            qed
                                          next
                                            case c_PD_Wrapper
                                            solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1))))
                                                   ) @ #vk.51 )
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1))))
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1))))
                                                                               >,
                                                                               FNwkSIntKey)
                                                                          >,
                                                                          NwkSEncKey))
                                                     ) @ #vk.108 )
                                                case Device_Send_KeyConf_AS
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                      >,
                                                                      FNwkSIntKey)
                                                                 >,
                                                                 NwkSEncKey)
                                                       ) @ #vk.122 )
                                                  case c_senc
                                                  by contradiction /* cyclic */
                                                qed
                                              qed
                                            next
                                              case c_MAC
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                     ) @ #vk.92 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey))))
                                                      >,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI, ('2'+'2'), 
                                                                              ~rndJoinNonce>), 
                                                                       $JS, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App', ~rootAppKey))))
                                             ) @ #vk.46 )
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr)>,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey)))), 
                                                                     MAC(<$DevEUI, $NS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey))))
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey)))), 
                                                                     MAC(<$DevEUI, $NS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey)))), 
                                                                          MAC(<$DevEUI, $NS, $AS, 
                                                                               senc(<('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey))))
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey))))
                                                                         >,
                                                                         FNwkSIntKey.2)
                                                                    >,
                                                                    NwkSEncKey.1))
                                               ) @ #vk.144 )
                                          case Device_Send_KeyConf_AS
                                          solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1'
                                                 ) ▶₀ #vr.78 )
                                            case EndDevice_Commissioned
                                            solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.77 )
                                              case EndDevice_Commissioned
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                     ) @ #vk.146 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.170 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.171 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_1
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_2
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_3
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_4
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_1
                                          by contradiction /* from formulas */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_2
                                          by contradiction /* from formulas */
                                        next
                                          case c_PD_Wrapper
                                          solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                            senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey)))), 
                                                            MAC(<$DevEUI, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey))))
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey)))), 
                                                            MAC(<$DevEUI, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey)))), 
                                                                 MAC(<$DevEUI, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey))))
                                                                >,
                                                                FNwkSIntKey.2)
                                                           >,
                                                           NwkSEncKey.1)
                                                 ) @ #vk.158 )
                                            case c_senc
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      next
                                        case c_MAC
                                        solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                               ) @ #vk.125 )
                                          case c_senc
                                          solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.133 )
                                            case AS_Receive_KeyConf
                                            by contradiction /* cyclic */
                                          next
                                            case c_Nonce
                                            by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.134 )
                                          qed
                                        qed
                                      qed
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey))))
                                                      >,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI, ('2'+'2'), 
                                                                              ~rndJoinNonce>), 
                                                                       $JS, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App', ~rootAppKey))))
                                             ) @ #vk.37 )
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr)>,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey)))), 
                                                                     MAC(<$DevEUI, $NS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey))))
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey)))), 
                                                                     MAC(<$DevEUI, $NS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey)))), 
                                                                          MAC(<$DevEUI, $NS, $AS, 
                                                                               senc(<('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey))))
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey))))
                                                                         >,
                                                                         FNwkSIntKey.1)
                                                                    >,
                                                                    NwkSEncKey.1))
                                               ) @ #vk.101 )
                                          case Device_Send_KeyConf_AS
                                          solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1'
                                                 ) ▶₀ #vr.68 )
                                            case EndDevice_Commissioned
                                            solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.67 )
                                              case EndDevice_Commissioned
                                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                     ) @ #vk.65 )
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1)))), 
                                                                                  MAC(<$DevEUI.1, 
                                                                                       $NS, $AS, 
                                                                                       senc(<
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                                            >,
                                                                                            SessionKey(senc(<
                                                                                                             '0x02', 
                                                                                                             Nonce(<
                                                                                                                    $DevEUI.1, 
                                                                                                                    (
                                                                                                                     '2'+
                                                                                                                     '2'
                                                                                                                    ), 
                                                                                                                    ~rndJoinNonce.1
                                                                                                                   >), 
                                                                                                             $JS, 
                                                                                                             (
                                                                                                              '1'+
                                                                                                              '1'
                                                                                                             ), 
                                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                                             'pad_with_0s'
                                                                                                            >,
                                                                                                            AesKey('App',
                                                                                                                   ~rootAppKey.1))))
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                 >,
                                                                                 FNwkSIntKey.1)
                                                                            >,
                                                                            NwkSEncKey.1))
                                                       ) @ #vk.141 )
                                                  case Device_Send_KeyConf_AS
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                        >,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                        >,
                                                                        FNwkSIntKey.1)
                                                                   >,
                                                                   NwkSEncKey.1)
                                                         ) @ #vk.155 )
                                                    case c_senc
                                                    by contradiction /* cyclic */
                                                  qed
                                                qed
                                              next
                                                case c_MAC
                                                solve( !KU( PD_Wrapper(senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))))
                                                       ) @ #vk.67 )
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                         ) @ #vk.150 )
                                                    case AS_Receive_KeyConf
                                                    by contradiction /* cyclic */
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.168 )
                                                  qed
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  solve( !KU( senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                         ) @ #vk.140 )
                                                    case c_senc
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.164 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.165 )
                                                    qed
                                                  qed
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                         ) @ #vk.127 )
                                                    case c_senc
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.131 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.132 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_1
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_2
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_3
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConfAns_to_ED_case_4
                                          by contradiction /* cyclic */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_1
                                          by contradiction /* from formulas */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_2
                                          by contradiction /* from formulas */
                                        next
                                          case c_PD_Wrapper
                                          solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                            senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey)))), 
                                                            MAC(<$DevEUI, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey))))
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey)))), 
                                                            MAC(<$DevEUI, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey)))), 
                                                                 MAC(<$DevEUI, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey))))
                                                                >,
                                                                FNwkSIntKey.1)
                                                           >,
                                                           NwkSEncKey.1)
                                                 ) @ #vk.115 )
                                            case c_senc
                                            by contradiction /* cyclic */
                                          qed
                                        qed
                                      next
                                        case c_MAC
                                        solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                               ) @ #vk.87 )
                                          case c_senc
                                          solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.91 )
                                            case AS_Receive_KeyConf
                                            by contradiction /* cyclic */
                                          next
                                            case c_Nonce
                                            by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.92 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case c_PD_Wrapper
                                    solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey))))
                                           ) @ #vk.24 )
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey)))), 
                                                                   MAC(<$DevEUI, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey)))), 
                                                                   MAC(<$DevEUI, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey)))), 
                                                                        MAC(<$DevEUI, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey))))
                                                                       >,
                                                                       FNwkSIntKey)
                                                                  >,
                                                                  NwkSEncKey))
                                             ) @ #vk.63 )
                                        case Device_Send_KeyConf_AS
                                        solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1'
                                               ) ▶₀ #vr.59 )
                                          case EndDevice_Commissioned
                                          solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.58 )
                                            case EndDevice_Commissioned
                                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey))))
                                                   ) @ #vk.68 )
                                              case c_senc
                                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.94 )
                                                case AS_Receive_KeyConf
                                                by contradiction /* cyclic */
                                              next
                                                case c_Nonce
                                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.95 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey)))), 
                                                          MAC(<$DevEUI, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                          MAC(<$DevEUI, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey)))), 
                                                               MAC(<$DevEUI, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr)>,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                              >,
                                                              FNwkSIntKey)
                                                         >,
                                                         NwkSEncKey)
                                               ) @ #vk.82 )
                                          case c_senc
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    next
                                      case c_MAC
                                      solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI, ('2'+'2'), 
                                                                               ~rndJoinNonce>), 
                                                                        $JS, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App', ~rootAppKey))))
                                             ) @ #vk.48 )
                                        case c_senc
                                        solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( AesKey('Nwk', ~rootNwkKey.2) ) @ #vk.48 )
                                  case Shared_Key_Reveal1_case_1
                                  by contradiction /* from formulas */
                                next
                                  case Shared_Key_Reveal1_case_2
                                  solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI, ('2'+'2'), 
                                                                          ~rndJoinNonce>), 
                                                                   $JS, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey))))
                                         ) @ #vk.22 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey)))), 
                                                                 MAC(<$DevEUI, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey)))), 
                                                                 MAC(<$DevEUI, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey)))), 
                                                                      MAC(<$DevEUI, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.69 )
                                      case Device_Send_KeyConf_AS
                                      solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.54 )
                                        case EndDevice_Commissioned
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.53 )
                                          case EndDevice_Commissioned
                                          solve( !KU( PD_Wrapper(senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))))
                                                 ) @ #vk.50 )
                                            case NS_Send_KeyConfAns_to_ED_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_2
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_3
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_4
                                            solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.116 )
                                              case AS_Receive_KeyConf
                                              by contradiction /* cyclic */
                                            next
                                              case c_Nonce
                                              by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.135 )
                                            qed
                                          next
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1))))
                                                   ) @ #vk.57 )
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1))))
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1))))
                                                                               >,
                                                                               FNwkSIntKey.1)
                                                                          >,
                                                                          NwkSEncKey.1))
                                                     ) @ #vk.147 )
                                                case Device_Send_KeyConf_AS
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                      >,
                                                                      FNwkSIntKey.1)
                                                                 >,
                                                                 NwkSEncKey.1)
                                                       ) @ #vk.161 )
                                                  case c_senc
                                                  by contradiction /* cyclic */
                                                qed
                                              qed
                                            next
                                              case c_MAC
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                     ) @ #vk.133 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.135 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.136 )
                                                qed
                                              qed
                                            qed
                                          next
                                            case c_PD_Wrapper
                                            solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                                         senc(<
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               NSNonce>,
                                                                              SessionKey(senc(<
                                                                                               '0x04', 
                                                                                               Nonce(<
                                                                                                      $DevEUI, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               NSNonce, 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('Nwk',
                                                                                                     ~rootNwkKey)))), 
                                                                         MAC(<$DevEUI, $NS, 
                                                                              senc(<
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    NSNonce>,
                                                                                   SessionKey(senc(<
                                                                                                    '0x04', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    NSNonce, 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('Nwk',
                                                                                                          ~rootNwkKey))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x03', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              NSNonce, 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('Nwk',
                                                                                                    ~rootNwkKey))))
                                                                        >,
                                                                        SessionKey(senc(<'0x04', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         NSNonce, 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('Nwk',
                                                                                               ~rootNwkKey)))))
                                                   ) @ #vk.93 )
                                              case NS_Send_KeyConfAns_to_ED_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_3
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_4
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                     ) @ #vk.114 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.140 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.141 )
                                                qed
                                              qed
                                            next
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_ED_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_ED_case_2
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                     ) @ #vk.112 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.126 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.127 )
                                                qed
                                              qed
                                            next
                                              case c_PD_Wrapper
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~rnd32DevAddr.2)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x04', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 NSNonce, 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('Nwk',
                                                                                                       ~rootNwkKey)))), 
                                                                           MAC(<$DevEUI, $NS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~rnd32DevAddr.2)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x04', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      NSNonce, 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('Nwk',
                                                                                                            ~rootNwkKey))))
                                                                               >,
                                                                               SNwkSIntKey)
                                                                          >,
                                                                          SessionKey(senc(<'0x04', 
                                                                                           Nonce(<
                                                                                                  $DevEUI, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           NSNonce, 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('Nwk',
                                                                                                 ~rootNwkKey)))))
                                                     ) @ #vk.78 )
                                                case Device_Send_KeyConf_NS
                                                solve( ED_State_01( $DevEUI, $JS, $NS, $AS.1, '1'
                                                       ) ▶₀ #vr.59 )
                                                  case EndDevice_Commissioned
                                                  solve( !KU( senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                         ) @ #vk.96 )
                                                    case c_senc
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.100 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.101 )
                                                    qed
                                                  qed
                                                qed
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                solve( !KU( senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                       ) @ #vk.114 )
                                                  case c_senc
                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                         ) @ #vk.141 )
                                                    case AS_Receive_KeyConf
                                                    by contradiction /* cyclic */
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.142 )
                                                  qed
                                                qed
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( senc(<$NS, $DevEUI, 
                                                                  senc(<
                                                                        Nonce(<$DevEUI, ('2'+'2'), 
                                                                               ~rndJoinNonce>), 
                                                                        NSNonce>,
                                                                       SessionKey(senc(<'0x04', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        NSNonce, 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('Nwk',
                                                                                              ~rootNwkKey)))), 
                                                                  MAC(<$DevEUI, $NS, 
                                                                       senc(<
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             NSNonce>,
                                                                            SessionKey(senc(<
                                                                                             '0x04', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             NSNonce, 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('Nwk',
                                                                                                   ~rootNwkKey))))
                                                                      >,
                                                                      SessionKey(senc(<'0x03', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       NSNonce, 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('Nwk',
                                                                                             ~rootNwkKey))))
                                                                 >,
                                                                 SessionKey(senc(<'0x04', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  NSNonce, 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('Nwk',
                                                                                        ~rootNwkKey))))
                                                       ) @ #vk.97 )
                                                  case c_senc
                                                  solve( !KU( senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                         ) @ #vk.99 )
                                                    case c_senc
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.106 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.107 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                        MAC(<$DevEUI, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey)))), 
                                                        MAC(<$DevEUI, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey)))), 
                                                             MAC(<$DevEUI, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.88 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey))))
                                           ) @ #vk.56 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.58 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.59 )
                                      qed
                                    qed
                                  qed
                                next
                                  case c_AesKey
                                  by solve( !KU( ~rootNwkKey.1 ) @ #vk.53 )
                                qed
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( AesKey('Nwk', ~rootNwkKey) ) @ #vk.48 )
                              case Shared_Key_Reveal1_case_1
                              by contradiction /* from formulas */
                            next
                              case Shared_Key_Reveal1_case_2
                              solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI, ('2'+'2'), 
                                                                      ~rndJoinNonce>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey))))
                                     ) @ #vk.18 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey)))), 
                                                             MAC(<$DevEUI, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey)))), 
                                                             MAC(<$DevEUI, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey)))), 
                                                                  MAC(<$DevEUI, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.69 )
                                  case Device_Send_KeyConf_AS
                                  solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.47 )
                                    case EndDevice_Commissioned
                                    solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.46 )
                                      case EndDevice_Commissioned
                                      solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                                   senc(<
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         NSNonce>,
                                                                        SessionKey(senc(<'0x04', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         NSNonce, 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('Nwk',
                                                                                               ~rootNwkKey)))), 
                                                                   MAC(<$DevEUI, $NS, 
                                                                        senc(<
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              NSNonce>,
                                                                             SessionKey(senc(<
                                                                                              '0x04', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              NSNonce, 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('Nwk',
                                                                                                    ~rootNwkKey))))
                                                                       >,
                                                                       SessionKey(senc(<'0x03', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        NSNonce, 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('Nwk',
                                                                                              ~rootNwkKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x04', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   NSNonce, 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('Nwk',
                                                                                         ~rootNwkKey)))))
                                             ) @ #vk.93 )
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        solve( !KU( senc(<
                                                          Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                >), 
                                                          NSNonce>,
                                                         SessionKey(senc(<'0x04', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), NSNonce, 
                                                                          'pad_with_0s'>,
                                                                         AesKey('Nwk',
                                                                                ~rootNwkKey))))
                                               ) @ #vk.135 )
                                          case c_senc
                                          solve( !KU( MAC(<$DevEUI, $NS, 
                                                           senc(<
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 NSNonce>,
                                                                SessionKey(senc(<'0x04', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 NSNonce, 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('Nwk',
                                                                                       ~rootNwkKey))))
                                                          >,
                                                          SessionKey(senc(<'0x03', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), NSNonce, 
                                                                           'pad_with_0s'>,
                                                                          AesKey('Nwk',
                                                                                 ~rootNwkKey))))
                                                 ) @ #vk.136 )
                                            case c_MAC
                                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~rnd32DevAddr.2)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x04', 
                                                                                               Nonce(<
                                                                                                      $DevEUI, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               NSNonce, 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('Nwk',
                                                                                                     ~rootNwkKey)))), 
                                                                         MAC(<$DevEUI, $NS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~rnd32DevAddr.2)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x04', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    NSNonce, 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('Nwk',
                                                                                                          ~rootNwkKey))))
                                                                             >,
                                                                             SNwkSIntKey)
                                                                        >,
                                                                        SessionKey(senc(<'0x04', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         NSNonce, 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('Nwk',
                                                                                               ~rootNwkKey)))))
                                                   ) @ #vk.104 )
                                              case Device_Send_KeyConf_NS
                                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS.1, '1'
                                                     ) ▶₀ #vr.64 )
                                                case EndDevice_Commissioned
                                                solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                       ) @ #vk.71 )
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                               senc(<('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1)
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1)))), 
                                                                               MAC(<$DevEUI.1, $NS, 
                                                                                    $AS, 
                                                                                    senc(<
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1))))
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1)))), 
                                                                               MAC(<$DevEUI.1, $NS, 
                                                                                    $AS, 
                                                                                    senc(<
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                                         >,
                                                                                         SessionKey(senc(<
                                                                                                          '0x02', 
                                                                                                          Nonce(<
                                                                                                                 $DevEUI.1, 
                                                                                                                 (
                                                                                                                  '2'+
                                                                                                                  '2'
                                                                                                                 ), 
                                                                                                                 ~rndJoinNonce.1
                                                                                                                >), 
                                                                                                          $JS, 
                                                                                                          (
                                                                                                           '1'+
                                                                                                           '1'
                                                                                                          ), 
                                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                                          'pad_with_0s'
                                                                                                         >,
                                                                                                         AesKey('App',
                                                                                                                ~rootAppKey.1)))), 
                                                                                    MAC(<$DevEUI.1, 
                                                                                         $NS, $AS, 
                                                                                         senc(<
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                                              >,
                                                                                              SessionKey(senc(<
                                                                                                               '0x02', 
                                                                                                               Nonce(<
                                                                                                                      $DevEUI.1, 
                                                                                                                      (
                                                                                                                       '2'+
                                                                                                                       '2'
                                                                                                                      ), 
                                                                                                                      ~rndJoinNonce.1
                                                                                                                     >), 
                                                                                                               $JS, 
                                                                                                               (
                                                                                                                '1'+
                                                                                                                '1'
                                                                                                               ), 
                                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                                               'pad_with_0s'
                                                                                                              >,
                                                                                                              AesKey('App',
                                                                                                                     ~rootAppKey.1))))
                                                                                        >,
                                                                                        SessionKey(senc(<
                                                                                                         '0x02', 
                                                                                                         Nonce(<
                                                                                                                $DevEUI.1, 
                                                                                                                (
                                                                                                                 '2'+
                                                                                                                 '2'
                                                                                                                ), 
                                                                                                                ~rndJoinNonce.1
                                                                                                               >), 
                                                                                                         $JS, 
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                         'pad_with_0s'
                                                                                                        >,
                                                                                                        AesKey('App',
                                                                                                               ~rootAppKey.1))))
                                                                                   >,
                                                                                   FNwkSIntKey.1)
                                                                              >,
                                                                              NwkSEncKey))
                                                         ) @ #vk.159 )
                                                    case Device_Send_KeyConf_AS
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_1
                                                    by contradiction /* cyclic */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_2
                                                    by contradiction /* cyclic */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_3
                                                    by contradiction /* cyclic */
                                                  next
                                                    case NS_Send_KeyConfAns_to_ED_case_4
                                                    by contradiction /* cyclic */
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_1
                                                    by contradiction /* from formulas */
                                                  next
                                                    case NS_Send_KeyConf_to_AS_case_2
                                                    by contradiction /* from formulas */
                                                  next
                                                    case c_PD_Wrapper
                                                    solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1))))
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1))))
                                                                          >,
                                                                          FNwkSIntKey.1)
                                                                     >,
                                                                     NwkSEncKey)
                                                           ) @ #vk.173 )
                                                      case c_senc
                                                      by contradiction /* cyclic */
                                                    qed
                                                  qed
                                                next
                                                  case c_MAC
                                                  solve( !KU( senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                         ) @ #vk.145 )
                                                    case c_senc
                                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                           ) @ #vk.147 )
                                                      case AS_Receive_KeyConf
                                                      by contradiction /* cyclic */
                                                    next
                                                      case c_Nonce
                                                      by solve( !KU( ~AS_rnd32DevAddr.1
                                                                ) @ #vk.148 )
                                                    qed
                                                  qed
                                                qed
                                              qed
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_3
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_4
                                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                     ) @ #vk.77 )
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1)))), 
                                                                                  MAC(<$DevEUI.1, 
                                                                                       $NS, $AS, 
                                                                                       senc(<
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                                            >,
                                                                                            SessionKey(senc(<
                                                                                                             '0x02', 
                                                                                                             Nonce(<
                                                                                                                    $DevEUI.1, 
                                                                                                                    (
                                                                                                                     '2'+
                                                                                                                     '2'
                                                                                                                    ), 
                                                                                                                    ~rndJoinNonce.1
                                                                                                                   >), 
                                                                                                             $JS, 
                                                                                                             (
                                                                                                              '1'+
                                                                                                              '1'
                                                                                                             ), 
                                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                                             'pad_with_0s'
                                                                                                            >,
                                                                                                            AesKey('App',
                                                                                                                   ~rootAppKey.1))))
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                 >,
                                                                                 FNwkSIntKey.2)
                                                                            >,
                                                                            NwkSEncKey))
                                                       ) @ #vk.201 )
                                                  case Device_Send_KeyConf_AS
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                        >,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                        >,
                                                                        FNwkSIntKey.2)
                                                                   >,
                                                                   NwkSEncKey)
                                                         ) @ #vk.215 )
                                                    case c_senc
                                                    by contradiction /* cyclic */
                                                  qed
                                                qed
                                              next
                                                case c_MAC
                                                solve( !KU( senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                       ) @ #vk.187 )
                                                  case c_senc
                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                         ) @ #vk.189 )
                                                    case AS_Receive_KeyConf
                                                    by contradiction /* cyclic */
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.190 )
                                                  qed
                                                qed
                                              qed
                                            next
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case c_PD_Wrapper
                                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                     ) @ #vk.69 )
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1))))
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1)))), 
                                                                             MAC(<$DevEUI.1, $NS, 
                                                                                  $AS, 
                                                                                  senc(<('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1)
                                                                                       >,
                                                                                       SessionKey(senc(<
                                                                                                        '0x02', 
                                                                                                        Nonce(<
                                                                                                               $DevEUI.1, 
                                                                                                               (
                                                                                                                '2'+
                                                                                                                '2'
                                                                                                               ), 
                                                                                                               ~rndJoinNonce.1
                                                                                                              >), 
                                                                                                        $JS, 
                                                                                                        (
                                                                                                         '1'+
                                                                                                         '1'
                                                                                                        ), 
                                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                                        'pad_with_0s'
                                                                                                       >,
                                                                                                       AesKey('App',
                                                                                                              ~rootAppKey.1)))), 
                                                                                  MAC(<$DevEUI.1, 
                                                                                       $NS, $AS, 
                                                                                       senc(<
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                                            >,
                                                                                            SessionKey(senc(<
                                                                                                             '0x02', 
                                                                                                             Nonce(<
                                                                                                                    $DevEUI.1, 
                                                                                                                    (
                                                                                                                     '2'+
                                                                                                                     '2'
                                                                                                                    ), 
                                                                                                                    ~rndJoinNonce.1
                                                                                                                   >), 
                                                                                                             $JS, 
                                                                                                             (
                                                                                                              '1'+
                                                                                                              '1'
                                                                                                             ), 
                                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                                             'pad_with_0s'
                                                                                                            >,
                                                                                                            AesKey('App',
                                                                                                                   ~rootAppKey.1))))
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                 >,
                                                                                 FNwkSIntKey.1)
                                                                            >,
                                                                            NwkSEncKey))
                                                       ) @ #vk.162 )
                                                  case Device_Send_KeyConf_AS
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_1
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_2
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_3
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConfAns_to_ED_case_4
                                                  by contradiction /* cyclic */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_1
                                                  by contradiction /* from formulas */
                                                next
                                                  case NS_Send_KeyConf_to_AS_case_2
                                                  by contradiction /* from formulas */
                                                next
                                                  case c_PD_Wrapper
                                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                        >,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                        >,
                                                                        FNwkSIntKey.1)
                                                                   >,
                                                                   NwkSEncKey)
                                                         ) @ #vk.176 )
                                                    case c_senc
                                                    by contradiction /* cyclic */
                                                  qed
                                                qed
                                              next
                                                case c_MAC
                                                solve( !KU( senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                       ) @ #vk.148 )
                                                  case c_senc
                                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1)
                                                         ) @ #vk.150 )
                                                    case AS_Receive_KeyConf
                                                    by contradiction /* cyclic */
                                                  next
                                                    case c_Nonce
                                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.151 )
                                                  qed
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_ED_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_ED_case_2
                                        solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                               ) @ #vk.49 )
                                          case NS_Send_KeyConf_to_AS_case_1
                                          by contradiction /* from formulas */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_2
                                          solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1)))), 
                                                                            MAC(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                           >,
                                                                           FNwkSIntKey.1)
                                                                      >,
                                                                      NwkSEncKey))
                                                 ) @ #vk.141 )
                                            case Device_Send_KeyConf_AS
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_1
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_2
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_3
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_4
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            by contradiction /* from formulas */
                                          next
                                            case c_PD_Wrapper
                                            solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                  >,
                                                                  FNwkSIntKey.1)
                                                             >,
                                                             NwkSEncKey)
                                                   ) @ #vk.155 )
                                              case c_senc
                                              by contradiction /* cyclic */
                                            qed
                                          qed
                                        next
                                          case c_MAC
                                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JS, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1))))
                                                 ) @ #vk.127 )
                                            case c_senc
                                            solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.129 )
                                              case AS_Receive_KeyConf
                                              by contradiction /* cyclic */
                                            next
                                              case c_Nonce
                                              by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.130 )
                                            qed
                                          qed
                                        qed
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                               ) @ #vk.45 )
                                          case NS_Send_KeyConf_to_AS_case_1
                                          by contradiction /* from formulas */
                                        next
                                          case NS_Send_KeyConf_to_AS_case_2
                                          solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1)))), 
                                                                            MAC(<$DevEUI.1, $NS, 
                                                                                 $AS, 
                                                                                 senc(<('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1)
                                                                                      >,
                                                                                      SessionKey(senc(<
                                                                                                       '0x02', 
                                                                                                       Nonce(<
                                                                                                              $DevEUI.1, 
                                                                                                              (
                                                                                                               '2'+
                                                                                                               '2'
                                                                                                              ), 
                                                                                                              ~rndJoinNonce.1
                                                                                                             >), 
                                                                                                       $JS, 
                                                                                                       (
                                                                                                        '1'+
                                                                                                        '1'
                                                                                                       ), 
                                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                                       'pad_with_0s'
                                                                                                      >,
                                                                                                      AesKey('App',
                                                                                                             ~rootAppKey.1))))
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                           >,
                                                                           FNwkSIntKey)
                                                                      >,
                                                                      NwkSEncKey))
                                                 ) @ #vk.115 )
                                            case Device_Send_KeyConf_AS
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_1
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_2
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_3
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConfAns_to_ED_case_4
                                            by contradiction /* cyclic */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            by contradiction /* from formulas */
                                          next
                                            case c_PD_Wrapper
                                            solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                  >,
                                                                  FNwkSIntKey)
                                                             >,
                                                             NwkSEncKey)
                                                   ) @ #vk.129 )
                                              case c_senc
                                              by contradiction /* cyclic */
                                            qed
                                          qed
                                        next
                                          case c_MAC
                                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JS, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1))))
                                                 ) @ #vk.101 )
                                            case c_senc
                                            solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.103 )
                                              case AS_Receive_KeyConf
                                              by contradiction /* cyclic */
                                            next
                                              case c_Nonce
                                              by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.104 )
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey)))), 
                                                    MAC(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey)))), 
                                                    MAC(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.88 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                 senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                              ~rndJoinNonce.1>), 
                                                                       $JS, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App',
                                                                             ~rootAppKey.1))))
                                                >,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                        ~rndJoinNonce.1>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.26 )
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                        >,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                   >,
                                                                   FNwkSIntKey)
                                                              >,
                                                              NwkSEncKey))
                                         ) @ #vk.74 )
                                    case Device_Send_KeyConf_AS
                                    solve( ED_State_01( $DevEUI.1, $JS, $NS, $AS, '1' ) ▶₀ #vr.47 )
                                      case EndDevice_Commissioned
                                      solve( CheckCtrJS( $DevEUI.1, '2' ) ▶₄ #vr.46 )
                                        case EndDevice_Commissioned
                                        solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                               ) @ #vk.79 )
                                          case c_senc
                                          solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.102 )
                                            case AS_Receive_KeyConf
                                            by contradiction /* cyclic */
                                          next
                                            case c_Nonce
                                            by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.103 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_1
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_2
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_3
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_4
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    by contradiction /* from formulas */
                                  next
                                    case c_PD_Wrapper
                                    solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                      senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JS, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1)))), 
                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1)))), 
                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1)))), 
                                                           MAC(<$DevEUI.1, $NS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1))))
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                          >,
                                                          FNwkSIntKey)
                                                     >,
                                                     NwkSEncKey)
                                           ) @ #vk.93 )
                                      case c_senc
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case c_MAC
                                  solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                   SessionKey(senc(<'0x02', 
                                                                    Nonce(<$DevEUI, ('2'+'2'), 
                                                                           ~rndJoinNonce>), 
                                                                    $JS, ('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                    'pad_with_0s'>,
                                                                   AesKey('App', ~rootAppKey))))
                                         ) @ #vk.59 )
                                    case c_senc
                                    solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.63 )
                                      case AS_Receive_KeyConf
                                      by contradiction /* cyclic */
                                    next
                                      case c_Nonce
                                      by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.64 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case c_AesKey
                              by solve( !KU( ~rootNwkKey ) @ #vk.53 )
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JS, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI, ('2'+'2'), 
                                                                      ~rndJoinNonce>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey))))
                                        >,
                                        SessionKey(senc(<'0x02', 
                                                         Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                               >), 
                                                         $JoinEUI, ('1'+'1'), 
                                                         Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                        AesKey('App', ~rootAppKey))))
                               ) @ #vk.15 )
                          case NS_Send_KeyConf_to_AS_case_1
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConf_to_AS_case_2
                          solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey)))), 
                                                       MAC(<$DevEUI, $JS, $AS, 
                                                            senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey))))
                                                           >,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce>), 
                                                                            $JoinEUI, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey)))), 
                                                       MAC(<$DevEUI, $JS, $AS, 
                                                            senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey)))), 
                                                            MAC(<$DevEUI, $JS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey))))
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey))))
                                                           >,
                                                           FNwkSIntKey)
                                                      >,
                                                      NwkSEncKey))
                                 ) @ #vk.67 )
                            case Device_Send_KeyConf_AS
                            solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                             senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                            >,
                                            SessionKey(senc(<'0x02', 
                                                             Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                    ~rndJoinNonce.1>), 
                                                             $JoinEUI, ('1'+'1'), 
                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                             'pad_with_0s'>,
                                                            AesKey('App', ~rootAppKey.1))))
                                   ) @ #vk.33 )
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1)))), 
                                                           MAC(<$DevEUI.1, $JS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1))))
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1)))), 
                                                           MAC(<$DevEUI.1, $JS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $JS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                    >,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                               >,
                                                               FNwkSIntKey)
                                                          >,
                                                          NwkSEncKey))
                                     ) @ #vk.111 )
                                case Device_Send_KeyConf_AS
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConfAns_to_ED_case_1
                                by contradiction /* cyclic */
                              next
                                case NS_Send_KeyConfAns_to_ED_case_2
                                by contradiction /* cyclic */
                              next
                                case NS_Send_KeyConfAns_to_ED_case_3
                                by contradiction /* cyclic */
                              next
                                case NS_Send_KeyConfAns_to_ED_case_4
                                by contradiction /* cyclic */
                              next
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                by contradiction /* from formulas */
                              next
                                case c_PD_Wrapper
                                solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                  senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+'2'), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1)))), 
                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1))))
                                                      >,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                              ~rndJoinNonce.1>), 
                                                                       $JoinEUI, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App',
                                                                             ~rootAppKey.1)))), 
                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                       MAC(<$DevEUI.1, $JS, $AS, 
                                                            senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                           >,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JoinEUI, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1))))
                                                      >,
                                                      FNwkSIntKey)
                                                 >,
                                                 NwkSEncKey)
                                       ) @ #vk.125 )
                                  case c_senc
                                  by contradiction /* cyclic */
                                qed
                              qed
                            next
                              case c_MAC
                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                               SessionKey(senc(<'0x02', 
                                                                Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                       ~rndJoinNonce.1>), 
                                                                $JoinEUI, ('1'+'1'), 
                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                'pad_with_0s'>,
                                                               AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.98 )
                                case c_senc
                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.102 )
                                  case AS_Receive_KeyConf
                                  by contradiction /* cyclic */
                                next
                                  case c_Nonce
                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.103 )
                                qed
                              qed
                            qed
                          next
                            case NS_Send_KeyConfAns_to_ED_case_1
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_2
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_3
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_4
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            by contradiction /* from formulas */
                          next
                            case c_PD_Wrapper
                            solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                              senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                   SessionKey(senc(<'0x02', 
                                                                    Nonce(<$DevEUI, ('2'+'2'), 
                                                                           ~rndJoinNonce>), 
                                                                    $JoinEUI, ('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                    'pad_with_0s'>,
                                                                   AesKey('App', ~rootAppKey)))), 
                                              MAC(<$DevEUI, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI, ('2'+'2'), 
                                                                          ~rndJoinNonce>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey)))), 
                                              MAC(<$DevEUI, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey)))), 
                                                   MAC(<$DevEUI, $JS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey))))
                                                       >,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI, ('2'+'2'), 
                                                                               ~rndJoinNonce>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App', ~rootAppKey))))
                                                  >,
                                                  FNwkSIntKey)
                                             >,
                                             NwkSEncKey)
                                   ) @ #vk.86 )
                              case c_senc
                              by contradiction /* cyclic */
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                           SessionKey(senc(<'0x02', 
                                                            Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                  >), 
                                                            $JoinEUI, ('1'+'1'), 
                                                            Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                           AesKey('App', ~rootAppKey))))
                                 ) @ #vk.54 )
                            case c_senc
                            solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.58 )
                              case AS_Receive_KeyConf
                              by contradiction /* cyclic */
                            next
                              case c_Nonce
                              by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.59 )
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case ApplicationServer_Receive_JoinAnswer_case_3
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_4
                  solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                        SessionKey(senc(<'0x02', 
                                                         Nonce(<$DevEUI, ('2'+ctr_JS_in), 
                                                                ~rndJoinNonce>), 
                                                         $JoinEUI, ('1'+'1'), 
                                                         Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                        AesKey('App', ~rootAppKey))))
                                  >,
                                  SessionKey(senc(<'0x02', 
                                                   Nonce(<$DevEUI, ('2'+ctr_JS_in), ~rndJoinNonce
                                                         >), 
                                                   $JoinEUI, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                   'pad_with_0s'>,
                                                  AesKey('App', ~rootAppKey))))
                         ) @ #vk.12 )
                    case NS_Send_KeyConf_to_AS_case_1
                    by contradiction /* from formulas */
                  next
                    case NS_Send_KeyConf_to_AS_case_2
                    solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                 senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI, 
                                                                              ('2'+ctr_JS_in), 
                                                                              ~rndJoinNonce>), 
                                                                       $JoinEUI, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App',
                                                                             ~rootAppKey)))), 
                                                 MAC(<$DevEUI, $NS, $AS, 
                                                      senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI, 
                                                                                   ('2'+ctr_JS_in), 
                                                                                   ~rndJoinNonce>), 
                                                                            $JoinEUI, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey))))
                                                     >,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, 
                                                                             ('2'+ctr_JS_in), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                 MAC(<$DevEUI, $NS, $AS, 
                                                      senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI, 
                                                                                   ('2'+ctr_JS_in), 
                                                                                   ~rndJoinNonce>), 
                                                                            $JoinEUI, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey)))), 
                                                      MAC(<$DevEUI, $NS, $AS, 
                                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+
                                                                                         ctr_JS_in
                                                                                        ), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+ctr_JS_in), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                     >,
                                                     FNwkSIntKey)
                                                >,
                                                NwkSEncKey))
                           ) @ #vk.73 )
                      case Device_Send_KeyConf_AS_case_1
                      solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                   senc(<
                                                         Nonce(<$DevEUI, ('2'+ctr_JS_in), 
                                                                ~rndJoinNonce>), 
                                                         NSNonce.2>,
                                                        SessionKey(senc(<'0x04', 
                                                                         Nonce(<$DevEUI, 
                                                                                ('2'+ctr_JS_in), 
                                                                                ~rndJoinNonce>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         NSNonce.2, 'pad_with_0s'>,
                                                                        AesKey('Nwk',
                                                                               ~rootNwkKey)))), 
                                                   MAC(<$DevEUI, $NS, 
                                                        senc(<
                                                              Nonce(<$DevEUI, ('2'+ctr_JS_in), 
                                                                     ~rndJoinNonce>), 
                                                              NSNonce.2>,
                                                             SessionKey(senc(<'0x04', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+ctr_JS_in
                                                                                     ), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              NSNonce.2, 
                                                                              'pad_with_0s'>,
                                                                             AesKey('Nwk',
                                                                                    ~rootNwkKey))))
                                                       >,
                                                       SessionKey(senc(<'0x03', 
                                                                        Nonce(<$DevEUI, 
                                                                               ('2'+ctr_JS_in), 
                                                                               ~rndJoinNonce>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        NSNonce.2, 'pad_with_0s'>,
                                                                       AesKey('Nwk', ~rootNwkKey))))
                                                  >,
                                                  SessionKey(senc(<'0x04', 
                                                                   Nonce(<$DevEUI, ('2'+ctr_JS_in), 
                                                                          ~rndJoinNonce>), 
                                                                   $JoinEUI, ('1'+'1'), NSNonce.2, 
                                                                   'pad_with_0s'>,
                                                                  AesKey('Nwk', ~rootNwkKey)))))
                             ) @ #vk.97 )
                        case NS_Send_KeyConfAns_to_ED_case_1
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConfAns_to_ED_case_2
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConfAns_to_ED_case_3
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConfAns_to_ED_case_4
                        solve( !KU( MAC(<$DevEUI.1, $NS.1, $AS, 
                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+ctr_JS_in.1), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                        >,
                                        SessionKey(senc(<'0x02', 
                                                         Nonce(<$DevEUI.1, ('2'+ctr_JS_in.1), 
                                                                ~rndJoinNonce.1>), 
                                                         $JoinEUI, ('1'+'1'), 
                                                         Nonce(~AS_rnd32DevAddr.1), 'pad_with_0s'>,
                                                        AesKey('App', ~rootAppKey.1))))
                               ) @ #vk.42 )
                          case NS_Send_KeyConf_to_AS_case_1
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConf_to_AS_case_2
                          solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                       senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+ctr_JS_in.1
                                                                                    ), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                            senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+
                                                                                          ctr_JS_in.1
                                                                                         ), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                           >,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+ctr_JS_in.1
                                                                                   ), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JoinEUI, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1)))), 
                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                            senc(<('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1)>,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+
                                                                                          ctr_JS_in.1
                                                                                         ), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                            MAC(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               ctr_JS_in.1
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                >,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+
                                                                                         ctr_JS_in.1
                                                                                        ), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                           >,
                                                           FNwkSIntKey.1)
                                                      >,
                                                      NwkSEncKey))
                                 ) @ #vk.158 )
                            case Device_Send_KeyConf_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case Device_Send_KeyConf_AS_case_2
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_1
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_2
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_3
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConfAns_to_ED_case_4
                            by contradiction /* cyclic */
                          next
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            by contradiction /* from formulas */
                          next
                            case c_PD_Wrapper
                            solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                              senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                   SessionKey(senc(<'0x02', 
                                                                    Nonce(<$DevEUI.1, 
                                                                           ('2'+ctr_JS_in.1), 
                                                                           ~rndJoinNonce.1>), 
                                                                    $JoinEUI, ('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                    'pad_with_0s'>,
                                                                   AesKey('App', ~rootAppKey.1)))), 
                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+ctr_JS_in.1), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, 
                                                                          ('2'+ctr_JS_in.1), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1)))), 
                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+ctr_JS_in.1), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+
                                                                                      ctr_JS_in.1), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                       >,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+ctr_JS_in.1), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1))))
                                                  >,
                                                  FNwkSIntKey.1)
                                             >,
                                             NwkSEncKey)
                                   ) @ #vk.172 )
                              case c_senc
                              by contradiction /* cyclic */
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                           SessionKey(senc(<'0x02', 
                                                            Nonce(<$DevEUI.1, ('2'+ctr_JS_in.1), 
                                                                   ~rndJoinNonce.1>), 
                                                            $JoinEUI, ('1'+'1'), 
                                                            Nonce(~AS_rnd32DevAddr.1), 'pad_with_0s'
                                                           >,
                                                           AesKey('App', ~rootAppKey.1))))
                                 ) @ #vk.145 )
                            case c_senc
                            solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.149 )
                              case AS_Receive_KeyConf
                              by contradiction /* cyclic */
                            next
                              case c_Nonce
                              by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.150 )
                            qed
                          qed
                        qed
                      next
                        case NS_Send_KeyConf_to_AS_case_1
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConf_to_AS_case_2
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConf_to_ED_case_1
                        by contradiction /* from formulas */
                      next
                        case NS_Send_KeyConf_to_ED_case_2
                        solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, 
                                                     senc(<('1'+'1'), Nonce(~rnd32DevAddr.3)>,
                                                          SessionKey(senc(<'0x04', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('Nwk',
                                                                                 ~rootNwkKey)))), 
                                                     MAC(<$DevEUI, $NS, 
                                                          senc(<('1'+'1'), Nonce(~rnd32DevAddr.3)>,
                                                               SessionKey(senc(<'0x04', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('Nwk',
                                                                                      ~rootNwkKey))))
                                                         >,
                                                         SNwkSIntKey)
                                                    >,
                                                    SessionKey(senc(<'0x04', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('Nwk', ~rootNwkKey)))))
                               ) @ #vk.94 )
                          case Device_Send_KeyConf_NS
                          solve( !KU( MAC(<$DevEUI.1, $NS.1, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                        ~rndJoinNonce.1>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey.1))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                  ~rndJoinNonce.1>), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr.1), 'pad_with_0s'
                                                          >,
                                                          AesKey('App', ~rootAppKey.1))))
                                 ) @ #vk.37 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+ctr_JS_in
                                                                                      ), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+
                                                                                            ctr_JS_in
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+ctr_JS_in
                                                                                     ), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+
                                                                                            ctr_JS_in
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 ctr_JS_in
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+
                                                                                           ctr_JS_in
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.120 )
                              case Device_Send_KeyConf_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case Device_Send_KeyConf_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, 
                                                                             ('2'+ctr_JS_in), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App',
                                                                            ~rootAppKey.1)))), 
                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+ctr_JS_in), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, 
                                                                            ('2'+ctr_JS_in), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App',
                                                                           ~rootAppKey.1)))), 
                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+ctr_JS_in), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1)))), 
                                                     MAC(<$DevEUI.1, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+
                                                                                        ctr_JS_in), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+ctr_JS_in), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.134 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                     ~rndJoinNonce.1>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                              'pad_with_0s'>,
                                                             AesKey('App', ~rootAppKey.1))))
                                   ) @ #vk.107 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.111 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.112 )
                              qed
                            qed
                          qed
                        next
                          case NS_Send_KeyConfAns_to_ED_case_1
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConfAns_to_ED_case_2
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConfAns_to_ED_case_3
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConfAns_to_ED_case_4
                          solve( !KU( MAC(<$DevEUI.1, $NS.1, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                        ~rndJoinNonce.1>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey.1))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                  ~rndJoinNonce.1>), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr.1), 'pad_with_0s'
                                                          >,
                                                          AesKey('App', ~rootAppKey.1))))
                                 ) @ #vk.53 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+ctr_JS_in
                                                                                      ), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+
                                                                                            ctr_JS_in
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+ctr_JS_in
                                                                                     ), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+
                                                                                            ctr_JS_in
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                              MAC(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 ctr_JS_in
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+
                                                                                           ctr_JS_in
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                             >,
                                                             FNwkSIntKey.2)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.185 )
                              case Device_Send_KeyConf_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case Device_Send_KeyConf_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, 
                                                                             ('2'+ctr_JS_in), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App',
                                                                            ~rootAppKey.1)))), 
                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+ctr_JS_in), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, 
                                                                            ('2'+ctr_JS_in), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App',
                                                                           ~rootAppKey.1)))), 
                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+ctr_JS_in), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1)))), 
                                                     MAC(<$DevEUI.1, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+
                                                                                        ctr_JS_in), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+ctr_JS_in), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1))))
                                                    >,
                                                    FNwkSIntKey.2)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.199 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI.1, ('2'+ctr_JS_in), 
                                                                     ~rndJoinNonce.1>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                              'pad_with_0s'>,
                                                             AesKey('App', ~rootAppKey.1))))
                                   ) @ #vk.172 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.176 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.177 )
                              qed
                            qed
                          qed
                        next
                          case NS_Send_KeyConf_to_AS_case_1
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConf_to_AS_case_2
                          by contradiction /* from formulas */
                        next
                          case c_PD_Wrapper
                          solve( !KU( senc(<$DevEUI, $NS, 
                                            senc(<('1'+'1'), Nonce(~rnd32DevAddr.3)>,
                                                 SessionKey(senc(<'0x04', 
                                                                  Nonce(<$DevEUI, ('2'+'2'), 
                                                                         ~rndJoinNonce>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~rnd32DevAddr), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('Nwk', ~rootNwkKey)))), 
                                            MAC(<$DevEUI, $NS, 
                                                 senc(<('1'+'1'), Nonce(~rnd32DevAddr.3)>,
                                                      SessionKey(senc(<'0x04', 
                                                                       Nonce(<$DevEUI, ('2'+'2'), 
                                                                              ~rndJoinNonce>), 
                                                                       $JoinEUI, ('1'+'1'), 
                                                                       Nonce(~rnd32DevAddr), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('Nwk', ~rootNwkKey))))
                                                >,
                                                SNwkSIntKey)
                                           >,
                                           SessionKey(senc(<'0x04', 
                                                            Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                  >), 
                                                            $JoinEUI, ('1'+'1'), 
                                                            Nonce(~rnd32DevAddr), 'pad_with_0s'>,
                                                           AesKey('Nwk', ~rootNwkKey))))
                                 ) @ #vk.127 )
                            case c_senc
                            solve( !KU( senc(<('1'+'1'), Nonce(~rnd32DevAddr.1)>,
                                             SessionKey(senc(<'0x04', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~rnd32DevAddr), 'pad_with_0s'>,
                                                             AesKey('Nwk', ~rootNwkKey))))
                                   ) @ #vk.131 )
                              case c_senc
                              solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                                  <'1', '2', JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                                   FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, 
                                                   AppSKey_in>
                                     ) ▶₂ #vr.4 )
                                case JoinServer_Commissioned
                                solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.2, $AS,
                                                    <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, 
                                                     JSIntKey_in, FNwkSIntKey_in, SNwkSIntKey_in, 
                                                     NwkSEncKey_in, AppSKey_in>
                                       ) ▶₂ #vr.17 )
                                  case JoinServer_Commissioned
                                  solve( ED_State_01( $DevEUI, $JoinEUI, $NS, $AS, '1' ) ▶₀ #vr.37 )
                                    case EndDevice_Commissioned
                                    solve( In_S( $AS, $JS.1,
                                                 <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr), 
                                                  $JoinEUI, $DevEUI, Counter(('1'+'1')), 
                                                  MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                                      AesKey('Nwk', ~rootNwkKey))
                                                 >
                                           ) ▶₀ #vr.4 )
                                      case ChanIn_S_case_1
                                      solve( In_S( $AS, $JS.2,
                                                   <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), 
                                                    $JS, $DevEUI.1, Counter(('1'+'1')), 
                                                    MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                                        AesKey('Nwk', ~rootNwkKey.2))
                                                   >
                                             ) ▶₀ #vr.17 )
                                        case ChanIn_S_case_1
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                          case EndDevice_Commissioned
                                          solve( !KU( MAC(<$DevEUI, $NS, 
                                                           senc(<('1'+'1'), Nonce(~rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x04', 
                                                                                 Nonce(<$DevEUI, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~rnd32DevAddr), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('Nwk',
                                                                                       ~rootNwkKey))))
                                                          >,
                                                          SNwkSIntKey)
                                                 ) @ #vk.122 )
                                            case c_MAC
                                            solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1))))
                                                   ) @ #vk.57 )
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1))))
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1)))), 
                                                                           MAC(<$DevEUI.1, $NS, 
                                                                                $AS, 
                                                                                senc(<('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1)
                                                                                     >,
                                                                                     SessionKey(senc(<
                                                                                                      '0x02', 
                                                                                                      Nonce(<
                                                                                                             $DevEUI.1, 
                                                                                                             (
                                                                                                              '2'+
                                                                                                              '2'
                                                                                                             ), 
                                                                                                             ~rndJoinNonce.1
                                                                                                            >), 
                                                                                                      $JS, 
                                                                                                      (
                                                                                                       '1'+
                                                                                                       '1'
                                                                                                      ), 
                                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                                      'pad_with_0s'
                                                                                                     >,
                                                                                                     AesKey('App',
                                                                                                            ~rootAppKey.1)))), 
                                                                                MAC(<$DevEUI.1, 
                                                                                     $NS, $AS, 
                                                                                     senc(<
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                                          >,
                                                                                          SessionKey(senc(<
                                                                                                           '0x02', 
                                                                                                           Nonce(<
                                                                                                                  $DevEUI.1, 
                                                                                                                  (
                                                                                                                   '2'+
                                                                                                                   '2'
                                                                                                                  ), 
                                                                                                                  ~rndJoinNonce.1
                                                                                                                 >), 
                                                                                                           $JS, 
                                                                                                           (
                                                                                                            '1'+
                                                                                                            '1'
                                                                                                           ), 
                                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                                           'pad_with_0s'
                                                                                                          >,
                                                                                                          AesKey('App',
                                                                                                                 ~rootAppKey.1))))
                                                                                    >,
                                                                                    SessionKey(senc(<
                                                                                                     '0x02', 
                                                                                                     Nonce(<
                                                                                                            $DevEUI.1, 
                                                                                                            (
                                                                                                             '2'+
                                                                                                             '2'
                                                                                                            ), 
                                                                                                            ~rndJoinNonce.1
                                                                                                           >), 
                                                                                                     $JS, 
                                                                                                     (
                                                                                                      '1'+
                                                                                                      '1'
                                                                                                     ), 
                                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                                     'pad_with_0s'
                                                                                                    >,
                                                                                                    AesKey('App',
                                                                                                           ~rootAppKey.1))))
                                                                               >,
                                                                               FNwkSIntKey.1)
                                                                          >,
                                                                          NwkSEncKey))
                                                     ) @ #vk.145 )
                                                case Device_Send_KeyConf_AS
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_1
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_2
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_3
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConfAns_to_ED_case_4
                                                by contradiction /* cyclic */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_1
                                                by contradiction /* from formulas */
                                              next
                                                case NS_Send_KeyConf_to_AS_case_2
                                                by contradiction /* from formulas */
                                              next
                                                case c_PD_Wrapper
                                                solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1)))), 
                                                                       MAC(<$DevEUI.1, $NS, $AS, 
                                                                            senc(<('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1)
                                                                                 >,
                                                                                 SessionKey(senc(<
                                                                                                  '0x02', 
                                                                                                  Nonce(<
                                                                                                         $DevEUI.1, 
                                                                                                         (
                                                                                                          '2'+
                                                                                                          '2'
                                                                                                         ), 
                                                                                                         ~rndJoinNonce.1
                                                                                                        >), 
                                                                                                  $JS, 
                                                                                                  (
                                                                                                   '1'+
                                                                                                   '1'
                                                                                                  ), 
                                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                                  'pad_with_0s'
                                                                                                 >,
                                                                                                 AesKey('App',
                                                                                                        ~rootAppKey.1))))
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                      >,
                                                                      FNwkSIntKey.1)
                                                                 >,
                                                                 NwkSEncKey)
                                                       ) @ #vk.159 )
                                                  case c_senc
                                                  by contradiction /* cyclic */
                                                qed
                                              qed
                                            next
                                              case c_MAC
                                              solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                     ) @ #vk.131 )
                                                case c_senc
                                                solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.133 )
                                                  case AS_Receive_KeyConf
                                                  by contradiction /* cyclic */
                                                next
                                                  case c_Nonce
                                                  by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.134 )
                                                qed
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case ChanIn_S_case_2
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                          case EndDevice_Commissioned
                                          solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                 ) @ #vk.55 )
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JS, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1)))), 
                                                                              MAC(<$DevEUI.1, $NS, 
                                                                                   $AS, 
                                                                                   senc(<('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1)
                                                                                        >,
                                                                                        SessionKey(senc(<
                                                                                                         '0x02', 
                                                                                                         Nonce(<
                                                                                                                $DevEUI.1, 
                                                                                                                (
                                                                                                                 '2'+
                                                                                                                 '2'
                                                                                                                ), 
                                                                                                                ~rndJoinNonce.1
                                                                                                               >), 
                                                                                                         $JS, 
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                         'pad_with_0s'
                                                                                                        >,
                                                                                                        AesKey('App',
                                                                                                               ~rootAppKey.1))))
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                             >,
                                                                             FNwkSIntKey.1)
                                                                        >,
                                                                        NwkSEncKey))
                                                   ) @ #vk.143 )
                                              case Device_Send_KeyConf_AS
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_1
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_2
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_3
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_4
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case c_PD_Wrapper
                                              solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                    >,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $NS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1)))), 
                                                                     MAC(<$DevEUI.1, $NS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JS, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1))))
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                    >,
                                                                    FNwkSIntKey.1)
                                                               >,
                                                               NwkSEncKey)
                                                     ) @ #vk.157 )
                                                case c_senc
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          next
                                            case c_MAC
                                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                   ) @ #vk.129 )
                                              case c_senc
                                              solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.131 )
                                                case AS_Receive_KeyConf
                                                by contradiction /* cyclic */
                                              next
                                                case c_Nonce
                                                by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.132 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    next
                                      case ChanIn_S_case_2
                                      solve( In_S( $AS, $JS.2,
                                                   <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), 
                                                    $JoinEUI, $DevEUI.1, Counter(('1'+'1')), 
                                                    MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                                        AesKey('Nwk', ~rootNwkKey.2))
                                                   >
                                             ) ▶₀ #vr.17 )
                                        case ChanIn_S_case_1
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                          case EndDevice_Commissioned
                                          solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                 ) @ #vk.55 )
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JoinEUI, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JoinEUI, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JoinEUI, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1)))), 
                                                                              MAC(<$DevEUI.1, $JS, 
                                                                                   $AS, 
                                                                                   senc(<('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1)
                                                                                        >,
                                                                                        SessionKey(senc(<
                                                                                                         '0x02', 
                                                                                                         Nonce(<
                                                                                                                $DevEUI.1, 
                                                                                                                (
                                                                                                                 '2'+
                                                                                                                 '2'
                                                                                                                ), 
                                                                                                                ~rndJoinNonce.1
                                                                                                               >), 
                                                                                                         $JoinEUI, 
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                         'pad_with_0s'
                                                                                                        >,
                                                                                                        AesKey('App',
                                                                                                               ~rootAppKey.1))))
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JoinEUI, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                             >,
                                                                             FNwkSIntKey.1)
                                                                        >,
                                                                        NwkSEncKey))
                                                   ) @ #vk.143 )
                                              case Device_Send_KeyConf_AS
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_1
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_2
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_3
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_4
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case c_PD_Wrapper
                                              solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $JS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                    >,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $JS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1)))), 
                                                                     MAC(<$DevEUI.1, $JS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JoinEUI, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1))))
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JoinEUI, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                    >,
                                                                    FNwkSIntKey.1)
                                                               >,
                                                               NwkSEncKey)
                                                     ) @ #vk.157 )
                                                case c_senc
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          next
                                            case c_MAC
                                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                   ) @ #vk.129 )
                                              case c_senc
                                              solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.131 )
                                                case AS_Receive_KeyConf
                                                by contradiction /* cyclic */
                                              next
                                                case c_Nonce
                                                by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.132 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      next
                                        case ChanIn_S_case_2
                                        solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                          case EndDevice_Commissioned
                                          solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JoinEUI, 
                                                                                 ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                 ) @ #vk.55 )
                                            case NS_Send_KeyConf_to_AS_case_1
                                            by contradiction /* from formulas */
                                          next
                                            case NS_Send_KeyConf_to_AS_case_2
                                            solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JoinEUI, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JoinEUI, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1))))
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                                              senc(<('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1)
                                                                                   >,
                                                                                   SessionKey(senc(<
                                                                                                    '0x02', 
                                                                                                    Nonce(<
                                                                                                           $DevEUI.1, 
                                                                                                           (
                                                                                                            '2'+
                                                                                                            '2'
                                                                                                           ), 
                                                                                                           ~rndJoinNonce.1
                                                                                                          >), 
                                                                                                    $JoinEUI, 
                                                                                                    (
                                                                                                     '1'+
                                                                                                     '1'
                                                                                                    ), 
                                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                                    'pad_with_0s'
                                                                                                   >,
                                                                                                   AesKey('App',
                                                                                                          ~rootAppKey.1)))), 
                                                                              MAC(<$DevEUI.1, $JS, 
                                                                                   $AS, 
                                                                                   senc(<('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1)
                                                                                        >,
                                                                                        SessionKey(senc(<
                                                                                                         '0x02', 
                                                                                                         Nonce(<
                                                                                                                $DevEUI.1, 
                                                                                                                (
                                                                                                                 '2'+
                                                                                                                 '2'
                                                                                                                ), 
                                                                                                                ~rndJoinNonce.1
                                                                                                               >), 
                                                                                                         $JoinEUI, 
                                                                                                         (
                                                                                                          '1'+
                                                                                                          '1'
                                                                                                         ), 
                                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                                         'pad_with_0s'
                                                                                                        >,
                                                                                                        AesKey('App',
                                                                                                               ~rootAppKey.1))))
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JoinEUI, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                             >,
                                                                             FNwkSIntKey.1)
                                                                        >,
                                                                        NwkSEncKey))
                                                   ) @ #vk.143 )
                                              case Device_Send_KeyConf_AS
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_1
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_2
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_3
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConfAns_to_ED_case_4
                                              by contradiction /* cyclic */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_1
                                              by contradiction /* from formulas */
                                            next
                                              case NS_Send_KeyConf_to_AS_case_2
                                              by contradiction /* from formulas */
                                            next
                                              case c_PD_Wrapper
                                              solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $JS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                    >,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                                MAC(<$DevEUI.1, $JS, $AS, 
                                                                     senc(<('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1)
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1)))), 
                                                                     MAC(<$DevEUI.1, $JS, $AS, 
                                                                          senc(<('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1)
                                                                               >,
                                                                               SessionKey(senc(<
                                                                                                '0x02', 
                                                                                                Nonce(<
                                                                                                       $DevEUI.1, 
                                                                                                       (
                                                                                                        '2'+
                                                                                                        '2'
                                                                                                       ), 
                                                                                                       ~rndJoinNonce.1
                                                                                                      >), 
                                                                                                $JoinEUI, 
                                                                                                (
                                                                                                 '1'+
                                                                                                 '1'
                                                                                                ), 
                                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                                'pad_with_0s'
                                                                                               >,
                                                                                               AesKey('App',
                                                                                                      ~rootAppKey.1))))
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JoinEUI, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                    >,
                                                                    FNwkSIntKey.1)
                                                               >,
                                                               NwkSEncKey)
                                                     ) @ #vk.157 )
                                                case c_senc
                                                by contradiction /* cyclic */
                                              qed
                                            qed
                                          next
                                            case c_MAC
                                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                   ) @ #vk.129 )
                                              case c_senc
                                              solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.131 )
                                                case AS_Receive_KeyConf
                                                by contradiction /* cyclic */
                                              next
                                                case c_Nonce
                                                by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.132 )
                                              qed
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case c_PD_Wrapper
                        solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                            <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                             FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, 
                                             AppSKey_in>
                               ) ▶₂ #vr.4 )
                          case JoinServer_Commissioned
                          solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.2, $AS,
                                              <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, 
                                               JSIntKey_in, FNwkSIntKey_in, SNwkSIntKey_in, 
                                               NwkSEncKey_in, AppSKey_in>
                                 ) ▶₂ #vr.17 )
                            case JoinServer_Commissioned
                            solve( ED_State_01( $DevEUI, $JoinEUI, $NS, $AS, '1' ) ▶₀ #vr.37 )
                              case EndDevice_Commissioned
                              solve( In_S( $AS, $JS.1,
                                           <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                            $DevEUI, Counter(('1'+'1')), 
                                            MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                                AesKey('Nwk', ~rootNwkKey))
                                           >
                                     ) ▶₀ #vr.4 )
                                case ChanIn_S_case_1
                                solve( In_S( $AS, $JS.2,
                                             <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, 
                                              $DevEUI.1, Counter(('1'+'1')), 
                                              MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                                  AesKey('Nwk', ~rootNwkKey.2))
                                             >
                                       ) ▶₀ #vr.17 )
                                  case ChanIn_S_case_1
                                  solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                    case EndDevice_Commissioned
                                    solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.38 )
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                       >,
                                                                       FNwkSIntKey)
                                                                  >,
                                                                  NwkSEncKey))
                                             ) @ #vk.108 )
                                        case Device_Send_KeyConf_AS
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                              >,
                                                              FNwkSIntKey)
                                                         >,
                                                         NwkSEncKey)
                                               ) @ #vk.122 )
                                          case c_senc
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    next
                                      case c_MAC
                                      solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+'2'), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JS, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1))))
                                             ) @ #vk.94 )
                                        case c_senc
                                        solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.98 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.99 )
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case ChanIn_S_case_2
                                  solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                    case EndDevice_Commissioned
                                    solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.38 )
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $NS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JS, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                       >,
                                                                       FNwkSIntKey)
                                                                  >,
                                                                  NwkSEncKey))
                                             ) @ #vk.108 )
                                        case Device_Send_KeyConf_AS
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                              >,
                                                              FNwkSIntKey)
                                                         >,
                                                         NwkSEncKey)
                                               ) @ #vk.122 )
                                          case c_senc
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    next
                                      case c_MAC
                                      solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+'2'), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JS, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1))))
                                             ) @ #vk.94 )
                                        case c_senc
                                        solve( !KU( senc(<$NS, $DevEUI, 
                                                          senc(<
                                                                Nonce(<$DevEUI, ('2'+'2'), 
                                                                       ~rndJoinNonce>), 
                                                                NSNonce>,
                                                               SessionKey(senc(<'0x04', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                NSNonce, 
                                                                                'pad_with_0s'>,
                                                                               AesKey('Nwk',
                                                                                      ~rootNwkKey)))), 
                                                          MAC(<$DevEUI, $NS, 
                                                               senc(<
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     NSNonce>,
                                                                    SessionKey(senc(<'0x04', 
                                                                                     Nonce(<
                                                                                            $DevEUI, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     NSNonce, 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('Nwk',
                                                                                           ~rootNwkKey))))
                                                              >,
                                                              SessionKey(senc(<'0x03', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               NSNonce, 
                                                                               'pad_with_0s'>,
                                                                              AesKey('Nwk',
                                                                                     ~rootNwkKey))))
                                                         >,
                                                         SessionKey(senc(<'0x04', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), NSNonce, 
                                                                          'pad_with_0s'>,
                                                                         AesKey('Nwk',
                                                                                ~rootNwkKey))))
                                               ) @ #vk.93 )
                                          case c_senc
                                          solve( !KU( senc(<
                                                            Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                  >), 
                                                            NSNonce>,
                                                           SessionKey(senc(<'0x04', 
                                                                            Nonce(<$DevEUI, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce>), 
                                                                            $JS, ('1'+'1'), 
                                                                            NSNonce, 'pad_with_0s'>,
                                                                           AesKey('Nwk',
                                                                                  ~rootNwkKey))))
                                                 ) @ #vk.102 )
                                            case c_senc
                                            solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.101 )
                                              case AS_Receive_KeyConf
                                              by contradiction /* cyclic */
                                            next
                                              case c_Nonce
                                              by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.107 )
                                            qed
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case ChanIn_S_case_2
                                solve( In_S( $AS, $JS.2,
                                             <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), 
                                              $JoinEUI, $DevEUI.1, Counter(('1'+'1')), 
                                              MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                                  AesKey('Nwk', ~rootNwkKey.2))
                                             >
                                       ) ▶₀ #vr.17 )
                                  case ChanIn_S_case_1
                                  solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                    case EndDevice_Commissioned
                                    solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.38 )
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $JS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $JS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JoinEUI, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                       >,
                                                                       FNwkSIntKey)
                                                                  >,
                                                                  NwkSEncKey))
                                             ) @ #vk.108 )
                                        case Device_Send_KeyConf_AS
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $JS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $JS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $JS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JoinEUI, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                              >,
                                                              FNwkSIntKey)
                                                         >,
                                                         NwkSEncKey)
                                               ) @ #vk.122 )
                                          case c_senc
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    next
                                      case c_MAC
                                      solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+'2'), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1))))
                                             ) @ #vk.94 )
                                        case c_senc
                                        solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.98 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.99 )
                                        qed
                                      qed
                                    qed
                                  qed
                                next
                                  case ChanIn_S_case_2
                                  solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.36 )
                                    case EndDevice_Commissioned
                                    solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.38 )
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $JS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1))))
                                                                       >,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                   MAC(<$DevEUI.1, $JS, $AS, 
                                                                        senc(<('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1)
                                                                             >,
                                                                             SessionKey(senc(<
                                                                                              '0x02', 
                                                                                              Nonce(<
                                                                                                     $DevEUI.1, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce.1
                                                                                                    >), 
                                                                                              $JoinEUI, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('App',
                                                                                                    ~rootAppKey.1)))), 
                                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                                             senc(<('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1)
                                                                                  >,
                                                                                  SessionKey(senc(<
                                                                                                   '0x02', 
                                                                                                   Nonce(<
                                                                                                          $DevEUI.1, 
                                                                                                          (
                                                                                                           '2'+
                                                                                                           '2'
                                                                                                          ), 
                                                                                                          ~rndJoinNonce.1
                                                                                                         >), 
                                                                                                   $JoinEUI, 
                                                                                                   (
                                                                                                    '1'+
                                                                                                    '1'
                                                                                                   ), 
                                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                                   'pad_with_0s'
                                                                                                  >,
                                                                                                  AesKey('App',
                                                                                                         ~rootAppKey.1))))
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                       >,
                                                                       FNwkSIntKey)
                                                                  >,
                                                                  NwkSEncKey))
                                             ) @ #vk.108 )
                                        case Device_Send_KeyConf_AS
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        by contradiction /* cyclic */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $JS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1))))
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                          MAC(<$DevEUI.1, $JS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JoinEUI, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $JS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JoinEUI, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                              >,
                                                              FNwkSIntKey)
                                                         >,
                                                         NwkSEncKey)
                                               ) @ #vk.122 )
                                          case c_senc
                                          by contradiction /* cyclic */
                                        qed
                                      qed
                                    next
                                      case c_MAC
                                      solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI.1, 
                                                                               ('2'+'2'), 
                                                                               ~rndJoinNonce.1>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App',
                                                                              ~rootAppKey.1))))
                                             ) @ #vk.94 )
                                        case c_senc
                                        solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.98 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.99 )
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case Device_Send_KeyConf_AS_case_2
                      by solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                             <'1', ('2'+z), JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                              FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, 
                                              AppSKey_in>
                                ) ▶₂ #vr.4 )
                    next
                      case NS_Send_KeyConfAns_to_ED_case_1
                      by contradiction /* cyclic */
                    next
                      case NS_Send_KeyConfAns_to_ED_case_2
                      by contradiction /* cyclic */
                    next
                      case NS_Send_KeyConfAns_to_ED_case_3
                      by contradiction /* cyclic */
                    next
                      case NS_Send_KeyConfAns_to_ED_case_4
                      by contradiction /* cyclic */
                    next
                      case NS_Send_KeyConf_to_AS_case_1
                      by contradiction /* from formulas */
                    next
                      case NS_Send_KeyConf_to_AS_case_2
                      by contradiction /* from formulas */
                    next
                      case c_PD_Wrapper
                      solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                          <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                           FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in
                                          >
                             ) ▶₂ #vr.4 )
                        case JoinServer_Commissioned
                        solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.2, $AS,
                                            <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                             FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, 
                                             AppSKey_in>
                               ) ▶₂ #vr.17 )
                          case JoinServer_Commissioned
                          solve( In_S( $AS, $JS.1,
                                       <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                        $DevEUI, Counter(('1'+'1')), 
                                        MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                            AesKey('Nwk', ~rootNwkKey))
                                       >
                                 ) ▶₀ #vr.4 )
                            case ChanIn_S_case_1
                            solve( In_S( $AS, $JS.2,
                                         <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, 
                                          $DevEUI.1, Counter(('1'+'1')), 
                                          MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                              AesKey('Nwk', ~rootNwkKey.2))
                                         >
                                   ) ▶₀ #vr.17 )
                              case ChanIn_S_case_1
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            next
                              case ChanIn_S_case_2
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case ChanIn_S_case_2
                            solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                              senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                   SessionKey(senc(<'0x02', 
                                                                    Nonce(<$DevEUI, ('2'+'2'), 
                                                                           ~rndJoinNonce>), 
                                                                    $JoinEUI, ('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                    'pad_with_0s'>,
                                                                   AesKey('App', ~rootAppKey)))), 
                                              MAC(<$DevEUI, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI, ('2'+'2'), 
                                                                          ~rndJoinNonce>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey)))), 
                                              MAC(<$DevEUI, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey)))), 
                                                   MAC(<$DevEUI, $JS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey))))
                                                       >,
                                                       SessionKey(senc(<'0x02', 
                                                                        Nonce(<$DevEUI, ('2'+'2'), 
                                                                               ~rndJoinNonce>), 
                                                                        $JoinEUI, ('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr), 
                                                                        'pad_with_0s'>,
                                                                       AesKey('App', ~rootAppKey))))
                                                  >,
                                                  FNwkSIntKey)
                                             >,
                                             NwkSEncKey)
                                   ) @ #vk.86 )
                              case c_senc
                              by contradiction /* cyclic */
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case c_MAC
                    solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.4 )
                      case JoinServer_Commissioned
                      solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                          <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                           FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in
                                          >
                             ) ▶₂ #vr.17 )
                        case JoinServer_Commissioned
                        solve( In_S( $AS, $JS.1,
                                     <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                      $DevEUI, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey))
                                     >
                               ) ▶₀ #vr.4 )
                          case ChanIn_S_case_1
                          solve( In_S( $AS, $JS.2,
                                       <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, 
                                        $DevEUI.1, Counter(('1'+'1')), 
                                        MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                            AesKey('Nwk', ~rootNwkKey.2))
                                       >
                                 ) ▶₀ #vr.17 )
                            case ChanIn_S_case_1
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          next
                            case ChanIn_S_case_2
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                           SessionKey(senc(<'0x02', 
                                                            Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                  >), 
                                                            $JoinEUI, ('1'+'1'), 
                                                            Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                           AesKey('App', ~rootAppKey))))
                                 ) @ #vk.54 )
                            case c_senc
                            solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.58 )
                              case AS_Receive_KeyConf
                              by contradiction /* cyclic */
                            next
                              case c_Nonce
                              by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.59 )
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case ApplicationServer_Receive_JoinAnswer_case_3
                by contradiction /* from formulas */
              next
                case ApplicationServer_Receive_JoinAnswer_case_4
                solve( AS_State_02( $JoinEUI.1, $DevEUI.1, $NS.1, $AS, DevNonce,
                                    AppNonce2, JoinNonce, AppSKey2
                       ) ▶₁ #j )
                  case ApplicationServer_Receive_JoinAnswer_case_1
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_2
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JS, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JS, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                      $DevEUI.1, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JoinEUI, $JS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $JS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JoinEUI, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $JS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JoinEUI, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $JS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JoinEUI, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JoinEUI, $JS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JoinEUI, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $JS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JoinEUI, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JoinEUI, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $JS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JoinEUI, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $JS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JoinEUI, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JoinEUI, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JoinEUI, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case ApplicationServer_Receive_JoinAnswer_case_3
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_4
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                  case EndDevice_Commissioned
                                  solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                   senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1))))
                                                  >,
                                                  SessionKey(senc(<'0x02', 
                                                                   Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                          ~rndJoinNonce.1>), 
                                                                   $JS, ('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                   'pad_with_0s'>,
                                                                  AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.35 )
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.107 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  next
                                    case c_MAC
                                    solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                             ~rndJoinNonce.1>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey.1))))
                                           ) @ #vk.93 )
                                      case c_senc
                                      solve( !KU( PD_Wrapper(senc(<$NS, $DevEUI, 
                                                                   senc(<
                                                                         Nonce(<$DevEUI, ('2'+'2'), 
                                                                                ~rndJoinNonce>), 
                                                                         NSNonce>,
                                                                        SessionKey(senc(<'0x04', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         NSNonce, 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('Nwk',
                                                                                               ~rootNwkKey)))), 
                                                                   MAC(<$DevEUI, $NS, 
                                                                        senc(<
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              NSNonce>,
                                                                             SessionKey(senc(<
                                                                                              '0x04', 
                                                                                              Nonce(<
                                                                                                     $DevEUI, 
                                                                                                     (
                                                                                                      '2'+
                                                                                                      '2'
                                                                                                     ), 
                                                                                                     ~rndJoinNonce
                                                                                                    >), 
                                                                                              $JS, 
                                                                                              ('1'+
                                                                                               '1'
                                                                                              ), 
                                                                                              NSNonce, 
                                                                                              'pad_with_0s'
                                                                                             >,
                                                                                             AesKey('Nwk',
                                                                                                    ~rootNwkKey))))
                                                                       >,
                                                                       SessionKey(senc(<'0x03', 
                                                                                        Nonce(<
                                                                                               $DevEUI, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        NSNonce, 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('Nwk',
                                                                                              ~rootNwkKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x04', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   NSNonce, 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('Nwk',
                                                                                         ~rootNwkKey)))))
                                             ) @ #vk.90 )
                                        case NS_Send_KeyConfAns_to_ED_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_3
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConfAns_to_ED_case_4
                                        solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.115 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.139 )
                                        qed
                                      next
                                        case NS_Send_KeyConf_to_AS_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_AS_case_2
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_ED_case_1
                                        by contradiction /* from formulas */
                                      next
                                        case NS_Send_KeyConf_to_ED_case_2
                                        solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.113 )
                                          case AS_Receive_KeyConf
                                          by contradiction /* cyclic */
                                        next
                                          case c_Nonce
                                          by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.125 )
                                        qed
                                      next
                                        case c_PD_Wrapper
                                        solve( !KU( senc(<$NS, $DevEUI, 
                                                          senc(<
                                                                Nonce(<$DevEUI, ('2'+'2'), 
                                                                       ~rndJoinNonce>), 
                                                                NSNonce>,
                                                               SessionKey(senc(<'0x04', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                NSNonce, 
                                                                                'pad_with_0s'>,
                                                                               AesKey('Nwk',
                                                                                      ~rootNwkKey)))), 
                                                          MAC(<$DevEUI, $NS, 
                                                               senc(<
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     NSNonce>,
                                                                    SessionKey(senc(<'0x04', 
                                                                                     Nonce(<
                                                                                            $DevEUI, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     NSNonce, 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('Nwk',
                                                                                           ~rootNwkKey))))
                                                              >,
                                                              SessionKey(senc(<'0x03', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               NSNonce, 
                                                                               'pad_with_0s'>,
                                                                              AesKey('Nwk',
                                                                                     ~rootNwkKey))))
                                                         >,
                                                         SessionKey(senc(<'0x04', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), NSNonce, 
                                                                          'pad_with_0s'>,
                                                                         AesKey('Nwk',
                                                                                ~rootNwkKey))))
                                               ) @ #vk.98 )
                                          case c_senc
                                          solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.100 )
                                            case AS_Receive_KeyConf
                                            by contradiction /* cyclic */
                                          next
                                            case c_Nonce
                                            by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.104 )
                                          qed
                                        qed
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                  case EndDevice_Commissioned
                                  solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                    case EndDevice_Commissioned
                                    solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                                 senc(<('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1)>,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1))))
                                                                     >,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1)))), 
                                                                 MAC(<$DevEUI.1, $NS, $AS, 
                                                                      senc(<('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1)
                                                                           >,
                                                                           SessionKey(senc(<'0x02', 
                                                                                            Nonce(<
                                                                                                   $DevEUI.1, 
                                                                                                   (
                                                                                                    '2'+
                                                                                                    '2'
                                                                                                   ), 
                                                                                                   ~rndJoinNonce.1
                                                                                                  >), 
                                                                                            $JS, 
                                                                                            ('1'+'1'
                                                                                            ), 
                                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                                            'pad_with_0s'
                                                                                           >,
                                                                                           AesKey('App',
                                                                                                  ~rootAppKey.1)))), 
                                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                                           senc(<('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1)
                                                                                >,
                                                                                SessionKey(senc(<
                                                                                                 '0x02', 
                                                                                                 Nonce(<
                                                                                                        $DevEUI.1, 
                                                                                                        (
                                                                                                         '2'+
                                                                                                         '2'
                                                                                                        ), 
                                                                                                        ~rndJoinNonce.1
                                                                                                       >), 
                                                                                                 $JS, 
                                                                                                 (
                                                                                                  '1'+
                                                                                                  '1'
                                                                                                 ), 
                                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                                 'pad_with_0s'
                                                                                                >,
                                                                                                AesKey('App',
                                                                                                       ~rootAppKey.1))))
                                                                          >,
                                                                          SessionKey(senc(<'0x02', 
                                                                                           Nonce(<
                                                                                                  $DevEUI.1, 
                                                                                                  (
                                                                                                   '2'+
                                                                                                   '2'
                                                                                                  ), 
                                                                                                  ~rndJoinNonce.1
                                                                                                 >), 
                                                                                           $JS, 
                                                                                           ('1'+'1'
                                                                                           ), 
                                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                                           'pad_with_0s'
                                                                                          >,
                                                                                          AesKey('App',
                                                                                                 ~rootAppKey.1))))
                                                                     >,
                                                                     FNwkSIntKey)
                                                                >,
                                                                NwkSEncKey))
                                           ) @ #vk.108 )
                                      case Device_Send_KeyConf_AS
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_1
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_2
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_3
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConfAns_to_ED_case_4
                                      by contradiction /* cyclic */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_1
                                      by contradiction /* from formulas */
                                    next
                                      case NS_Send_KeyConf_to_AS_case_2
                                      by contradiction /* from formulas */
                                    next
                                      case c_PD_Wrapper
                                      solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                        senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1))))
                                                            >,
                                                            SessionKey(senc(<'0x02', 
                                                                             Nonce(<$DevEUI.1, 
                                                                                    ('2'+'2'), 
                                                                                    ~rndJoinNonce.1
                                                                                   >), 
                                                                             $JS, ('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                             'pad_with_0s'>,
                                                                            AesKey('App',
                                                                                   ~rootAppKey.1)))), 
                                                        MAC(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1))))
                                                            >,
                                                            FNwkSIntKey)
                                                       >,
                                                       NwkSEncKey)
                                             ) @ #vk.121 )
                                        case c_senc
                                        by contradiction /* cyclic */
                                      qed
                                    qed
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                      $DevEUI.1, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case case_2
      solve( Role( 'AppServer' ) @ #i )
        case AS_Receive_KeyConf
        solve( Role( 'AppServer' ) @ #j )
          case AS_Receive_KeyConf
          solve( Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
                          <AppNonce1, AppSKey1>
                 ) @ #i )
            case AS_Receive_KeyConf
            solve( Running( 'Join_AS_ED_confree', $AS, DevEUIb,
                            <AppNonce2, AppSKey2>
                   ) @ #j )
              case AS_Receive_KeyConf
              solve( AS_State_02( $JoinEUI, $DevEUI, $NS, $AS, DevNonce,
                                  AppNonce, JoinNonce, AppSKey
                     ) ▶₁ #i )
                case ApplicationServer_Receive_JoinAnswer_case_1
                by contradiction /* from formulas */
              next
                case ApplicationServer_Receive_JoinAnswer_case_2
                solve( AS_State_02( $JoinEUI.1, $DevEUI.1, $NS.1, $AS, DevNonce,
                                    AppNonce2, JoinNonce, AppSKey2
                       ) ▶₁ #j )
                  case ApplicationServer_Receive_JoinAnswer_case_1
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_2
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                case EndDevice_Commissioned
                                solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                                 senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                      SessionKey(senc(<'0x02', 
                                                                       Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                              ~rndJoinNonce.1>), 
                                                                       $JS, ('1'+'1'), 
                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                       'pad_with_0s'>,
                                                                      AesKey('App',
                                                                             ~rootAppKey.1))))
                                                >,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                        ~rndJoinNonce.1>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.34 )
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                               senc(<('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1)>,
                                                                    SessionKey(senc(<'0x02', 
                                                                                     Nonce(<
                                                                                            $DevEUI.1, 
                                                                                            ('2'+'2'
                                                                                            ), 
                                                                                            ~rndJoinNonce.1
                                                                                           >), 
                                                                                     $JS, 
                                                                                     ('1'+'1'), 
                                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                                     'pad_with_0s'>,
                                                                                    AesKey('App',
                                                                                           ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1))))
                                                                   >,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1)))), 
                                                               MAC(<$DevEUI.1, $NS, $AS, 
                                                                    senc(<('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1)
                                                                         >,
                                                                         SessionKey(senc(<'0x02', 
                                                                                          Nonce(<
                                                                                                 $DevEUI.1, 
                                                                                                 (
                                                                                                  '2'+
                                                                                                  '2'
                                                                                                 ), 
                                                                                                 ~rndJoinNonce.1
                                                                                                >), 
                                                                                          $JS, 
                                                                                          ('1'+'1'
                                                                                          ), 
                                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                                          'pad_with_0s'
                                                                                         >,
                                                                                         AesKey('App',
                                                                                                ~rootAppKey.1)))), 
                                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                                         senc(<('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1)
                                                                              >,
                                                                              SessionKey(senc(<
                                                                                               '0x02', 
                                                                                               Nonce(<
                                                                                                      $DevEUI.1, 
                                                                                                      (
                                                                                                       '2'+
                                                                                                       '2'
                                                                                                      ), 
                                                                                                      ~rndJoinNonce.1
                                                                                                     >), 
                                                                                               $JS, 
                                                                                               ('1'+
                                                                                                '1'
                                                                                               ), 
                                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                                               'pad_with_0s'
                                                                                              >,
                                                                                              AesKey('App',
                                                                                                     ~rootAppKey.1))))
                                                                        >,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI.1, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce.1
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey.1))))
                                                                   >,
                                                                   FNwkSIntKey)
                                                              >,
                                                              NwkSEncKey))
                                         ) @ #vk.107 )
                                    case Device_Send_KeyConf_AS
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_1
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_2
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_3
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConfAns_to_ED_case_4
                                    by contradiction /* cyclic */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_1
                                    by contradiction /* from formulas */
                                  next
                                    case NS_Send_KeyConf_to_AS_case_2
                                    by contradiction /* from formulas */
                                  next
                                    case c_PD_Wrapper
                                    solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                      senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                           SessionKey(senc(<'0x02', 
                                                                            Nonce(<$DevEUI.1, 
                                                                                   ('2'+'2'), 
                                                                                   ~rndJoinNonce.1
                                                                                  >), 
                                                                            $JS, ('1'+'1'), 
                                                                            Nonce(~AS_rnd32DevAddr.1), 
                                                                            'pad_with_0s'>,
                                                                           AesKey('App',
                                                                                  ~rootAppKey.1)))), 
                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1))))
                                                          >,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI.1, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce.1
                                                                                 >), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr.1), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey.1)))), 
                                                      MAC(<$DevEUI.1, $NS, $AS, 
                                                           senc(<('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr.1)>,
                                                                SessionKey(senc(<'0x02', 
                                                                                 Nonce(<$DevEUI.1, 
                                                                                        ('2'+'2'), 
                                                                                        ~rndJoinNonce.1
                                                                                       >), 
                                                                                 $JS, ('1'+'1'), 
                                                                                 Nonce(~AS_rnd32DevAddr.1), 
                                                                                 'pad_with_0s'>,
                                                                                AesKey('App',
                                                                                       ~rootAppKey.1)))), 
                                                           MAC(<$DevEUI.1, $NS, $AS, 
                                                                senc(<('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr.1)>,
                                                                     SessionKey(senc(<'0x02', 
                                                                                      Nonce(<
                                                                                             $DevEUI.1, 
                                                                                             ('2'+
                                                                                              '2'), 
                                                                                             ~rndJoinNonce.1
                                                                                            >), 
                                                                                      $JS, 
                                                                                      ('1'+'1'), 
                                                                                      Nonce(~AS_rnd32DevAddr.1), 
                                                                                      'pad_with_0s'
                                                                                     >,
                                                                                     AesKey('App',
                                                                                            ~rootAppKey.1))))
                                                               >,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI.1, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce.1
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr.1), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey.1))))
                                                          >,
                                                          FNwkSIntKey)
                                                     >,
                                                     NwkSEncKey)
                                           ) @ #vk.121 )
                                      case c_senc
                                      by contradiction /* cyclic */
                                    qed
                                  qed
                                next
                                  case c_MAC
                                  solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                   SessionKey(senc(<'0x02', 
                                                                    Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                           ~rndJoinNonce.1>), 
                                                                    $JS, ('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                    'pad_with_0s'>,
                                                                   AesKey('App', ~rootAppKey.1))))
                                         ) @ #vk.93 )
                                    case c_senc
                                    solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                      case AS_Receive_KeyConf
                                      by contradiction /* cyclic */
                                    next
                                      case c_Nonce
                                      by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( ED_State_01( $DevEUI, $JS, $NS, $AS, '1' ) ▶₀ #vr.45 )
                                    case EndDevice_Commissioned
                                    solve( CheckCtrJS( $DevEUI, '2' ) ▶₄ #vr.44 )
                                      case EndDevice_Commissioned
                                      solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                        case AS_Receive_KeyConf
                                        by contradiction /* cyclic */
                                      next
                                        case c_Nonce
                                        by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                      qed
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI, ('2'+'2'), 
                                                                      ~rndJoinNonce>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey))))
                                        >,
                                        SessionKey(senc(<'0x02', 
                                                         Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                               >), 
                                                         $JoinEUI, ('1'+'1'), 
                                                         Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                        AesKey('App', ~rootAppKey))))
                               ) @ #vk.15 )
                          case NS_Send_KeyConf_to_AS_case_1
                          by contradiction /* from formulas */
                        next
                          case NS_Send_KeyConf_to_AS_case_2
                          solve( In_S( $AS, $JS.2,
                                       <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                        $DevEUI.1, Counter(('1'+'1')), 
                                        MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                            AesKey('Nwk', ~rootNwkKey.2))
                                       >
                                 ) ▶₀ #vr.17 )
                            case ChanIn_S_case_1
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.63 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.33 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case ChanIn_S_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.63 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.33 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          qed
                        next
                          case c_MAC
                          solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                           SessionKey(senc(<'0x02', 
                                                            Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                  >), 
                                                            $JoinEUI, ('1'+'1'), 
                                                            Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                           AesKey('App', ~rootAppKey))))
                                 ) @ #vk.54 )
                            case c_senc
                            solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.58 )
                              case AS_Receive_KeyConf
                              by contradiction /* cyclic */
                            next
                              case c_Nonce
                              by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.59 )
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case ApplicationServer_Receive_JoinAnswer_case_3
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_4
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                      $DevEUI.1, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case ApplicationServer_Receive_JoinAnswer_case_3
                by contradiction /* from formulas */
              next
                case ApplicationServer_Receive_JoinAnswer_case_4
                solve( AS_State_02( $JoinEUI.1, $DevEUI.1, $NS.1, $AS, DevNonce,
                                    AppNonce2, JoinNonce, AppSKey2
                       ) ▶₁ #j )
                  case ApplicationServer_Receive_JoinAnswer_case_1
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_2
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                      $DevEUI.1, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case ApplicationServer_Receive_JoinAnswer_case_3
                  by contradiction /* from formulas */
                next
                  case ApplicationServer_Receive_JoinAnswer_case_4
                  solve( JS_State_01( $JoinEUI, $DevEUI, $NS.2, $AS,
                                      <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                       FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                         ) ▶₂ #vr.4 )
                    case JoinServer_Commissioned
                    solve( JS_State_01( $JoinEUI, $DevEUI.1, $NS.3, $AS,
                                        <'1', ctr_JS_in, JoinNonce_in, DevAddr_in, JSIntKey_in, 
                                         FNwkSIntKey_in, SNwkSIntKey_in, NwkSEncKey_in, AppSKey_in>
                           ) ▶₂ #vr.17 )
                      case JoinServer_Commissioned
                      solve( In_S( $AS, $JS.1,
                                   <'AS_Request', $NS.2, Nonce(~AS_rnd32DevAddr), $JoinEUI, 
                                    $DevEUI, Counter(('1'+'1')), 
                                    MAC(<'MHDR', $JoinEUI, $DevEUI, ('1'+'1')>,
                                        AesKey('Nwk', ~rootNwkKey))
                                   >
                             ) ▶₀ #vr.4 )
                        case ChanIn_S_case_1
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $NS, Nonce(~AS_rnd32DevAddr.1), $JS, $DevEUI.1, 
                                      Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JS, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $NS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JS, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JS, ('1'+'1'), Nonce(~AS_rnd32DevAddr), 
                                                           'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $NS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JS, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $NS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JS, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $NS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JS, ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JS, ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $NS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JS, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $NS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JS, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JS, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $NS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JS, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $NS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JS, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $NS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JS, ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JS, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JS, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $NS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JS, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JS, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $NS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JS, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $NS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JS, ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JS, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JS, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      next
                        case ChanIn_S_case_2
                        solve( In_S( $AS, $JS.2,
                                     <'AS_Request', $JS, Nonce(~AS_rnd32DevAddr.1), $JoinEUI, 
                                      $DevEUI.1, Counter(('1'+'1')), 
                                      MAC(<'MHDR', $JoinEUI, $DevEUI.1, ('1'+'1')>,
                                          AesKey('Nwk', ~rootNwkKey.2))
                                     >
                               ) ▶₀ #vr.17 )
                          case ChanIn_S_case_1
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        next
                          case ChanIn_S_case_2
                          solve( !KU( MAC(<$DevEUI, $JS, $AS, 
                                           senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                SessionKey(senc(<'0x02', 
                                                                 Nonce(<$DevEUI, ('2'+'2'), 
                                                                        ~rndJoinNonce>), 
                                                                 $JoinEUI, ('1'+'1'), 
                                                                 Nonce(~AS_rnd32DevAddr), 
                                                                 'pad_with_0s'>,
                                                                AesKey('App', ~rootAppKey))))
                                          >,
                                          SessionKey(senc(<'0x02', 
                                                           Nonce(<$DevEUI, ('2'+'2'), ~rndJoinNonce
                                                                 >), 
                                                           $JoinEUI, ('1'+'1'), 
                                                           Nonce(~AS_rnd32DevAddr), 'pad_with_0s'>,
                                                          AesKey('App', ~rootAppKey))))
                                 ) @ #vk.15 )
                            case NS_Send_KeyConf_to_AS_case_1
                            by contradiction /* from formulas */
                          next
                            case NS_Send_KeyConf_to_AS_case_2
                            solve( !KU( PD_Wrapper(senc(<$DevEUI, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey)))), 
                                                         MAC(<$DevEUI, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<$DevEUI, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey)))), 
                                                              MAC(<$DevEUI, $JS, $AS, 
                                                                   senc(<('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr)>,
                                                                        SessionKey(senc(<'0x02', 
                                                                                         Nonce(<
                                                                                                $DevEUI, 
                                                                                                (
                                                                                                 '2'+
                                                                                                 '2'
                                                                                                ), 
                                                                                                ~rndJoinNonce
                                                                                               >), 
                                                                                         $JoinEUI, 
                                                                                         ('1'+'1'), 
                                                                                         Nonce(~AS_rnd32DevAddr), 
                                                                                         'pad_with_0s'
                                                                                        >,
                                                                                        AesKey('App',
                                                                                               ~rootAppKey))))
                                                                  >,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<$DevEUI, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey))))
                                                             >,
                                                             FNwkSIntKey)
                                                        >,
                                                        NwkSEncKey))
                                   ) @ #vk.62 )
                              case Device_Send_KeyConf_AS
                              solve( !KU( MAC(<$DevEUI.1, $JS, $AS, 
                                               senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                            ~rndJoinNonce.1>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr.1), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey.1))))
                                              >,
                                              SessionKey(senc(<'0x02', 
                                                               Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                      ~rndJoinNonce.1>), 
                                                               $JoinEUI, ('1'+'1'), 
                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                               'pad_with_0s'>,
                                                              AesKey('App', ~rootAppKey.1))))
                                     ) @ #vk.32 )
                                case NS_Send_KeyConf_to_AS_case_1
                                by contradiction /* from formulas */
                              next
                                case NS_Send_KeyConf_to_AS_case_2
                                solve( !KU( PD_Wrapper(senc(<$DevEUI.1, $JS, $AS, 
                                                             senc(<('1'+'1'), 
                                                                   Nonce(~AS_rnd32DevAddr.1)>,
                                                                  SessionKey(senc(<'0x02', 
                                                                                   Nonce(<
                                                                                          $DevEUI.1, 
                                                                                          ('2'+'2'
                                                                                          ), 
                                                                                          ~rndJoinNonce.1
                                                                                         >), 
                                                                                   $JoinEUI, 
                                                                                   ('1'+'1'), 
                                                                                   Nonce(~AS_rnd32DevAddr.1), 
                                                                                   'pad_with_0s'>,
                                                                                  AesKey('App',
                                                                                         ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1))))
                                                                 >,
                                                                 SessionKey(senc(<'0x02', 
                                                                                  Nonce(<$DevEUI.1, 
                                                                                         ('2'+'2'), 
                                                                                         ~rndJoinNonce.1
                                                                                        >), 
                                                                                  $JoinEUI, 
                                                                                  ('1'+'1'), 
                                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                                  'pad_with_0s'>,
                                                                                 AesKey('App',
                                                                                        ~rootAppKey.1)))), 
                                                             MAC(<$DevEUI.1, $JS, $AS, 
                                                                  senc(<('1'+'1'), 
                                                                        Nonce(~AS_rnd32DevAddr.1)>,
                                                                       SessionKey(senc(<'0x02', 
                                                                                        Nonce(<
                                                                                               $DevEUI.1, 
                                                                                               ('2'+
                                                                                                '2'
                                                                                               ), 
                                                                                               ~rndJoinNonce.1
                                                                                              >), 
                                                                                        $JoinEUI, 
                                                                                        ('1'+'1'), 
                                                                                        Nonce(~AS_rnd32DevAddr.1), 
                                                                                        'pad_with_0s'
                                                                                       >,
                                                                                       AesKey('App',
                                                                                              ~rootAppKey.1)))), 
                                                                  MAC(<$DevEUI.1, $JS, $AS, 
                                                                       senc(<('1'+'1'), 
                                                                             Nonce(~AS_rnd32DevAddr.1)
                                                                            >,
                                                                            SessionKey(senc(<
                                                                                             '0x02', 
                                                                                             Nonce(<
                                                                                                    $DevEUI.1, 
                                                                                                    (
                                                                                                     '2'+
                                                                                                     '2'
                                                                                                    ), 
                                                                                                    ~rndJoinNonce.1
                                                                                                   >), 
                                                                                             $JoinEUI, 
                                                                                             ('1'+
                                                                                              '1'), 
                                                                                             Nonce(~AS_rnd32DevAddr.1), 
                                                                                             'pad_with_0s'
                                                                                            >,
                                                                                            AesKey('App',
                                                                                                   ~rootAppKey.1))))
                                                                      >,
                                                                      SessionKey(senc(<'0x02', 
                                                                                       Nonce(<
                                                                                              $DevEUI.1, 
                                                                                              ('2'+
                                                                                               '2'
                                                                                              ), 
                                                                                              ~rndJoinNonce.1
                                                                                             >), 
                                                                                       $JoinEUI, 
                                                                                       ('1'+'1'), 
                                                                                       Nonce(~AS_rnd32DevAddr.1), 
                                                                                       'pad_with_0s'
                                                                                      >,
                                                                                      AesKey('App',
                                                                                             ~rootAppKey.1))))
                                                                 >,
                                                                 FNwkSIntKey)
                                                            >,
                                                            NwkSEncKey))
                                       ) @ #vk.107 )
                                  case Device_Send_KeyConf_AS
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_1
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_2
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_3
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConfAns_to_ED_case_4
                                  by contradiction /* cyclic */
                                next
                                  case NS_Send_KeyConf_to_AS_case_1
                                  by contradiction /* from formulas */
                                next
                                  case NS_Send_KeyConf_to_AS_case_2
                                  by contradiction /* from formulas */
                                next
                                  case c_PD_Wrapper
                                  solve( !KU( senc(<$DevEUI.1, $JS, $AS, 
                                                    senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI.1, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce.1>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr.1), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1))))
                                                        >,
                                                        SessionKey(senc(<'0x02', 
                                                                         Nonce(<$DevEUI.1, 
                                                                                ('2'+'2'), 
                                                                                ~rndJoinNonce.1>), 
                                                                         $JoinEUI, ('1'+'1'), 
                                                                         Nonce(~AS_rnd32DevAddr.1), 
                                                                         'pad_with_0s'>,
                                                                        AesKey('App',
                                                                               ~rootAppKey.1)))), 
                                                    MAC(<$DevEUI.1, $JS, $AS, 
                                                         senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)
                                                              >,
                                                              SessionKey(senc(<'0x02', 
                                                                               Nonce(<$DevEUI.1, 
                                                                                      ('2'+'2'), 
                                                                                      ~rndJoinNonce.1
                                                                                     >), 
                                                                               $JoinEUI, ('1'+'1'), 
                                                                               Nonce(~AS_rnd32DevAddr.1), 
                                                                               'pad_with_0s'>,
                                                                              AesKey('App',
                                                                                     ~rootAppKey.1)))), 
                                                         MAC(<$DevEUI.1, $JS, $AS, 
                                                              senc(<('1'+'1'), 
                                                                    Nonce(~AS_rnd32DevAddr.1)>,
                                                                   SessionKey(senc(<'0x02', 
                                                                                    Nonce(<
                                                                                           $DevEUI.1, 
                                                                                           ('2'+'2'
                                                                                           ), 
                                                                                           ~rndJoinNonce.1
                                                                                          >), 
                                                                                    $JoinEUI, 
                                                                                    ('1'+'1'), 
                                                                                    Nonce(~AS_rnd32DevAddr.1), 
                                                                                    'pad_with_0s'>,
                                                                                   AesKey('App',
                                                                                          ~rootAppKey.1))))
                                                             >,
                                                             SessionKey(senc(<'0x02', 
                                                                              Nonce(<$DevEUI.1, 
                                                                                     ('2'+'2'), 
                                                                                     ~rndJoinNonce.1
                                                                                    >), 
                                                                              $JoinEUI, ('1'+'1'), 
                                                                              Nonce(~AS_rnd32DevAddr.1), 
                                                                              'pad_with_0s'>,
                                                                             AesKey('App',
                                                                                    ~rootAppKey.1))))
                                                        >,
                                                        FNwkSIntKey)
                                                   >,
                                                   NwkSEncKey)
                                         ) @ #vk.121 )
                                    case c_senc
                                    by contradiction /* cyclic */
                                  qed
                                qed
                              next
                                case c_MAC
                                solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr.1)>,
                                                 SessionKey(senc(<'0x02', 
                                                                  Nonce(<$DevEUI.1, ('2'+'2'), 
                                                                         ~rndJoinNonce.1>), 
                                                                  $JoinEUI, ('1'+'1'), 
                                                                  Nonce(~AS_rnd32DevAddr.1), 
                                                                  'pad_with_0s'>,
                                                                 AesKey('App', ~rootAppKey.1))))
                                       ) @ #vk.93 )
                                  case c_senc
                                  solve( !KU( Nonce(~AS_rnd32DevAddr.1) ) @ #vk.97 )
                                    case AS_Receive_KeyConf
                                    by contradiction /* cyclic */
                                  next
                                    case c_Nonce
                                    by solve( !KU( ~AS_rnd32DevAddr.1 ) @ #vk.98 )
                                  qed
                                qed
                              qed
                            next
                              case NS_Send_KeyConfAns_to_ED_case_1
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_2
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_3
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConfAns_to_ED_case_4
                              by contradiction /* cyclic */
                            next
                              case NS_Send_KeyConf_to_AS_case_1
                              by contradiction /* from formulas */
                            next
                              case NS_Send_KeyConf_to_AS_case_2
                              by contradiction /* from formulas */
                            next
                              case c_PD_Wrapper
                              solve( !KU( senc(<$DevEUI, $JS, $AS, 
                                                senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                     SessionKey(senc(<'0x02', 
                                                                      Nonce(<$DevEUI, ('2'+'2'), 
                                                                             ~rndJoinNonce>), 
                                                                      $JoinEUI, ('1'+'1'), 
                                                                      Nonce(~AS_rnd32DevAddr), 
                                                                      'pad_with_0s'>,
                                                                     AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey))))
                                                    >,
                                                    SessionKey(senc(<'0x02', 
                                                                     Nonce(<$DevEUI, ('2'+'2'), 
                                                                            ~rndJoinNonce>), 
                                                                     $JoinEUI, ('1'+'1'), 
                                                                     Nonce(~AS_rnd32DevAddr), 
                                                                     'pad_with_0s'>,
                                                                    AesKey('App', ~rootAppKey)))), 
                                                MAC(<$DevEUI, $JS, $AS, 
                                                     senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                          SessionKey(senc(<'0x02', 
                                                                           Nonce(<$DevEUI, 
                                                                                  ('2'+'2'), 
                                                                                  ~rndJoinNonce>), 
                                                                           $JoinEUI, ('1'+'1'), 
                                                                           Nonce(~AS_rnd32DevAddr), 
                                                                           'pad_with_0s'>,
                                                                          AesKey('App',
                                                                                 ~rootAppKey)))), 
                                                     MAC(<$DevEUI, $JS, $AS, 
                                                          senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                                               SessionKey(senc(<'0x02', 
                                                                                Nonce(<$DevEUI, 
                                                                                       ('2'+'2'), 
                                                                                       ~rndJoinNonce
                                                                                      >), 
                                                                                $JoinEUI, 
                                                                                ('1'+'1'), 
                                                                                Nonce(~AS_rnd32DevAddr), 
                                                                                'pad_with_0s'>,
                                                                               AesKey('App',
                                                                                      ~rootAppKey))))
                                                         >,
                                                         SessionKey(senc(<'0x02', 
                                                                          Nonce(<$DevEUI, 
                                                                                 ('2'+'2'), 
                                                                                 ~rndJoinNonce>), 
                                                                          $JoinEUI, ('1'+'1'), 
                                                                          Nonce(~AS_rnd32DevAddr), 
                                                                          'pad_with_0s'>,
                                                                         AesKey('App',
                                                                                ~rootAppKey))))
                                                    >,
                                                    FNwkSIntKey)
                                               >,
                                               NwkSEncKey)
                                     ) @ #vk.81 )
                                case c_senc
                                by contradiction /* cyclic */
                              qed
                            qed
                          next
                            case c_MAC
                            solve( !KU( senc(<('1'+'1'), Nonce(~AS_rnd32DevAddr)>,
                                             SessionKey(senc(<'0x02', 
                                                              Nonce(<$DevEUI, ('2'+'2'), 
                                                                     ~rndJoinNonce>), 
                                                              $JoinEUI, ('1'+'1'), 
                                                              Nonce(~AS_rnd32DevAddr), 'pad_with_0s'
                                                             >,
                                                             AesKey('App', ~rootAppKey))))
                                   ) @ #vk.49 )
                              case c_senc
                              solve( !KU( Nonce(~AS_rnd32DevAddr) ) @ #vk.53 )
                                case AS_Receive_KeyConf
                                by contradiction /* cyclic */
                              next
                                case c_Nonce
                                by solve( !KU( ~AS_rnd32DevAddr ) @ #vk.54 )
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case case_3
      by contradiction /* from formulas */
    next
      case case_4
      by contradiction /* from formulas */
    next
      case case_5
      by contradiction /* from formulas */
    next
      case case_6
      by contradiction /* from formulas */
    qed
  next
    case case_2_case_1
    by contradiction /* from formulas */
  next
    case case_2_case_2
    by contradiction /* from formulas */
  next
    case case_3_case_1
    by contradiction /* from formulas */
  next
    case case_3_case_2
    by contradiction /* from formulas */
  next
    case case_4
    by contradiction /* from formulas */
  qed
qed

lemma AS_confusion_freeness_2 [use_induction]:
  all-traces
  "∀ DevEUIa AppSvr AppNonce1 AppSKey1 #i.
    ((Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
               <AppNonce1, AppSKey1>
      ) @ #i) ∧
     (Role( 'AppServer' ) @ #i)) ⇒
    ((∃ JoinEUI #p.
       (Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
                <AppNonce1, AppSKey1>
        ) @ #p) ∧
       (Role( 'EndDevice' ) @ #p)) ∨
     (∃ RevealEvent Entity #kr1.
       (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧
       (Honest( Entity ) @ #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ DevEUIa AppSvr AppNonce1 AppSKey1 #i.
  (Running( 'Join_AS_ED_confree', AppSvr, DevEUIa,
            <AppNonce1, AppSKey1>
   ) @ #i) ∧
  (Role( 'AppServer' ) @ #i)
 ∧
  (∀ JoinEUI #p.
    (Commit( 'Join_ED_JS_confree', DevEUIa, JoinEUI,
             <AppNonce1, AppSKey1>
     ) @ #p) ∧
    (Role( 'EndDevice' ) @ #p)
   ⇒
    ⊥) ∧
  (∀ RevealEvent Entity #kr1.
    (KeyReveal( RevealEvent, Entity ) @ #kr1) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥)"
*/
by sorry

lemma auth_weak_agreement_ED_AS:
  all-traces
  "∀ AppSvr DevEUI n1 #i.
    ((Commit( 'Join_AS_ED', DevEUI, AppSvr, n1 ) @ #i) ∧
     (Role( 'EndDevice' ) @ #i)) ⇒
    ((∃ n2 #j.
       (Running( 'Join_AS_ED', AppSvr, DevEUI, n2 ) @ #j) ∧
       (Role( 'AppServer' ) @ #j)) ∨
     (∃ RevealEvent Entity #kr.
       (KeyReveal( RevealEvent, Entity ) @ #kr) ∧
       (Honest( Entity ) @ #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ AppSvr DevEUI n1 #i.
  (Commit( 'Join_AS_ED', DevEUI, AppSvr, n1 ) @ #i) ∧
  (Role( 'EndDevice' ) @ #i)
 ∧
  (∀ n2 #j.
    (Running( 'Join_AS_ED', AppSvr, DevEUI, n2 ) @ #j) ∧
    (Role( 'AppServer' ) @ #j)
   ⇒
    ⊥) ∧
  (∀ RevealEvent Entity #kr.
    (KeyReveal( RevealEvent, Entity ) @ #kr) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥)"
*/
by sorry

lemma auth_non_injective_agreement_ED_AS:
  all-traces
  "∀ DevEUI AppSvr n1 #i.
    ((Commit( 'Join_AS_ED', DevEUI, AppSvr, n1 ) @ #i) ∧
     (Role( 'EndDevice' ) @ #i)) ⇒
    ((∃ #j.
       (Running( 'Join_AS_ED', AppSvr, DevEUI, n1 ) @ #j) ∧
       (Role( 'AppServer' ) @ #j)) ∨
     (∃ RevealEvent Entity #kr.
       (KeyReveal( RevealEvent, Entity ) @ #kr) ∧
       (Honest( Entity ) @ #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ DevEUI AppSvr n1 #i.
  (Commit( 'Join_AS_ED', DevEUI, AppSvr, n1 ) @ #i) ∧
  (Role( 'EndDevice' ) @ #i)
 ∧
  (∀ #j.
    (Running( 'Join_AS_ED', AppSvr, DevEUI, n1 ) @ #j) ∧
    (Role( 'AppServer' ) @ #j)
   ⇒
    ⊥) ∧
  (∀ RevealEvent Entity #kr.
    (KeyReveal( RevealEvent, Entity ) @ #kr) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥)"
*/
by sorry

lemma auth_injective_agreement_ED_AS:
  all-traces
  "∀ DevEUI AppSvr n #i.
    ((Commit( 'Join_AS_ED', DevEUI, AppSvr, n ) @ #i) ∧
     (Role( 'EndDevice' ) @ #i)) ⇒
    ((∃ #j.
       (((Running( 'Join_AS_ED', AppSvr, DevEUI, n ) @ #j) ∧
         (Role( 'AppServer' ) @ #j)) ∧
        (#j < #i)) ∧
       (¬(∃ DevEUI1 AppSvr1 #i1.
           ((Commit( 'Join_AS_ED', DevEUI1, AppSvr1, n ) @ #i1) ∧
            (Role( 'EndDevice' ) @ #i1)) ∧
           (¬(#i1 = #i))))) ∨
     (∃ RevealEvent Entity #kr.
       (KeyReveal( RevealEvent, Entity ) @ #kr) ∧
       (Honest( Entity ) @ #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ DevEUI AppSvr n #i.
  (Commit( 'Join_AS_ED', DevEUI, AppSvr, n ) @ #i) ∧
  (Role( 'EndDevice' ) @ #i)
 ∧
  (∀ #j.
    (Running( 'Join_AS_ED', AppSvr, DevEUI, n ) @ #j) ∧
    (Role( 'AppServer' ) @ #j)
   ⇒
    ((¬(#j < #i)) ∨
     (∃ DevEUI1 AppSvr1 #i1.
       (Commit( 'Join_AS_ED', DevEUI1, AppSvr1, n ) @ #i1) ∧
       (Role( 'EndDevice' ) @ #i1)
      ∧
       ¬(#i1 = #i)))) ∧
  (∀ RevealEvent Entity #kr.
    (KeyReveal( RevealEvent, Entity ) @ #kr) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥)"
*/
by sorry

lemma auth_secrecy_keys:
  all-traces
  "∀ DevEUI JoinEUI NSNonce AppNonce JoinNonce #i.
    (Secret( DevEUI, JoinEUI, <NSNonce, AppNonce, JoinNonce> ) @ #i) ⇒
    ((((¬(∃ #k1. K( NSNonce ) @ #k1)) ∧
       (¬(∃ #k2. K( AppNonce ) @ #k2))) ∧
      (¬(∃ #k3. K( JoinNonce ) @ #k3))) ∨
     (∃ RevealEvent Entity #kr.
       (KeyReveal( RevealEvent, Entity ) @ #kr) ∧
       (Honest( Entity ) @ #i)))"
/*
guarded formula characterizing all counter-examples:
"∃ DevEUI JoinEUI NSNonce AppNonce JoinNonce #i.
  (Secret( DevEUI, JoinEUI, <NSNonce, AppNonce, JoinNonce> ) @ #i)
 ∧
  (((∃ #k1. (K( NSNonce ) @ #k1)) ∨
    (∃ #k2. (K( AppNonce ) @ #k2)) ∨
    (∃ #k3. (K( JoinNonce ) @ #k3)))) ∧
  (∀ RevealEvent Entity #kr.
    (KeyReveal( RevealEvent, Entity ) @ #kr) ∧ (Honest( Entity ) @ #i)
   ⇒
    ⊥)"
*/
by sorry

/* All well-formedness checks were successful. */

end